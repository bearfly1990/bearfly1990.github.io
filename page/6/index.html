<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Shawn&#039;Blog Test</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Shawn&#039;Blog Test"><meta name="msapplication-TileImage" content="/img/favicon.ico"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Shawn&#039;Blog Test"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="Shawn&#039;Blog Test"><meta property="og:url" content="https://bearfly1990.github.io/"><meta property="og:site_name" content="Shawn&#039;Blog Test"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://bearfly1990.github.io/img/og_image.png"><meta property="article:author" content="Shawn"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://bearfly1990.github.io"},"headline":"Shawn'Blog Test","image":["https://bearfly1990.github.io/img/og_image.png"],"author":{"@type":"Person","name":"Shawn"},"description":""}</script><link rel="icon" href="/img/favicon.ico"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/favicon.ico" alt="Shawn&#039;Blog Test" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/bearfly1990"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2018-11-09T16:00:00.000Z" title="2018/11/10 上午12:00:00">2018-11-10</time></span><span class="level-item">Updated&nbsp;<time dateTime="2018-11-10T15:33:01.453Z" title="2018/11/10 下午11:33:01">2018-11-10</time></span><span class="level-item"> BF </span><span class="level-item">4 minutes read (About 645 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/11/10/2018/11/2018-11-10-PyRestfulAPIDoc/">RESTful API Doc</a></h1><div class="content"><h1 id="RESTful-API-Doc"><a href="#RESTful-API-Doc" class="headerlink" title="RESTful API Doc"></a>RESTful API Doc</h1><p>针对<code>RESTful API</code>,有许多工具可以用来编写文档比如<code>Swagger2</code>，之前发现一个挺好用的库就是<a target="_blank" rel="noopener" href="http://apidocjs.com/">apidocjs</a></p>
<p>这个库支持大多数流行程序语言，把接口相关的信息放在注释中，而这个js库解析注释中的有效信息生成html文档，需要安装<code>node.js</code>。</p>
<h1 id="Sample"><a href="#Sample" class="headerlink" title="Sample"></a>Sample</h1><p>下面直接根据昨天的API例子来添加注释，生成文档。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask_restful <span class="keyword">import</span> reqparse, abort, Api, Resource</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">api = Api(app)</span><br><span class="line"></span><br><span class="line">TODOS = &#123;</span><br><span class="line">    <span class="string">&#x27;todo1&#x27;</span>: &#123;<span class="string">&#x27;task&#x27;</span>: <span class="string">&#x27;Build an API&#x27;</span>&#125;,</span><br><span class="line">    <span class="string">&#x27;todo2&#x27;</span>: &#123;<span class="string">&#x27;task&#x27;</span>: <span class="string">&#x27;Test it&#x27;</span>&#125;,</span><br><span class="line">    <span class="string">&#x27;todo3&#x27;</span>: &#123;<span class="string">&#x27;task&#x27;</span>: <span class="string">&#x27;Write Blog&#x27;</span>&#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">abort_if_todo_doesnt_exist</span>(<span class="params">todo_id</span>):</span></span><br><span class="line">        <span class="keyword">if</span> todo_id <span class="keyword">not</span> <span class="keyword">in</span> TODOS:</span><br><span class="line">            abort(<span class="number">404</span>, message=<span class="string">&quot;Todo &#123;&#125; doesn&#x27;t exist.&quot;</span>.<span class="built_in">format</span>(todo_id))</span><br><span class="line"></span><br><span class="line">parser = reqparse.RequestParser()</span><br><span class="line">parser.add_argument(<span class="string">&#x27;task&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Todo</span>(<span class="params">Resource</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    @api &#123;get&#125; /todo/task/&lt;task_id&gt; get todo by id</span></span><br><span class="line"><span class="string">    @apiVersion 0.1.0</span></span><br><span class="line"><span class="string">    @apiName GetTodoItem</span></span><br><span class="line"><span class="string">    @apiGroup Todo</span></span><br><span class="line"><span class="string">    @apiPermission all</span></span><br><span class="line"><span class="string">    @apiParam &#123;Number&#125; task_id The todo id.</span></span><br><span class="line"><span class="string">    @apiExample Example usage:</span></span><br><span class="line"><span class="string">        https://localhost:5000/v1/todo/task/todo1</span></span><br><span class="line"><span class="string">    @apiSuccessExample &#123;json&#125; Success-Response:</span></span><br><span class="line"><span class="string">        HTTP/1.1 200 OK</span></span><br><span class="line"><span class="string">        &#123;&#x27;task&#x27;: &#x27;Build an API&#x27;&#125;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    @api &#123;get&#125; /todo/&lt;todo_id&gt; get todo by id</span></span><br><span class="line"><span class="string">    @apiVersion 0.2.0</span></span><br><span class="line"><span class="string">    @apiName GetTodoItem</span></span><br><span class="line"><span class="string">    @apiGroup Todo</span></span><br><span class="line"><span class="string">    @apiPermission all</span></span><br><span class="line"><span class="string">    @apiParam &#123;Number&#125; todo_id The todo id.</span></span><br><span class="line"><span class="string">    @apiExample Example usage:</span></span><br><span class="line"><span class="string">        https://localhost:5000/v1/todo/todo1</span></span><br><span class="line"><span class="string">    @apiSuccessExample &#123;json&#125; Success-Response:</span></span><br><span class="line"><span class="string">        HTTP/1.1 200 OK</span></span><br><span class="line"><span class="string">        &#123;&#x27;task&#x27;: &#x27;Build an API&#x27;&#125;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span>(<span class="params">self, todo_id</span>):</span></span><br><span class="line">        abort_if_todo_doesnt_exist(todo_id)</span><br><span class="line">        <span class="keyword">return</span> TODOS[todo_id]</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    @api &#123;delete&#125; /todo/&lt;todo_id&gt; delete todo task by id</span></span><br><span class="line"><span class="string">    @apiVersion 0.1.0</span></span><br><span class="line"><span class="string">    @apiName DeleteTodo</span></span><br><span class="line"><span class="string">    @apiGroup Todo</span></span><br><span class="line"><span class="string">    @apiPermission admin</span></span><br><span class="line"><span class="string">    @apiParam &#123;Number&#125; todo_id The todo id.</span></span><br><span class="line"><span class="string">    @apiExample Example usage:</span></span><br><span class="line"><span class="string">        https://localhost:5000/v1/todo/todo1</span></span><br><span class="line"><span class="string">    @apiSuccessExample &#123;json&#125; Success-Response:</span></span><br><span class="line"><span class="string">        HTTP/1.1 204 No Content</span></span><br><span class="line"><span class="string">    @apiErrorExample Response (example):</span></span><br><span class="line"><span class="string">        HTTP/1.1 401 Not Authenticated</span></span><br><span class="line"><span class="string">        &#123;&quot;error&quot;: &quot;NoAccessRight&quot;&#125;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">delete</span>(<span class="params">self, todo_id</span>):</span></span><br><span class="line">        abort_if_todo_doesnt_exist(todo_id)</span><br><span class="line">        <span class="keyword">del</span> TODOS[todo_id]</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>, <span class="number">204</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    @api &#123;put&#125; /todo/&lt;todo_id&gt; put a new task</span></span><br><span class="line"><span class="string">    @apiVersion 0.1.0</span></span><br><span class="line"><span class="string">    @apiName PutTask</span></span><br><span class="line"><span class="string">    @apiGroup Todo</span></span><br><span class="line"><span class="string">    @apiPermission admin</span></span><br><span class="line"><span class="string">    @apiParam &#123;Number&#125; todo_id The todo id.</span></span><br><span class="line"><span class="string">    @apiExample Example usage:</span></span><br><span class="line"><span class="string">        https://localhost:5000/v1/todo/todo1</span></span><br><span class="line"><span class="string">        &#123;&quot;task&quot;: &quot;New Task&quot;&#125;</span></span><br><span class="line"><span class="string">    @apiSuccessExample &#123;json&#125; Success-Response:</span></span><br><span class="line"><span class="string">        HTTP/1.1 201 Created </span></span><br><span class="line"><span class="string">        &#123;&quot;task&quot;: &quot;New Task&quot;&#125;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">put</span>(<span class="params">self, todo_id</span>):</span></span><br><span class="line">        args = parser.parse_args()</span><br><span class="line">        task = &#123;<span class="string">&#x27;task&#x27;</span>: args[<span class="string">&#x27;task&#x27;</span>]&#125;</span><br><span class="line">        <span class="keyword">return</span> task, <span class="number">201</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TodoList</span>(<span class="params">Resource</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    @api &#123;get&#125; /todos get todolist</span></span><br><span class="line"><span class="string">    @apiVersion 0.1.0</span></span><br><span class="line"><span class="string">    @apiName GetTodoList</span></span><br><span class="line"><span class="string">    @apiGroup TodoList</span></span><br><span class="line"><span class="string">    @apiPermission all</span></span><br><span class="line"><span class="string">    @apiExample Example usage:</span></span><br><span class="line"><span class="string">        https://localhost:5000/v1/todos</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> TODOS</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    @api &#123;post&#125; /todos post todo list</span></span><br><span class="line"><span class="string">    @apiVersion 0.1.0</span></span><br><span class="line"><span class="string">    @apiName PostTodoList</span></span><br><span class="line"><span class="string">    @apiGroup TodoList</span></span><br><span class="line"><span class="string">    @apiPermission admin</span></span><br><span class="line"><span class="string">    @apiExample Example usage:</span></span><br><span class="line"><span class="string">        https://localhost:5000/v1/todo/todo1</span></span><br><span class="line"><span class="string">        &#123;&quot;task&quot;:&quot;New Task&quot;&#125;</span></span><br><span class="line"><span class="string">    @apiSuccessExample &#123;json&#125; Success-Response:</span></span><br><span class="line"><span class="string">        HTTP/1.1 201 Created</span></span><br><span class="line"><span class="string">        &#123;&#x27;task&#x27;: &#x27;New Task&#x27;&#125;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">post</span>(<span class="params">self</span>):</span></span><br><span class="line">        args = parser.parse_args()</span><br><span class="line">        todo_id = <span class="built_in">int</span>(<span class="built_in">max</span>(TODOS.keys()).lstrip(<span class="string">&#x27;todo&#x27;</span>)) + <span class="number">1</span></span><br><span class="line">        todo_id = <span class="string">&#x27;todo%i&#x27;</span> % todo_id</span><br><span class="line">        TODOS[todo_id] = &#123;<span class="string">&#x27;task&#x27;</span>: args[<span class="string">&#x27;task&#x27;</span>]&#125;</span><br><span class="line">        <span class="keyword">return</span> TODOS[todo_id], <span class="number">201</span></span><br><span class="line"></span><br><span class="line">api.add_resource(TodoList, <span class="string">&#x27;/todos&#x27;</span>)</span><br><span class="line">api.add_resource(Todo, <span class="string">&#x27;/todos/&lt;todo_id&gt;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<p>运行下面的命令，就可以在<code>pytrestapi_doc</code>目录下生成api文档</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Users\mayn\Desktop\workspace&gt; apidoc <span class="literal">-i</span> .\pyrestapi\ <span class="literal">-o</span> .\pytrestapi_doc</span><br><span class="line">info: Done.</span><br></pre></td></tr></table></figure>

<p>下面是报告的结果,可以感受下：<br><a href="https://bearfly1990.github.io/apidoc/pyrestapi-doc/">https://bearfly1990.github.io/apidoc/pyrestapi-doc/</a></p>
<p>下面是简单的环境配置步骤：</p>
<ul>
<li>安装<code>node.js</code></li>
<li>安装 apidoc <code>npm install apidoc -g</code></li>
<li>装备好已经编写好对应注释的代码项目</li>
<li><code>apidoc -i myapp/ -o apidoc/</code>  就能生成在apidoc文件夹中</li>
</ul>
<p>更多信息请参考官网：</p>
<p><a target="_blank" rel="noopener" href="http://apidocjs.com/">apidocjs</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2018-11-08T16:00:00.000Z" title="2018/11/9 上午12:00:00">2018-11-09</time></span><span class="level-item">Updated&nbsp;<time dateTime="2018-11-27T16:45:53.183Z" title="2018/11/28 上午12:45:53">2018-11-28</time></span><span class="level-item"> BF </span><span class="level-item">5 minutes read (About 822 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/11/09/2018/11/2018-11-09-PyRestfulAPI/">Python RESTful API</a></h1><div class="content"><h1 id="RESTful-API"><a href="#RESTful-API" class="headerlink" title="RESTful API"></a>RESTful API</h1><p>REST 全称是 Representational State Transfer，中文意思是表述性状态转移。 它首次出现在 2000 年 Roy Fielding 的博士论文中，Roy Fielding 是 HTTP 规范的主要编写者之一。 他在论文中提到：”我这篇文章的写作目的，就是想在符合架构原理的前提下，理解和评估以网络为基础的应用软件的架构设计，得到一个功能强、性能好、适宜通信的架构。REST 指的是一组架构约束条件和原则。” 如果一个架构符合 REST 的约束条件和原则，我们就称它为 RESTful 架构。</p>
<p>REST 本身并没有创造新的技术、组件或服务，而隐藏在 RESTful 背后的理念就是使用 Web 的现有特征和能力， 更好地使用现有 Web 标准中的一些准则和约束。虽然 REST 本身受 Web 技术的影响很深， 但是理论上 REST 架构风格并不是绑定在 HTTP 上，只不过目前 HTTP 是唯一与 REST 相关的实例。 所以我们这里描述的 REST 也是通过 HTTP 实现的 REST。</p>
<h1 id="Python-flask-restful"><a href="#Python-flask-restful" class="headerlink" title="Python flask-restful"></a>Python flask-restful</h1><p><code>flask</code>是 python 的一个轻量级网站开发框架，直接利用他就能开发简单的<code>web api</code>。</p>
<p>但是使用<code>flask-restful</code>的话，就更加的简单和适合。</p>
<h1 id="flask"><a href="#flask" class="headerlink" title="flask"></a>flask</h1><p>下面是直接使用 flask 的例子:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/helloworld&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello_world</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Hello World!&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<p>上面是一个非常简单的使用 flask 开发 api 的例子，在运行后直接就能访问使用</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Users\mayn\Desktop&gt; python ./hello.py</span><br><span class="line"> * Serving Flask app <span class="string">&quot;hello&quot;</span> (lazy loading)</span><br><span class="line"> * Environment: production</span><br><span class="line">   WARNING: <span class="keyword">Do</span> not use the development server <span class="keyword">in</span> a production environment.</span><br><span class="line">   Use a production WSGI server instead.</span><br><span class="line"> * Debug mode: on</span><br><span class="line"> * Restarting with stat</span><br><span class="line"> * Debugger is active!</span><br><span class="line"> * Debugger PIN: <span class="number">215</span><span class="literal">-586</span><span class="literal">-846</span></span><br><span class="line"> * Running on http://<span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">5000</span>/ (Press CTRL+C to quit)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/img/post/2018/11/2018-11-09-PyRestfulAPI-demo01.jpg" alt="sample01"></p>
<h1 id="flask-restful"><a href="#flask-restful" class="headerlink" title="flask-restful"></a>flask-restful</h1><p>如果使用<code>flask-restful</code>的话，那就会结构更清晰一些：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask_restful <span class="keyword">import</span> reqparse, abort, Api, Resource</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">api = Api(app)</span><br><span class="line"></span><br><span class="line">TODOS = &#123;</span><br><span class="line">    <span class="string">&#x27;todo1&#x27;</span>: &#123;<span class="string">&#x27;task&#x27;</span>: <span class="string">&#x27;Build an API&#x27;</span>&#125;,</span><br><span class="line">    <span class="string">&#x27;todo2&#x27;</span>: &#123;<span class="string">&#x27;task&#x27;</span>: <span class="string">&#x27;Test it&#x27;</span>&#125;,</span><br><span class="line">    <span class="string">&#x27;todo3&#x27;</span>: &#123;<span class="string">&#x27;task&#x27;</span>: <span class="string">&#x27;Write Blog&#x27;</span>&#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">abort_if_todo_doesnt_exist</span>(<span class="params">todo_id</span>):</span></span><br><span class="line">        <span class="keyword">if</span> todo_id <span class="keyword">not</span> <span class="keyword">in</span> TODOS:</span><br><span class="line">            abort(<span class="number">404</span>, message=<span class="string">&quot;Todo &#123;&#125; doesn&#x27;t exist.&quot;</span>.<span class="built_in">format</span>(todo_id))</span><br><span class="line"></span><br><span class="line">parser = reqparse.RequestParser()</span><br><span class="line">parser.add_argument(<span class="string">&#x27;task&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3个方法，对应get/delete/put</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Todo</span>(<span class="params">Resource</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span>(<span class="params">self, todo_id</span>):</span></span><br><span class="line">        abort_if_todo_doesnt_exist(todo_id)</span><br><span class="line">        <span class="keyword">return</span> TODOS[todo_id]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">delete</span>(<span class="params">self, todo_id</span>):</span></span><br><span class="line">        abort_if_todo_doesnt_exist(todo_id)</span><br><span class="line">        <span class="keyword">del</span> TODOS[todo_id]</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>, <span class="number">204</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">put</span>(<span class="params">self, todo_id</span>):</span></span><br><span class="line">        args = parser.parse_args()</span><br><span class="line">        task = &#123;<span class="string">&#x27;task&#x27;</span>: args[<span class="string">&#x27;task&#x27;</span>]&#125;</span><br><span class="line">        <span class="keyword">return</span> task, <span class="number">201</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2个方法，对应get/post</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TodoList</span>(<span class="params">Resource</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> TODOS</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">post</span>(<span class="params">self</span>):</span></span><br><span class="line">        args = parser.parse_args()</span><br><span class="line">        todo_id = <span class="built_in">int</span>(<span class="built_in">max</span>(TODOS.keys()).lstrip(<span class="string">&#x27;todo&#x27;</span>)) + <span class="number">1</span></span><br><span class="line">        todo_id = <span class="string">&#x27;todo%i&#x27;</span> % todo_id</span><br><span class="line">        TODOS[todo_id] = &#123;<span class="string">&#x27;task&#x27;</span>: args[<span class="string">&#x27;task&#x27;</span>]&#125;</span><br><span class="line">        <span class="keyword">return</span> TODOS[todo_id], <span class="number">201</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 绑定api对应的类</span></span><br><span class="line">api.add_resource(TodoList, <span class="string">&#x27;/todos&#x27;</span>)</span><br><span class="line">api.add_resource(Todo, <span class="string">&#x27;/todos/&lt;todo_id&gt;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>总体来说，使用<code>flask-restful</code>框架真的方便很多, 一些处理已经封装好。比如<code>json</code>就是默认的输入输出，状态状态码也直接放在 return 中和返回的内容一起就好。</p>
<p>更多信息请参考：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/bearfly1990/PowerScript/blob/master/Python3/flask-restful/todo.py">todo.py</a></p>
<p><a target="_blank" rel="noopener" href="http://www.runoob.com/w3cnote/restful-architecture.html">RESTful 架构详解</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/6ac1cab17929">python 实现 RESTful 服务（基于 flask)</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2018-10-26T16:00:00.000Z" title="2018/10/27 上午12:00:00">2018-10-27</time></span><span class="level-item">Updated&nbsp;<time dateTime="2018-11-08T13:28:21.887Z" title="2018/11/8 下午9:28:21">2018-11-08</time></span><span class="level-item"> BF </span><span class="level-item">7 minutes read (About 1070 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/10/27/2018/10/2018-10-27-PyScreenGif/">Python Screen Gif</a></h1><div class="content"><h1 id="2018-10-22"><a href="#2018-10-22" class="headerlink" title="2018-10-22"></a>2018-10-22</h1><h2 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h2><p>最近用了一些 gif 生成工具，感觉挺好用的，就想着 python 是不是也可以实现，自己做一个。</p>
<p>浏览了一些文章，发现有一些现成的库可以用。</p>
<p>最终的想法还是做成一个 GUI，今天是第一步，思路利用<code>PIL</code>的<code>ImageGrab</code>抓取屏幕，然后使用<code>opencsv</code>写入视频流，再用<code>moviepy</code>截取视频的画面生成 gif。</p>
<h2 id="Lib-Installed"><a href="#Lib-Installed" class="headerlink" title="Lib Installed"></a>Lib Installed</h2><p>下面是主要用的库，<code>pillow</code>就是<code>PIL</code>， <code>opencv-python</code>就是<code>cv2</code>。</p>
<p>在使用<code>moviepy</code>的时候，会需要下载第三方 exe <a target="_blank" rel="noopener" href="https://github.com/imageio/imageio-binaries/raw/master/ffmpeg/ffmpeg-win32-v3.2.4.exe">ffmpeg-win32-v3.2.4.exe</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pip install pillow</span><br><span class="line">pip install opencv-python</span><br><span class="line">pip install moviepy</span><br></pre></td></tr></table></figure>

<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> moviepy.editor <span class="keyword">as</span> mpy</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> ImageGrab</span><br><span class="line"></span><br><span class="line">OUTPUT_NAME = <span class="string">&#x27;test&#x27;</span></span><br><span class="line"></span><br><span class="line">screen_grabed = ImageGrab.grab()  <span class="comment"># 获得当前屏幕</span></span><br><span class="line">k = np.zeros((<span class="number">200</span>, <span class="number">200</span>), np.uint8)</span><br><span class="line">width, height = screen_grabed.size  <span class="comment"># 获得当前屏幕的大小</span></span><br><span class="line"></span><br><span class="line">fourcc = cv2.VideoWriter_fourcc(*<span class="string">&#x27;XVID&#x27;</span>)  <span class="comment"># 编码格式</span></span><br><span class="line"></span><br><span class="line">video = cv2.VideoWriter(<span class="string">&#x27;&#123;&#125;.avi&#x27;</span>.<span class="built_in">format</span>(</span><br><span class="line">    OUTPUT_NAME), fourcc, <span class="number">16</span>, (width, height))  <span class="comment"># 输出文件命名为test.avi,帧率为16，可以自己设置</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    im = ImageGrab.grab()</span><br><span class="line">    imm = cv2.cvtColor(np.array(im), cv2.COLOR_RGB2BGR)  <span class="comment"># 转为opencv的BGR格式</span></span><br><span class="line">    video.write(imm)</span><br><span class="line">    cv2.imshow(<span class="string">&#x27;imm&#x27;</span>, k)</span><br><span class="line">    <span class="keyword">if</span> cv2.waitKey(<span class="number">1</span>) &amp; <span class="number">0xFF</span> == <span class="built_in">ord</span>(<span class="string">&#x27;q&#x27;</span>):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">video.release()</span><br><span class="line">cv2.destroyAllWindows()</span><br><span class="line"></span><br><span class="line"><span class="comment">#import imageio</span></span><br><span class="line"><span class="comment"># imageio.plugins.ffmpeg.download()</span></span><br><span class="line"><span class="comment"># 视频文件的本地路径</span></span><br><span class="line">content = mpy.VideoFileClip(<span class="string">&#x27;&#123;&#125;.avi&#x27;</span>.<span class="built_in">format</span>(OUTPUT_NAME))</span><br><span class="line"><span class="comment"># 剪辑0分1秒到0分6秒的片段。注意：不使用resize则不会修改清晰度</span></span><br><span class="line">c1 = content.subclip((<span class="number">0</span>, <span class="number">1</span>), (<span class="number">0</span>, <span class="number">6</span>)).resize((<span class="number">960</span>, <span class="number">640</span>))</span><br><span class="line"><span class="comment"># 将片段保存为gif图到python的默认路径</span></span><br><span class="line">c1.write_gif(<span class="string">&#x27;&#123;&#125;.gif&#x27;</span>.<span class="built_in">format</span>(OUTPUT_NAME))</span><br></pre></td></tr></table></figure>

<h2 id="Next"><a href="#Next" class="headerlink" title="Next"></a>Next</h2><p>接下来，需要研究一下几个点：</p>
<ul>
<li>怎么使用 GUI 来录制固定区域的屏幕</li>
<li>是否可以截取图片流，再直接把图片打包成 gif，省去中间生成 avi 的过程。</li>
<li>…</li>
</ul>
<h1 id="2018-10-24"><a href="#2018-10-24" class="headerlink" title="2018-10-24"></a>2018-10-24</h1><h2 id="Background-1"><a href="#Background-1" class="headerlink" title="Background"></a>Background</h2><p>上一篇把截图做成视频，再把视频转回 gif 似乎有点画蛇添足，今天就考虑直接把截图转成 gif</p>
<h2 id="Code-1"><a href="#Code-1" class="headerlink" title="Code"></a>Code</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os, time</span><br><span class="line"><span class="keyword">import</span> imageio</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> ImageGrab</span><br><span class="line"></span><br><span class="line">images = []</span><br><span class="line">start_time = time.time()</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    im = ImageGrab.grab()</span><br><span class="line">    im.save(<span class="string">&#x27;temp.png&#x27;</span>)</span><br><span class="line">    <span class="comment">#save image to the list.</span></span><br><span class="line">    images.append(imageio.imread(<span class="string">&#x27;temp.png&#x27;</span>))</span><br><span class="line">    time.sleep(<span class="number">0.001</span>)</span><br><span class="line">    end_time = time.time()</span><br><span class="line">    <span class="keyword">if</span>(end_time - start_time &gt; <span class="number">5</span>):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">imageio.mimsave(<span class="string">&#x27;test.gif&#x27;</span>, images, duration=<span class="number">0.3</span>)</span><br><span class="line">c1.write_gif(<span class="string">&#x27;&#123;&#125;.gif&#x27;</span>.<span class="built_in">format</span>(OUTPUT_NAME))</span><br></pre></td></tr></table></figure>

<h2 id="Next-1"><a href="#Next-1" class="headerlink" title="Next"></a>Next</h2><ul>
<li>怎么使用 GUI 来录制固定区域的屏幕</li>
<li>是否可以提高性能，每次截图放到 list 中性能消耗比较大</li>
<li>…</li>
</ul>
<h1 id="2018-10-27"><a href="#2018-10-27" class="headerlink" title="2018-10-27"></a>2018-10-27</h1><h2 id="Background-2"><a href="#Background-2" class="headerlink" title="Background"></a>Background</h2><p>今天更新了下代码，提高了可用性，增加了UI设定截屏的区域，有时间再更新这篇，已经基本可用了。</p>
<h2 id="Code-2"><a href="#Code-2" class="headerlink" title="Code"></a>Code</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tkinter</span><br><span class="line"><span class="keyword">import</span> os, time, tempfile</span><br><span class="line"><span class="keyword">import</span> imageio</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> ImageGrab</span><br><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread</span><br><span class="line"><span class="keyword">import</span> msvcrt</span><br><span class="line"></span><br><span class="line">output_gif_name = <span class="string">&#x27;test.gif&#x27;</span></span><br><span class="line">width_grab = <span class="number">600</span></span><br><span class="line">height_grab = <span class="number">400</span></span><br><span class="line">x_grab = <span class="number">0</span></span><br><span class="line">y_grab = <span class="number">0</span></span><br><span class="line">flag_stop_record = [<span class="literal">False</span>]</span><br><span class="line">flag_is_recording = [<span class="literal">False</span>]</span><br><span class="line"></span><br><span class="line">root = tkinter.Tk()</span><br><span class="line">root.overrideredirect(<span class="literal">True</span>)</span><br><span class="line"><span class="comment">#root.attributes(&quot;-alpha&quot;, 0.3)窗口透明度70 %</span></span><br><span class="line">root.attributes(<span class="string">&quot;-alpha&quot;</span>, <span class="number">0.3</span>)<span class="comment">#窗口透明度60 %</span></span><br><span class="line">root.geometry(<span class="string">&quot;&#123;&#125;x&#123;&#125;+&#123;&#125;+&#123;&#125;&quot;</span>.<span class="built_in">format</span>(width_grab, height_grab, x_grab,y_grab))<span class="comment">#&quot;300x200+10+10&quot;</span></span><br><span class="line">canvas = tkinter.Canvas(root)</span><br><span class="line">canvas.configure(width = width_grab)</span><br><span class="line">canvas.configure(height = height_grab)</span><br><span class="line">canvas.configure(bg = <span class="string">&quot;blue&quot;</span>)</span><br><span class="line">canvas.grid(column=<span class="number">0</span>,row=<span class="number">0</span>)</span><br><span class="line"><span class="comment"># canvas.configure(highlightthickness = 0)</span></span><br><span class="line"><span class="comment"># canvas.pack()</span></span><br><span class="line"><span class="comment"># canvas.pack(side=&quot;bottom&quot;,fill=&quot;both&quot;,expand=True)</span></span><br><span class="line"><span class="comment"># x, y = 0, 0</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">move</span>(<span class="params">event</span>):</span></span><br><span class="line">    <span class="keyword">global</span> x_grab,y_grab, width_grab, height_grab</span><br><span class="line"></span><br><span class="line">    new_x = (event.x-x)+root.winfo_x()</span><br><span class="line">    new_y = (event.y-y)+root.winfo_y()</span><br><span class="line">    x_grab,y_grab = new_x,new_y</span><br><span class="line">    s = <span class="string">&quot;&#123;&#125;x&#123;&#125;+&#123;&#125;+&#123;&#125;&quot;</span>.<span class="built_in">format</span>(width_grab, height_grab, new_x, new_y)</span><br><span class="line">    <span class="comment"># s = &quot;&#123;&#125;x&#123;&#125;+&quot; + str(new_x)+&quot;+&quot; + str(new_y)</span></span><br><span class="line">    root.geometry(s)</span><br><span class="line">    <span class="comment"># canvas.create_rectangle(new_x, new_y, 300, 200, fill=&quot;blue&quot;)</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;s = &quot;</span>,s)</span><br><span class="line">    <span class="built_in">print</span>(root.winfo_x(),root.winfo_y())</span><br><span class="line">    <span class="built_in">print</span>(event.x,event.y)</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">button_1</span>(<span class="params">event</span>):</span></span><br><span class="line">    <span class="keyword">global</span> x,y</span><br><span class="line">    x,y = event.x,event.y</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;x, y = &quot;</span>, x, y)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;event.x, event.y = &quot;</span>,event.x,event.y)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">start_record_gif</span>():</span></span><br><span class="line">    <span class="keyword">global</span> output_gif_name, x_grab, y_grab, flag_stop_record</span><br><span class="line">    images_temp_list = []</span><br><span class="line">    <span class="comment"># start_time = time.time()</span></span><br><span class="line">    isEnded = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="keyword">not</span> isEnded):</span><br><span class="line">        <span class="keyword">if</span>(flag_stop_record[<span class="number">0</span>] == <span class="literal">True</span>):</span><br><span class="line">            isEnded = <span class="literal">True</span></span><br><span class="line">        <span class="comment"># try:</span></span><br><span class="line">            <span class="comment"># flag_stop_record.get(False)</span></span><br><span class="line">            <span class="comment"># isEnded = True</span></span><br><span class="line">        <span class="comment"># except:</span></span><br><span class="line">            <span class="comment"># isEnded = False</span></span><br><span class="line">        im = ImageGrab.grab((x_grab, y_grab , x_grab+width_grab, y_grab+height_grab))</span><br><span class="line">        im.save(<span class="string">&#x27;temp.png&#x27;</span>)</span><br><span class="line">        images_temp_list.append(imageio.imread(<span class="string">&#x27;temp.png&#x27;</span>))</span><br><span class="line">        time.sleep(<span class="number">0.001</span>)</span><br><span class="line">        imageio.mimsave(output_gif_name, images_temp_list, duration=<span class="number">0.3</span>)</span><br><span class="line">        <span class="comment"># end_time = time.time()</span></span><br><span class="line">        <span class="comment"># if(end_time - start_time &gt; 5):</span></span><br><span class="line">            <span class="comment"># break</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">record_gif</span>(<span class="params">event</span>):</span></span><br><span class="line">    <span class="keyword">global</span> flag_is_recording</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">not</span> flag_is_recording[<span class="number">0</span>]):</span><br><span class="line">        root.geometry(<span class="string">&quot;0x0+0+0&quot;</span>)</span><br><span class="line">        flag_is_recording[<span class="number">0</span>] = <span class="literal">True</span></span><br><span class="line">        t = Thread(target=start_record_gif, args=())</span><br><span class="line">        t.start()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exit</span>(<span class="params">event</span>):</span></span><br><span class="line">    <span class="comment"># flag_stop_record.put(True)</span></span><br><span class="line">    flag_stop_record[<span class="number">0</span>] = <span class="literal">True</span></span><br><span class="line">    root.destroy()</span><br><span class="line"></span><br><span class="line">canvas.bind(<span class="string">&quot;&lt;B1-Motion&gt;&quot;</span>, move)</span><br><span class="line">canvas.bind(<span class="string">&quot;&lt;Button-1&gt;&quot;</span>, button_1)</span><br><span class="line">canvas.bind(<span class="string">&quot;&lt;Button-3&gt;&quot;</span>, exit)</span><br><span class="line">canvas.bind(<span class="string">&quot;&lt;Double-Button-1&gt;&quot;</span>,record_gif)</span><br><span class="line"></span><br><span class="line">root.mainloop()</span><br></pre></td></tr></table></figure>

<h2 id="Next-2"><a href="#Next-2" class="headerlink" title="Next"></a>Next</h2><ul>
<li>优化使用方式</li>
<li>使用temp目录</li>
<li>…</li>
</ul>
<p>更多信息可以参考：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Spade_/article/details/79516322">python小应用之moviepy的视频剪辑制作gif图</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/zzzzjh/article/details/80903597">利用Python来完成屏幕录制</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2018-10-17T16:00:00.000Z" title="2018/10/18 上午12:00:00">2018-10-18</time></span><span class="level-item">Updated&nbsp;<time dateTime="2018-10-18T14:06:58.527Z" title="2018/10/18 下午10:06:58">2018-10-18</time></span><span class="level-item"> BF </span><span class="level-item">4 minutes read (About 643 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/10/18/2018/10/2018-10-18-PyWinService/">Python Windows Service</a></h1><div class="content"><h1 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h1><p>最近在优化<code>LoadTest</code>的流程，在执行测试的时候，我们需要在10台虚拟机上运行<code>HostProxy</code>, 这意味着需要登陆这10台机子并且一个个运行代理程序，这简直要人命。</p>
<p>所以我第一个想到的就是把这个过程做成一个<code>windows service</code>，让他们一直监控一个文件命令，当下达运行指令的时候，10台机子就会自动运行，同理也能停止。</p>
<p>虽然最后发现通过service启的进程不能被<code>Host Manager</code>访问到（有时间再仔细研究，应该有解决方案），用<code>Scheduler</code>替代了，但其它操作还是没有问题的。</p>
<h1 id="pywin32"><a href="#pywin32" class="headerlink" title="pywin32"></a>pywin32</h1><p>如果想要编写<code>windows service</code>，就要用到<code>pywin32</code>这个库，可以从网上下到，我记得好像不能直接使用pip安装。</p>
<h1 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h1><p>下面便是一个简单的例子，在服务启动之后，便会每5秒在文件中写数据。</p>
<p>主要我们自己的业务逻辑便是写在<code>SvcDoRun</code>这个函数中。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> win32serviceutil</span><br><span class="line"><span class="keyword">import</span> win32service</span><br><span class="line"><span class="keyword">import</span> win32event</span><br><span class="line"><span class="keyword">import</span> servicemanager</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> os, time</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PySvc</span>(<span class="params">win32serviceutil.ServiceFramework</span>):</span></span><br><span class="line">    <span class="comment"># you can NET START/STOP the service by the following name</span></span><br><span class="line">    _svc_name_ = <span class="string">&quot;PythonTestService&quot;</span></span><br><span class="line">    <span class="comment"># this text shows up as the service name in the Service</span></span><br><span class="line">    <span class="comment"># Control Manager (SCM)</span></span><br><span class="line">    _svc_display_name_ = <span class="string">&quot;Python Test Service&quot;</span></span><br><span class="line">    <span class="comment"># this text shows up as the description in the SCM</span></span><br><span class="line">    _svc_description_ = <span class="string">&quot;This service writes stuff to a file&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, args</span>):</span></span><br><span class="line">        win32serviceutil.ServiceFramework.__init__(self,args)</span><br><span class="line">        <span class="comment"># create an event to listen for stop requests on</span></span><br><span class="line">        self.hWaitStop = win32event.CreateEvent(<span class="literal">None</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># core logic of the service</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">SvcDoRun</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment"># import servicemanager</span></span><br><span class="line">        f = <span class="built_in">open</span>(<span class="string">&#x27;c:\\test.txt&#x27;</span>, <span class="string">&#x27;w+&#x27;</span>)</span><br><span class="line">        rc = <span class="literal">None</span></span><br><span class="line">        <span class="comment"># if the stop event hasn&#x27;t been fired keep looping</span></span><br><span class="line">        <span class="keyword">while</span> rc != win32event.WAIT_OBJECT_0:</span><br><span class="line">            f.write(<span class="string">&#x27;TEST DATA\n&#x27;</span>)</span><br><span class="line">            f.flush()</span><br><span class="line">            <span class="comment"># block for 5 seconds and listen for a stop event</span></span><br><span class="line">            rc = win32event.WaitForSingleObject(self.hWaitStop, <span class="number">5000</span>)</span><br><span class="line"></span><br><span class="line">        f.write(<span class="string">&#x27;Service is stopped.\n&#x27;</span>)</span><br><span class="line">        f.close()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># called when we&#x27;re being shut down</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">SvcStop</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment"># tell the SCM we&#x27;re shutting down</span></span><br><span class="line">        self.ReportServiceStatus(win32service.SERVICE_STOP_PENDING)</span><br><span class="line">        <span class="comment"># fire the stop event</span></span><br><span class="line">        win32event.SetEvent(self.hWaitStop)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    win32serviceutil.HandleCommandLine(PySvc)</span><br></pre></td></tr></table></figure>

<h1 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h1><p>在编写好脚本之后，比如上面的代码假设文件名为<code>PythonService.py</code>,那么就可以用以下的方式来使用。</p>
<p>当然，在第一部安装之后，可以直接在<code>service</code>面板操作，不一定需要用脚本。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#1.安装服务</span></span><br><span class="line">python PythonService.py install</span><br><span class="line"><span class="comment">#2.让服务自动启动</span></span><br><span class="line">python PythonService.py --startup auto install </span><br><span class="line"><span class="comment">#3.启动服务</span></span><br><span class="line">python PythonService.py start</span><br><span class="line"><span class="comment">#4.重启服务</span></span><br><span class="line">python PythonService.py restart</span><br><span class="line"><span class="comment">#5.停止服务</span></span><br><span class="line">python PythonService.py stop</span><br><span class="line"><span class="comment">#6.删除/卸载服务</span></span><br><span class="line">python PythonService.py remove</span><br></pre></td></tr></table></figure>

<p>更多信息可以参考：</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/zoro-robin/p/6110188.html">https://www.cnblogs.com/zoro-robin/p/6110188.html</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2018-09-11T16:00:00.000Z" title="2018/9/12 上午12:00:00">2018-09-12</time></span><span class="level-item">Updated&nbsp;<time dateTime="2018-11-30T15:46:40.248Z" title="2018/11/30 下午11:46:40">2018-11-30</time></span><span class="level-item"> BF </span><span class="level-item">7 minutes read (About 1085 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/09/12/2018/09/2018-09-12-PyProgressBar/">Progress Bar in Python</a></h1><div class="content"><h1 id="Progress-Bar-in-Python"><a href="#Progress-Bar-in-Python" class="headerlink" title="Progress Bar in Python"></a>Progress Bar in Python</h1><p>很多时候，我们在测试的过程中，希望能够直观的看到测试的进度，而不是去看 log 或者查询数据库得到信息。</p>
<p>这个时候，如果有数据完成的进度的话就非常的方便。</p>
<p>今天就简单总结下这两天查询的资料，并且已经在实际中用到。</p>
<h2 id="How"><a href="#How" class="headerlink" title="How"></a>How</h2><p>如果要在 Console 中实现进度条，那就是要所有所有字符全部在同一行，而且可以修改。</p>
<p>如果直接使用 print 语句，python 会结尾加上换行符(<code>\n</code>)，这就导致在 Console 下一旦被 print 之后就无法再修改了。所以我们不能直接使用 <code>print</code></p>
<p>通过 <code>sys.stdout.write()</code> 我们就可以在 Console 输出字符，并且不会加上任何结尾。</p>
<p>通过 <code>sys.stdout.flush()</code> 可以把输出暂时打印在 Console 中。</p>
<p>而通过转义字符<code>\r</code>，就可以回到首行，然后如果继续输出的话，就可以连续在同一行改变字符，实现进度的效果。</p>
<p>下面就简单介绍一些进度条的实现，网上一些作者的实例。</p>
<h2 id="Demo-01"><a href="#Demo-01" class="headerlink" title="Demo 01"></a>Demo 01</h2><p>下面是一个最简单的实现：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys, time</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">    sys.stdout.write(<span class="string">&#x27;&#123;0&#125;\r&#x27;</span>.<span class="built_in">format</span>( <span class="string">&#x27;*&#x27;</span> * (i + <span class="number">1</span>)))</span><br><span class="line">    sys.stdout.flush()</span><br><span class="line">    time.sleep(<span class="number">0.2</span>)</span><br></pre></td></tr></table></figure>

<p><img src="/img/post/2018/09/2018-09-12-PyProgressBar-demo01.gif" alt="Demo01"></p>
<h2 id="Demo-02"><a href="#Demo-02" class="headerlink" title="Demo 02"></a>Demo 02</h2><p>这个例子是上一个例子的加强版，有数值进度和向后推进的箭头。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys,time</span><br><span class="line">j = <span class="string">&#x27;#&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">61</span>):</span><br><span class="line">    j += <span class="string">&#x27;#&#x27;</span></span><br><span class="line">    sys.stdout.write(<span class="built_in">str</span>(<span class="built_in">int</span>((i/<span class="number">60</span>)*<span class="number">100</span>))+<span class="string">&#x27;% &#x27;</span>+j+<span class="string">&#x27;-&gt;&#x27;</span>+ <span class="string">&quot;\r&quot;</span>)</span><br><span class="line">    sys.stdout.flush()</span><br><span class="line">    time.sleep(<span class="number">0.2</span>)</span><br></pre></td></tr></table></figure>

<p><img src="/img/post/2018/09/2018-09-12-PyProgressBar-demo02.gif" alt="Demo02"></p>
<h2 id="Demo-03"><a href="#Demo-03" class="headerlink" title="Demo 03"></a>Demo 03</h2><p>这个例子更简单一些，只有进度的数值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">viewBar</span>(<span class="params">i</span>):</span></span><br><span class="line">    output = sys.stdout</span><br><span class="line">    <span class="keyword">for</span> count <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, i + <span class="number">1</span>):</span><br><span class="line">        second = <span class="number">0.1</span></span><br><span class="line">        sleep(second)</span><br><span class="line">        output.write(<span class="string">&#x27;\rcomplete percent -----&gt;:%.0f%%&#x27;</span> % count)</span><br><span class="line">    output.flush()</span><br><span class="line">viewBar(<span class="number">100</span>)</span><br></pre></td></tr></table></figure>

<p><img src="/img/post/2018/09/2018-09-12-PyProgressBar-demo03.gif" alt="Demo03"></p>
<h2 id="Demo-04"><a href="#Demo-04" class="headerlink" title="Demo 04"></a>Demo 04</h2><p>这个例子用了一个比较常用的第三方库<code>tqdm</code>,有兴趣大家可以去搜一下官方文档，还是比较灵活的。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">1</span>, <span class="number">500</span>), <span class="built_in">ascii</span>=<span class="literal">True</span>):</span><br><span class="line">    sleep(<span class="number">0.01</span>)</span><br></pre></td></tr></table></figure>

<p><img src="/img/post/2018/09/2018-09-12-PyProgressBar-demo04.gif" alt="Demo04"></p>
<h2 id="Demo-05"><a href="#Demo-05" class="headerlink" title="Demo 05"></a>Demo 05</h2><p>这个例子其实和<code>Demo 02</code>差不多的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">view_bar</span>(<span class="params">num,total</span>):</span></span><br><span class="line">    rate = num / total</span><br><span class="line">    rate_num = <span class="built_in">int</span>(rate * <span class="number">100</span>)</span><br><span class="line">    <span class="comment">#r = &#x27;\r %d%%&#x27; %(rate_num)</span></span><br><span class="line">    r = <span class="string">&#x27;\r%s&gt;%d%%&#x27;</span> % (<span class="string">&#x27;=&#x27;</span> * rate_num, rate_num,)</span><br><span class="line">    sys.stdout.write(r)</span><br><span class="line">    sys.stdout.flush</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">101</span>):</span><br><span class="line">        time.sleep(<span class="number">0.1</span>)</span><br><span class="line">        view_bar(i, <span class="number">100</span>)</span><br></pre></td></tr></table></figure>

<p><img src="/img/post/2018/09/2018-09-12-PyProgressBar-demo05.gif" alt="Demo05"></p>
<h2 id="Demo-06"><a href="#Demo-06" class="headerlink" title="Demo 06"></a>Demo 06</h2><p>这个例子是我觉得相对比较好的，自己改良了一下放在自己项目中用了，下面是原始的 sample，我加了线程的处理，这样就可以异步写进度，而不会影响原来的进程。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys, time</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> _thread</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ShowProcess</span>():</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    显示处理进度的类</span></span><br><span class="line"><span class="string">    调用该类相关函数即可实现处理进度的显示</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    i = <span class="number">0</span> <span class="comment"># 当前的处理进度</span></span><br><span class="line">    max_steps = <span class="number">0</span> <span class="comment"># 总共需要处理的次数</span></span><br><span class="line">    max_arrow = <span class="number">50</span> <span class="comment">#进度条的长度</span></span><br><span class="line">    infoDone = <span class="string">&#x27;done&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 初始化函数，需要知道总共的处理次数</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, max_steps, infoDone = <span class="string">&#x27;Done&#x27;</span></span>):</span></span><br><span class="line">        self.max_steps = max_steps</span><br><span class="line">        self.i = <span class="number">0</span></span><br><span class="line">        self.infoDone = infoDone</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 显示函数，根据当前的处理进度i显示进度</span></span><br><span class="line">    <span class="comment"># 效果为[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;]100.00%</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">show_process</span>(<span class="params">self, i=<span class="literal">None</span></span>):</span></span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            self.i = i</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.i += <span class="number">1</span></span><br><span class="line">        num_arrow = <span class="built_in">int</span>(self.i * self.max_arrow / self.max_steps) <span class="comment">#计算显示多少个&#x27;&gt;&#x27;</span></span><br><span class="line">        num_line = self.max_arrow - num_arrow <span class="comment">#计算显示多少个&#x27;-&#x27;</span></span><br><span class="line">        percent = self.i * <span class="number">100.0</span> / self.max_steps <span class="comment">#计算完成进度，格式为xx.xx%</span></span><br><span class="line">        process_bar = <span class="string">&#x27;[&#123;&#125;&#123;&#125;] &#123;:02&#125;%\r&#x27;</span>.<span class="built_in">format</span>(<span class="string">&#x27;#&#x27;</span> * num_arrow, <span class="string">&#x27;-&#x27;</span> * num_line,percent) <span class="comment">#带输出的字符串，&#x27;\r&#x27;表示不换行回到最左边#带输出的字符串，&#x27;\r&#x27;表示不换行回到最左边</span></span><br><span class="line">        sys.stdout.write(process_bar) <span class="comment">#这两句打印字符到终端</span></span><br><span class="line">        sys.stdout.flush()</span><br><span class="line">        <span class="keyword">if</span> self.i &gt;= self.max_steps:</span><br><span class="line">            self.close()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">close</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(self.infoDone)</span><br><span class="line">        self.i = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">VALUE = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">start_import</span>():</span></span><br><span class="line">    <span class="keyword">global</span> VALUE</span><br><span class="line">    <span class="keyword">while</span>(<span class="literal">True</span>):</span><br><span class="line">        VALUE += <span class="number">1</span></span><br><span class="line">        time.sleep(<span class="number">0.2</span> * random.random())</span><br><span class="line">        <span class="keyword">if</span> VALUE == <span class="number">100</span>:</span><br><span class="line">            time.sleep(<span class="number">2</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">monitor_process</span>(<span class="params"> threadName, delay</span>):</span></span><br><span class="line">    max_steps = <span class="number">100</span></span><br><span class="line">    process_bar = ShowProcess(max_steps, <span class="string">&#x27;OK&#x27;</span>) <span class="comment"># 1.在循环前定义类的实体， max_steps是总的步数， infoDone是在完成时需要显示的字符串</span></span><br><span class="line">    <span class="comment"># for i in range(max_steps):</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="literal">True</span>):</span><br><span class="line">        process_bar.show_process(VALUE)      <span class="comment"># 2.显示当前进度</span></span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span>(VALUE == <span class="number">100</span>):</span><br><span class="line">            process_bar.show_process(<span class="number">100</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">_thread.start_new_thread( monitor_process, (<span class="string">&quot;Thread-1&quot;</span>, <span class="number">2</span>, ) )</span><br><span class="line">start_import()</span><br></pre></td></tr></table></figure>

<p><img src="/img/post/2018/09/2018-09-12-PyProgressBar-demo06.gif" alt="Demo06"></p>
<p>更多信息可以参考：</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/jsben/p/5792952.html">https://www.cnblogs.com/jsben/p/5792952.html</a></p>
<p><a target="_blank" rel="noopener" href="https://pypi.org/project/tqdm/">https://pypi.org/project/tqdm/</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2018-09-07T16:00:00.000Z" title="2018/9/8 上午12:00:00">2018-09-08</time></span><span class="level-item">Updated&nbsp;<time dateTime="2018-10-18T13:45:48.462Z" title="2018/10/18 下午9:45:48">2018-10-18</time></span><span class="level-item"> BF </span><span class="level-item">8 minutes read (About 1226 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/09/08/2018/09/2018-09-08-PyXPath/">XPath in Python</a></h1><div class="content"><h1 id="XPath-In-Python"><a href="#XPath-In-Python" class="headerlink" title="XPath In Python"></a>XPath In Python</h1><p>在对<code>XML</code>文件进行处理的时候，可以使用标准<code>DOM</code>的 api，但是相对来说不是很方便。</p>
<p>使用<code>XPath</code>的话就可以快速的定位节点，选取得到想要的值。</p>
<p>下面就对在<code>Python</code>中使用<code>XPath</code>处理<code>XML</code>文档做简单的介绍。</p>
<h2 id="XML-File"><a href="#XML-File" class="headerlink" title="XML File"></a>XML File</h2><p>下面是一个简单的<code>XML</code>的例子，可以看到基本的<code>Element</code>, <code>Node</code>, <code>Attribute</code>, <code>Text</code>等都是有的。</p>
<p>以<code>&lt;bookstore&gt;</code>为根结点，有多个<code>&lt;book&gt;</code>，每个<code>&lt;book&gt;</code>都有不同的种类，再下一层是书的<code>&lt;title&gt;</code> <code>&lt;author</code>等具体信息。</p>
<p>层次与内容还是比较清晰的。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bookstore</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">book</span> <span class="attr">category</span>=<span class="string">&quot;COOKING&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span>Everyday Italian<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">author</span>&gt;</span>Giada De Laurentiis<span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">year</span>&gt;</span>2005<span class="tag">&lt;/<span class="name">year</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">price</span>&gt;</span>30.00<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">book</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">book</span> <span class="attr">category</span>=<span class="string">&quot;CHILDREN&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span>Harry Potter<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">author</span>&gt;</span>J K. Rowling<span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">year</span>&gt;</span>2005<span class="tag">&lt;/<span class="name">year</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">price</span>&gt;</span>29.99<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">book</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">book</span> <span class="attr">category</span>=<span class="string">&quot;WEB&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span>XQuery Kick Start<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">author</span>&gt;</span>James McGovern<span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">author</span>&gt;</span>Per Bothner<span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">author</span>&gt;</span>Kurt Cagle<span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">author</span>&gt;</span>James Linn<span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">author</span>&gt;</span>Vaidyanathan Nagarajan<span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">year</span>&gt;</span>2003<span class="tag">&lt;/<span class="name">year</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">price</span>&gt;</span>49.99<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">book</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">book</span> <span class="attr">category</span>=<span class="string">&quot;WEB&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span>Learning XML<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">author</span>&gt;</span>Erik T. Ray<span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">year</span>&gt;</span>2003<span class="tag">&lt;/<span class="name">year</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">price</span>&gt;</span>39.95<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">book</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">bookstore</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="XPath"><a href="#XPath" class="headerlink" title="XPath"></a>XPath</h2><p><code>XPath</code> 于 1999 年 11 月 16 日 成为 W3C 标准。</p>
<p><code>XPath</code> 被设计为供 <a target="_blank" rel="noopener" href="http://www.w3school.com.cn/xsl/index.asp">XSLT</a>、<a target="_blank" rel="noopener" href="http://www.w3school.com.cn/xlink/index.asp">XPointer</a> 以及其他 XML 解析软件使用</p>
<p>下面主要简单介绍主要的语法：</p>
<h3 id="Select-Node"><a href="#Select-Node" class="headerlink" title="Select Node"></a>Select Node</h3><p><code>XPath</code> 使用路径表达式在 <code>XML</code> 文档中选取节点。节点是通过沿着路径或者 <code>step</code> 来选取的。</p>
<p>下面列出了最有用的路径表达式：</p>
<table>
<thead>
<tr>
<th>表达式</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>nodename</td>
<td>选取此节点的所有子节点。</td>
</tr>
<tr>
<td>/</td>
<td>从根节点选取。</td>
</tr>
<tr>
<td>//</td>
<td>从匹配选择的当前节点选择文档中的节点，而不考虑它们的位置。</td>
</tr>
<tr>
<td>.</td>
<td>选取当前节点。</td>
</tr>
<tr>
<td>..</td>
<td>选取当前节点的父节点。</td>
</tr>
<tr>
<td>@</td>
<td>选取属性。</td>
</tr>
</tbody></table>
<h3 id="Predicates"><a href="#Predicates" class="headerlink" title="Predicates"></a>Predicates</h3><p>谓语用来查找某个特定的节点或者包含某个指定的值的节点。</p>
<p>谓语被嵌在方括号中。</p>
<p>在下面的表格中，我们列出了带有谓语的一些路径表达式，以及表达式的结果：</p>
<table>
<thead>
<tr>
<th>路径表达式</th>
<th>结果</th>
</tr>
</thead>
<tbody><tr>
<td>/bookstore/book[1]</td>
<td>选取属于 bookstore 子元素的第一个 book 元素。</td>
</tr>
<tr>
<td>/bookstore/book[last()]</td>
<td>选取属于 bookstore 子元素的最后一个 book 元素。</td>
</tr>
<tr>
<td>/bookstore/book[last()-1]</td>
<td>选取属于 bookstore 子元素的倒数第二个 book 元素。</td>
</tr>
<tr>
<td>/bookstore/book[position()&lt;3]</td>
<td>选取最前面的两个属于 bookstore 元素的子元素的 book 元素。</td>
</tr>
<tr>
<td>//title[@lang]</td>
<td>选取所有拥有名为 lang 的属性的 title 元素。</td>
</tr>
<tr>
<td>//title[@lang=’eng’]</td>
<td>选取所有 title 元素，且这些元素拥有值为 eng 的 lang 属性。</td>
</tr>
<tr>
<td>/bookstore/book[price&gt;35.00]</td>
<td>选取 bookstore 元素的所有 book 元素，且其中的 price 元素的值须大于 35.00。</td>
</tr>
<tr>
<td>/bookstore/book[price&gt;35.00]/title</td>
<td>选取 bookstore 元素中的 book 元素的所有 title 元素，且其中的 price 元素的值须大于 35.00。</td>
</tr>
</tbody></table>
<h3 id="Unknow-Node"><a href="#Unknow-Node" class="headerlink" title="Unknow Node"></a>Unknow Node</h3><p>XPath 通配符可用来选取未知的 XML 元素。</p>
<table>
<thead>
<tr>
<th>通配符</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>*</td>
<td>匹配任何元素节点。</td>
</tr>
<tr>
<td>@*</td>
<td>匹配任何属性节点。</td>
</tr>
<tr>
<td>node()</td>
<td>匹配任何类型的节点。</td>
</tr>
</tbody></table>
<h3 id="Select-Several-Paths"><a href="#Select-Several-Paths" class="headerlink" title="Select Several Paths"></a>Select Several Paths</h3><p>通过在路径表达式中使用<code>|</code>运算符，可以选取若干个路径。</p>
<table>
<thead>
<tr>
<th>路径表达式</th>
<th>结果</th>
</tr>
</thead>
<tbody><tr>
<td>//book/title | //book/price</td>
<td>选取 book 元素的所有 title 和 price 元素。</td>
</tr>
<tr>
<td>//title | //price</td>
<td>选取文档中的所有 title 和 price 元素。</td>
</tr>
<tr>
<td>/bookstore/book/title | //price</td>
<td>选取属于 bookstore 元素的 book 元素的所有 title 元素，<br/>以及文档中所有的 price 元素。</td>
</tr>
</tbody></table>
<h2 id="Practise-in-python"><a href="#Practise-in-python" class="headerlink" title="Practise in python"></a>Practise in python</h2><p>下面主要简单介绍使用<code>xml.etree.ElementTree</code>在<code>python</code>中使用<code>XPath</code></p>
<h3 id="Get-node-by-text-value"><a href="#Get-node-by-text-value" class="headerlink" title="Get node by text value"></a>Get node by text value</h3><p>在上面的例子中，我们想要得到书名为<code>Learning XML</code>的书的信息，所以<code>XPath</code>路径应该为<code>//book[title=&#39;Learning XML&#39;]</code></p>
<p>然后再把信息打印出来</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xml.etree.ElementTree <span class="keyword">as</span> ET</span><br><span class="line"></span><br><span class="line">xml_file_path = <span class="string">&#x27;sample.xml&#x27;</span></span><br><span class="line">xml_et  = ET.parse(xml_file_path)</span><br><span class="line"></span><br><span class="line">node_book = xml_et.find(<span class="string">&quot;.//book[title=&#x27;Learning XML&#x27;]&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(node_book)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(node_book.tag)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>(node_book.attrib))</span><br><span class="line"><span class="keyword">for</span> child <span class="keyword">in</span> node_book:</span><br><span class="line">    <span class="built_in">print</span>(child.tag, child.attrib, child.text)</span><br></pre></td></tr></table></figure>

<p>output:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\mayn\Desktop\python_test\xpath_in_python&gt; python .\xpath_python.py</span><br><span class="line">&lt;Element <span class="string">&#x27;book&#x27;</span> at 0x03642CC0&gt;</span><br><span class="line">book</span><br><span class="line">&#123;<span class="string">&#x27;category&#x27;</span>: <span class="string">&#x27;WEB&#x27;</span>&#125;</span><br><span class="line">title &#123;<span class="string">&#x27;lang&#x27;</span>: <span class="string">&#x27;en&#x27;</span>&#125; Learning XML</span><br><span class="line">author &#123;&#125; Erik T. Ray</span><br><span class="line">year &#123;&#125; 2003</span><br><span class="line">price &#123;&#125; 39.95</span><br></pre></td></tr></table></figure>

<h3 id="Get-node-by-attribute-value"><a href="#Get-node-by-attribute-value" class="headerlink" title="Get node by attribute value"></a>Get node by attribute value</h3><p>如果我们想找到种类为<code>WEB</code>的所以的书，那我们可以用<code>.//book[@category=&#39;WEB&#39;]</code>。</p>
<p>但是如果我们还是用<code>find</code>的话，只能得到第一个符合条件的，所以我们需要用<code>findall</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xml.etree.ElementTree <span class="keyword">as</span> ET</span><br><span class="line"></span><br><span class="line">xml_file_path = <span class="string">&#x27;sample.xml&#x27;</span></span><br><span class="line">xml_et  = ET.parse(xml_file_path)</span><br><span class="line"></span><br><span class="line">node_books = xml_et.findall(<span class="string">&quot;.//book[@category=&#x27;WEB&#x27;]&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(node_books)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> node_book <span class="keyword">in</span> node_books:</span><br><span class="line">    <span class="built_in">print</span>(node_book.tag)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">str</span>(node_book.attrib))</span><br><span class="line">    <span class="keyword">for</span> child <span class="keyword">in</span> node_book:</span><br><span class="line">        <span class="built_in">print</span>(child.tag, child.attrib, child.text)</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\mayn\Desktop\python_test\xpath_in_python&gt; python .\xpath_python.py</span><br><span class="line">[&lt;Element &#x27;book&#x27; at 0x02F12AB0&gt;, &lt;Element &#x27;book&#x27; at 0x02F12CC0&gt;]</span><br><span class="line">book</span><br><span class="line">&#123;&#x27;category&#x27;: &#x27;WEB&#x27;&#125;</span><br><span class="line">title &#123;&#x27;lang&#x27;: &#x27;en&#x27;&#125; XQuery Kick Start</span><br><span class="line">author &#123;&#125; James McGovern</span><br><span class="line">author &#123;&#125; Per Bothner</span><br><span class="line">author &#123;&#125; Kurt Cagle</span><br><span class="line">author &#123;&#125; James Linn</span><br><span class="line">author &#123;&#125; Vaidyanathan Nagarajan</span><br><span class="line">year &#123;&#125; 2003</span><br><span class="line">price &#123;&#125; 49.99</span><br><span class="line">book</span><br><span class="line">&#123;&#x27;category&#x27;: &#x27;WEB&#x27;&#125;</span><br><span class="line">title &#123;&#x27;lang&#x27;: &#x27;en&#x27;&#125; Learning XML</span><br><span class="line">author &#123;&#125; Erik T. Ray</span><br><span class="line">year &#123;&#125; 2003</span><br><span class="line">price &#123;&#125; 39.95</span><br></pre></td></tr></table></figure>

<h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>总之，因为<code>XML</code>的结构化特性，使用<code>XPath</code>能非常方便的去query我们想要的信息。</p>
<p>在<code>python</code>中，结合<code>ElementTree</code>的API，能很方便的操作XML文档。</p>
<p>更多信息可以参考：</p>
<p><a target="_blank" rel="noopener" href="http://www.w3school.com.cn/xpath/index.asp">http://www.w3school.com.cn/xpath/index.asp</a></p>
<p><a target="_blank" rel="noopener" href="https://docs.python.org/3/library/xml.etree.elementtree.html">https://docs.python.org/3/library/xml.etree.elementtree.html</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2018-09-04T16:00:00.000Z" title="2018/9/5 上午12:00:00">2018-09-05</time></span><span class="level-item">Updated&nbsp;<time dateTime="2018-10-18T13:45:48.462Z" title="2018/10/18 下午9:45:48">2018-10-18</time></span><span class="level-item"> BF </span><span class="level-item">10 minutes read (About 1447 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/09/05/2018/09/2018-09-05-PyClass/">Class In Python</a></h1><div class="content"><h1 id="Class-In-Python"><a href="#Class-In-Python" class="headerlink" title="Class In Python"></a>Class In Python</h1><p>今天简单总结下在<code>Python</code>中定义类的方法，包括属性，方法，继承等方面的内容。</p>
<p>主要还是根据自己的实践和踩过的坑来描述，后续如果有新的内容，会继续更新。</p>
<h2 id="A-Simple-Class"><a href="#A-Simple-Class" class="headerlink" title="A Simple Class"></a>A Simple Class</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#simple_class.py</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SimpleClass</span>():</span></span><br><span class="line">    property_01 = <span class="string">&#x27;property_01&#x27;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.property_02 = <span class="string">&#x27;property_02&#x27;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;init a class&#x27;</span>, self.__class__.__name__, self.property_01)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__del__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&#x27;destory class&#x27;</span>, self.__class__.__name__, self.property_02)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;test&#x27;</span>)</span><br><span class="line">simple_class = SimpleClass()</span><br><span class="line">simple_class.test()</span><br></pre></td></tr></table></figure>

<p>运行的结果如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\mayn\Desktop\python_test\class_in_python&gt; python .\simple_class.py</span><br><span class="line">init a class SimpleClass property_01</span><br><span class="line">test</span><br><span class="line">destory class SimpleClass property_02</span><br></pre></td></tr></table></figure>

<p>长话短说，上面的例子中，定义了一个非常简单类，有两个属性<code>property_01</code> <code>property_02</code>，两个内置方法<code>__init__</code> <code>__del__</code>，代表了构造函数与销毁方法</p>
<p>同时，大家也能看到一个很重要的关键字<code>self</code></p>
<h3 id="self"><a href="#self" class="headerlink" title="self"></a><code>self</code></h3><p><code>self</code>在这边有点类似于<code>Java</code>中的<code>this</code>,代表了实例对象，代表当前对象的地址,对实例的许多操作都要靠它。</p>
<p>而神奇的是<code>self</code>并不是 python 的关键字(keyword)，只是按照惯例而叫这个名字，也就是说可以用别的名字代替。</p>
<p>比如，我可以用<code>this</code>,<code>instance</code>等等其实名字，只要是方法的第一个参数就可以:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SimpleClass</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.value = <span class="number">1</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test</span>(<span class="params">this, param</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(this.value + param)</span><br><span class="line">simple_class = SimpleClass()</span><br><span class="line">simple_class.test(<span class="number">1</span>)</span><br><span class="line"><span class="comment"># output: 2</span></span><br></pre></td></tr></table></figure>

<p>上面的例子能正常运行，<code>this</code>, <code>self</code>都代表了该类的实例对象。但很多的 IDE 都只认<code>self</code>,所以大家最好用惯例，除非有特别的需要。</p>
<h3 id="Class-Property-and-Instance-Property"><a href="#Class-Property-and-Instance-Property" class="headerlink" title="Class Property and Instance Property"></a>Class Property and Instance Property</h3><p>熟悉<code>Java</code>的大家都知道，在<code>Java</code>的类里，分为类变量和实例变量，同样的也有类方法和实例方法，通过<code>static</code>关键字来区分。</p>
<p>类变量和类方法都是所以类的实例共享的，并且可以通过<code>Class.static</code> <code>Instance.static</code>来访问。</p>
<p>有注意到第一个例子里，有<code>property_01</code>， <code>property_02</code>两个属性。他们区别就是一个是在方法外定义的，别一个是在方法体中直接使用<code>self</code>来定义使用。</p>
<p>那哪一个是类变量，另一个是实例变量呢？下面例子看完就知道了：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SimpleClass</span>():</span></span><br><span class="line">    property_01 = <span class="string">&#x27;property_01&#x27;</span></span><br><span class="line">    list_01 = [<span class="number">1</span>]</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.property_02 = <span class="string">&#x27;property_02&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;,&#x27;</span>.join([self.property_01, self.property_02])</span><br><span class="line"></span><br><span class="line">SimpleClass.property_01 = <span class="string">&#x27;property_01_changed&#x27;</span></span><br><span class="line">SimpleClass.list_01.append(<span class="number">2</span>)</span><br><span class="line">simple_class_01 = SimpleClass()</span><br><span class="line">simple_class_02 = SimpleClass()</span><br><span class="line">simple_class_02.property_02 = <span class="string">&#x27;property_02_changed&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(simple_class_01)</span><br><span class="line"><span class="comment"># property_01_changed,property_02</span></span><br><span class="line"><span class="built_in">print</span>(simple_class_02)</span><br><span class="line"><span class="comment"># property_01_changed,property_02_changed</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;simple_class_01:&#x27;</span>,simple_class_01.list_01, <span class="string">&#x27;simple_class_02:&#x27;</span>, simple_class_02.list_01)</span><br><span class="line"><span class="comment"># simple_class_01: [1, 2] simple_class_02: [1, 2]</span></span><br><span class="line"></span><br><span class="line">simple_class_02.property_01 = <span class="string">&#x27;property_01_changed_again&#x27;</span></span><br><span class="line">simple_class_02.list_01.append(<span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(SimpleClass.property_01)</span><br><span class="line"><span class="comment"># property_01_changed</span></span><br><span class="line"><span class="built_in">print</span>(simple_class_01)</span><br><span class="line"><span class="comment"># property_01_changed,property_02</span></span><br><span class="line"><span class="built_in">print</span>(simple_class_02)</span><br><span class="line"><span class="comment"># property_01_changed_again,property_02_changed</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;simple_class_01:&#x27;</span>,simple_class_01.list_01, <span class="string">&#x27;simple_class_02:&#x27;</span>, simple_class_02.list_01)</span><br><span class="line"><span class="comment"># simple_class_01: [1, 2, 3] simple_class_02: [1, 2, 3]</span></span><br></pre></td></tr></table></figure>

<p>是的，如果你仔细看就发现他没有那么严格的类变量与实例变量的区分。</p>
<p>如果是在方法体外的，可以直接通过<code>Class.property</code>来访问并且改变值，但是如果通过<code>Instance.property</code>改变了值之后。该实例的变量就会改变，而<code>Class</code>指向的变量还是没变，其它实例变量也是同一个值。</p>
<h2 id="Class-Method-and-Static-Method"><a href="#Class-Method-and-Static-Method" class="headerlink" title="Class Method and Static Method"></a>Class Method and Static Method</h2><p>我们再来看一个例子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SimpleClass</span>():</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">static_method</span>():</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;this is static method, no cls need&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">class_method_01</span>(<span class="params">cls</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;this is class method 01&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">class_method_02</span>(<span class="params">cls</span>):</span></span><br><span class="line">        cls.class_method_01()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;this is class method 02&#x27;</span>)</span><br><span class="line"></span><br><span class="line">SimpleClass.class_method_02()</span><br><span class="line"><span class="comment"># this is class method 01</span></span><br><span class="line"><span class="comment"># this is class method 02</span></span><br><span class="line">SimpleClass.static_method()</span><br><span class="line"><span class="comment"># this is static method, no cls need</span></span><br></pre></td></tr></table></figure>

<p>可以看到，可以定义<code>static method</code>和<code>class method</code>来通过类名直接访问使用。</p>
<p>那他们的区别是什么呢？</p>
<h3 id="static-method"><a href="#static-method" class="headerlink" title="static method"></a>static method</h3><p>静态方法其实就是一个单纯的方法，相当于把类外的一个普通方法挪到这个类中，通过类名访问。但是他其实是和这个类及其实例没有任何的关联，所以他不能调用得到这个类的其实信息。</p>
<h3 id="class-method"><a href="#class-method" class="headerlink" title="class method"></a>class method</h3><p>类方法刚可以通过<code>cls</code>得到类的其他信息，比如调用其它的类方法。</p>
<h2 id="Inherit"><a href="#Inherit" class="headerlink" title="Inherit"></a>Inherit</h2><p>我们再来看一个例子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Teacher</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.__private_data = <span class="string">&#x27;Teacher private data&#x27;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">start_teach</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;start teach!&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(self.__private_data)</span><br><span class="line">        self.__private_method()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">say_hi</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;hi!I&#x27;m &#123;&#125;&quot;</span>.<span class="built_in">format</span>(self.name))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__private_method</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;private method&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_protect_method</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;protect method&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MathTeacher</span>(<span class="params">Teacher</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, salary</span>):</span></span><br><span class="line">        <span class="built_in">super</span>(MathTeacher, self).__init__(name)</span><br><span class="line">        self.salary = salary</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">start_teach</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;MathTeacher start to teach! with salary=&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(self.salary))</span><br><span class="line">        self._protect_method()</span><br><span class="line"></span><br><span class="line">teacher = Teacher(<span class="string">&#x27;Teacher_01&#x27;</span>)</span><br><span class="line">teacher.say_hi()</span><br><span class="line"><span class="comment"># hi!I&#x27;m Teacher_01</span></span><br><span class="line">teacher.start_teach()</span><br><span class="line"><span class="comment"># start teach!</span></span><br><span class="line"><span class="comment"># Teacher private data</span></span><br><span class="line"><span class="comment"># private method</span></span><br><span class="line">mathTeacher = MathTeacher(<span class="string">&#x27;Math_01&#x27;</span>, <span class="number">100</span>)</span><br><span class="line">mathTeacher.say_hi()</span><br><span class="line"><span class="comment"># hi!I&#x27;m Math_01</span></span><br><span class="line">mathTeacher.start_teach()</span><br><span class="line"><span class="comment"># MathTeacher start to teach! with salary=100</span></span><br><span class="line"><span class="comment"># protect method</span></span><br></pre></td></tr></table></figure>

<h3 id="private-protect-data"><a href="#private-protect-data" class="headerlink" title="private/protect data"></a>private/protect data</h3><p>在<code>python</code>中，默认双下划线<code>__</code>是私有的，外部不能访问，在类中代表私有属性和方法，子类不能继承使用。</p>
<p>单下划线<code>_</code>也有特殊意义，有点类似于<code>java</code>中的<code>protect</code>简单总结如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">_xxx    ：保护变量，意思是只有类对象和子类对象能够访问到这些变量(尽量避免在类外部直接修改)</span><br><span class="line">__xxx__ ：系统定义名字</span><br><span class="line">__xxx   ：类中的私有变量名</span><br></pre></td></tr></table></figure>

<h3 id="multi-inheritance"><a href="#multi-inheritance" class="headerlink" title="multi-inheritance"></a>multi-inheritance</h3><p>python 是支持多重继承的，我还没有工作中用过，暂略，到时研究下。</p>
<h2 id="Abstract-Class"><a href="#Abstract-Class" class="headerlink" title="Abstract Class"></a>Abstract Class</h2><p>下面是一个简单的虚类的例子，Teacher 类是不能实例化的，而<code>MathTeacher</code>一定要实现<code>start_teach</code>方法。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> abc <span class="keyword">import</span> ABC,ABCMeta,abstractmethod,abstractproperty</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Teacher</span>(<span class="params">ABC</span>):</span></span><br><span class="line">    __metaclass__ = ABCMeta</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        self.name = name</span><br><span class="line"></span><br><span class="line"><span class="meta">    @abstractmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">start_teach</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">say_hi</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;hi!&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MathTeacher</span>(<span class="params">Teacher</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        <span class="built_in">super</span>(MathTeacher, self).__init__(name)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">start_teach</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;MathTeacher start to teach!&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">math_teacher = MathTeacher(<span class="string">&#x27;Math01&#x27;</span>)</span><br><span class="line">math_teacher.start_teach()</span><br></pre></td></tr></table></figure>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2018-08-28T16:00:00.000Z" title="2018/8/29 上午12:00:00">2018-08-29</time></span><span class="level-item">Updated&nbsp;<time dateTime="2018-10-18T13:45:48.462Z" title="2018/10/18 下午9:45:48">2018-10-18</time></span><span class="level-item"> BF </span><span class="level-item">5 minutes read (About 778 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/08/29/2018/08/2018-08-29-PyFileOperation/">Files Operation In Python</a></h1><div class="content"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># update log:</span></span><br><span class="line"><span class="comment"># 08/30/2018: update the method name style</span></span><br></pre></td></tr></table></figure>

<h1 id="Files-Operation-In-Python"><a href="#Files-Operation-In-Python" class="headerlink" title="Files Operation In Python"></a>Files Operation In Python</h1><p>We usually need to handle files like read/write files with different type, so today I’ll show some codes to do this.</p>
<h2 id="Read-Write-txt-files"><a href="#Read-Write-txt-files" class="headerlink" title="Read/Write txt files"></a>Read/Write txt files</h2><p>For a txt file, we often want to read the file to a string list, sometimes we don’t like to include the <code>\r\n</code>,</p>
<p>then we could use <code>fin.read().splitlines()</code>.</p>
<p>So I create a txt Utils as below to handle several situations</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TxtUtils</span>:</span></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">write_list_to_file_with_newline</span>(<span class="params">cls, filePath, rowsList, mode=<span class="string">&#x27;w&#x27;</span></span>):</span></span><br><span class="line">        PathUtils.check_make_dir_exist(filePath)</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(filePath, mode) <span class="keyword">as</span> f:</span><br><span class="line">            <span class="keyword">for</span> row <span class="keyword">in</span> rowsList:</span><br><span class="line">                f.write(<span class="string">&quot;%s\n&quot;</span> % row)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">write_list_to_txt_file</span>(<span class="params">cls, filePath, rowsList, mode=<span class="string">&#x27;w&#x27;</span></span>):</span></span><br><span class="line">        PathUtils.check_make_dir_exist(filePath)</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(filePath, mode, newline=<span class="string">&#x27;&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            <span class="keyword">for</span> row <span class="keyword">in</span> rowsList:</span><br><span class="line">                f.write(<span class="string">&quot;%s&quot;</span> % row)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">remove_first_line</span>(<span class="params">cls, filePath</span>):</span></span><br><span class="line">        rowList = cls.read_txt_rows_list_with_newline(filePath)</span><br><span class="line">        rowList = <span class="built_in">list</span>(rowList)</span><br><span class="line">        cls.write_list_to_txt_file(filePath, rowList[<span class="number">1</span>:])</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">read_first_line</span>(<span class="params">cls, filePath</span>):</span></span><br><span class="line">        rowList = []</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(filePath, newline=<span class="string">&#x27;&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            rowList = f.read().splitlines()</span><br><span class="line">            rowList = (x <span class="keyword">for</span> x <span class="keyword">in</span> rowList <span class="keyword">if</span> x.strip())</span><br><span class="line">            rowList = <span class="built_in">list</span>(rowList)</span><br><span class="line">        <span class="keyword">return</span> rowList[<span class="number">0</span>] <span class="keyword">if</span> <span class="built_in">len</span>(rowList) &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">read_string_from_txt</span>(<span class="params">cls, filePath</span>):</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(filePath, newline=<span class="string">&#x27;&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            <span class="keyword">return</span> f.read()</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">read_txt_rows_list</span>(<span class="params">cls, filePath</span>):</span></span><br><span class="line">        rowList = []</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(filePath, newline=<span class="string">&#x27;&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            rowList = f.read().splitlines()</span><br><span class="line">            rowList = (x <span class="keyword">for</span> x <span class="keyword">in</span> rowList <span class="keyword">if</span> x.strip())</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">list</span>(rowList)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">read_txt_rows_list_with_newline</span>(<span class="params">cls, filePath</span>):</span></span><br><span class="line">        rowList = []</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(filePath, newline=<span class="string">&#x27;&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            rowList = f.readlines()</span><br><span class="line">            rowList = (x <span class="keyword">for</span> x <span class="keyword">in</span> rowList <span class="keyword">if</span> x.strip())</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">list</span>(rowList)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">replace_variables</span>(<span class="params">cls, file_template, file_destination, <span class="built_in">dict</span></span>):</span></span><br><span class="line">        new_lines = []</span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> cls.read_txt_rows_list_with_newline(file_template):</span><br><span class="line">            <span class="keyword">for</span> key,val <span class="keyword">in</span> <span class="built_in">dict</span>.items():</span><br><span class="line">                line = line.replace(key, val)</span><br><span class="line">            new_lines.append(line)</span><br><span class="line">        cls.write_list_to_txt_file(file_destination, new_lines)</span><br></pre></td></tr></table></figure>

<h2 id="CSV-Files"><a href="#CSV-Files" class="headerlink" title="CSV Files"></a>CSV Files</h2><p><code>CSV</code> format is another common type for a file and I also create a simple utils for this.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">column1,column2,column3</span><br><span class="line">1,11,111</span><br><span class="line">2,22,222</span><br><span class="line">3,33,333</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CSVUtils</span>:</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">write_to_csv_file</span>(<span class="params">filePath, rowsList, delimiterX=<span class="string">&#x27;,&#x27;</span>,quotecharX=<span class="string">&#x27; &#x27;</span>, quotingX=csv.QUOTE_MINIMAL</span>):</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(filePath, <span class="string">&#x27;w&#x27;</span>, newline=<span class="string">&#x27;&#x27;</span>) <span class="keyword">as</span> csvfile:</span><br><span class="line">            spamwriter = csv.writer(csvfile, delimiter=delimiterX, quotechar=quotecharX, quoting=quotingX)</span><br><span class="line">            <span class="keyword">for</span> rows <span class="keyword">in</span> rowsList:</span><br><span class="line">                spamwriter.writerow(rows)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">read_csv_row_list</span>(<span class="params">filePath</span>):</span></span><br><span class="line">        csvRowsList = []</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(filePath, newline=<span class="string">&#x27;&#x27;</span>) <span class="keyword">as</span> csvfile:</span><br><span class="line">            csvReader = csv.reader(csvfile, delimiter=<span class="string">&#x27;,&#x27;</span>, quotechar=<span class="string">&#x27;|&#x27;</span>)</span><br><span class="line">            <span class="keyword">for</span> row <span class="keyword">in</span> csvReader:</span><br><span class="line">                csvRowsList.append(row)</span><br><span class="line">        <span class="keyword">return</span> csvRowsList</span><br></pre></td></tr></table></figure>

<h2 id="Config-file"><a href="#Config-file" class="headerlink" title="Config file"></a>Config file</h2><p>There are different type of config file, e.g. properties, ini, xml, json,…</p>
<h3 id="ini-file"><a href="#ini-file" class="headerlink" title="ini file"></a>ini file</h3><p>Below it’s a simple utils only a function <code>set</code>, to set key/value to a ini file:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConfigUtils</span>:</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set</span>(<span class="params">filePath, section, key, value</span>):</span></span><br><span class="line">        lines = []</span><br><span class="line">        new_lines = []</span><br><span class="line">        sec_expected = <span class="literal">False</span></span><br><span class="line">        key_expected = <span class="literal">False</span></span><br><span class="line">        set_ready    = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(filePath, <span class="string">&#x27;r&#x27;</span>, newline=<span class="string">&#x27;&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            lines = f.readlines()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> index, line <span class="keyword">in</span> <span class="built_in">enumerate</span>(lines):</span><br><span class="line">            is_section = <span class="string">&quot;[&quot;</span> <span class="keyword">in</span> line.strip().lower()</span><br><span class="line">            <span class="keyword">if</span>(is_section <span class="keyword">and</span> section.lower() <span class="keyword">in</span> line.strip().lower()):</span><br><span class="line">                sec_expected = <span class="literal">True</span></span><br><span class="line">                new_lines.append(line)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span>(sec_expected <span class="keyword">and</span> key.lower() <span class="keyword">in</span> line.lower()):</span><br><span class="line">                key_expected = <span class="literal">True</span></span><br><span class="line">                line = <span class="string">&quot;&#123;0&#125;=&#123;1&#125;\r\n&quot;</span>.<span class="built_in">format</span>(key, value)</span><br><span class="line">                new_lines.append(line)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span>(is_section <span class="keyword">and</span> sec_expected <span class="keyword">and</span> <span class="keyword">not</span> key_expected):</span><br><span class="line">                new_lines.append(<span class="string">&quot;&#123;0&#125;=&#123;1&#125;\r\n&quot;</span>.<span class="built_in">format</span>(key, value))</span><br><span class="line">                sec_expected = <span class="literal">False</span></span><br><span class="line">                key_expected = <span class="literal">True</span></span><br><span class="line">            new_lines.append(line)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(filePath, <span class="string">&#x27;w&#x27;</span>, newline=<span class="string">&#x27;&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.writelines(new_lines)</span><br></pre></td></tr></table></figure>

<h2 id="Path-Utils"><a href="#Path-Utils" class="headerlink" title="Path Utils"></a>Path Utils</h2><p>Usually, we have to handle some path e.g. join path, get the file name from the path, convert the path string to other format.</p>
<p>There are a lot of build-in method to do such thing, like <code>os.path.basename(full_path)</code>, so that we could get the simple file name from the full path.</p>
<p>Below it’s a simple utils currently.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PathUtils</span>:</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">check_make_dir_exist</span>(<span class="params">filePath</span>):</span></span><br><span class="line">        fileDir = getDirFromFullPath(filePath)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(fileDir):</span><br><span class="line">            os.makedirs(fileDir)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_dir_name_from_full_path</span>(<span class="params">filePath</span>):</span></span><br><span class="line">        fileDir = filePath</span><br><span class="line">        index1 = filePath.rfind(<span class="string">&quot;\\&quot;</span>)</span><br><span class="line">        index2 = filePath.rfind(<span class="string">&quot;/&quot;</span>)</span><br><span class="line">        index = index1 <span class="keyword">if</span> index1 &gt; index2 <span class="keyword">else</span> index2</span><br><span class="line">        <span class="keyword">if</span>(index &gt; -<span class="number">1</span>):</span><br><span class="line">            fileDir = filePath[<span class="number">0</span>:index]</span><br><span class="line">        <span class="keyword">return</span> fileDir</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_filename_from_full_path</span>(<span class="params">fullPath</span>):</span></span><br><span class="line">        file_name = os.path.basename(fullPath)</span><br><span class="line">        <span class="comment"># lastIndex = fullPath.rfind(&#x27;\\&#x27;)</span></span><br><span class="line">        <span class="comment"># if(lastIndex == -1):</span></span><br><span class="line">            <span class="comment"># lastIndex = fullPath.rfind(&#x27;/&#x27;)</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># if(lastIndex == -1):</span></span><br><span class="line">            <span class="comment"># lastIndex = 0</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># return fullPath[lastIndex:]</span></span><br><span class="line">        <span class="keyword">return</span> file_name</span><br></pre></td></tr></table></figure>

<p>I will continue to update the utils.</p>
<p>Please refer to <a target="_blank" rel="noopener" href="https://github.com/bearfly1990/PowerScript/tree/master/Python3/mylib">https://github.com/bearfly1990/PowerScript/tree/master/Python3/mylib</a> for more information.</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2018-08-27T16:00:00.000Z" title="2018/8/28 上午12:00:00">2018-08-28</time></span><span class="level-item">Updated&nbsp;<time dateTime="2018-10-18T13:45:48.462Z" title="2018/10/18 下午9:45:48">2018-10-18</time></span><span class="level-item"> BF </span><span class="level-item">4 minutes read (About 591 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/08/28/2018/08/2018-08-28-PyDataStructure/">Data Structure In Python</a></h1><div class="content"><h1 id="Data-Structure-In-Python"><a href="#Data-Structure-In-Python" class="headerlink" title="Data Structure In Python"></a>Data Structure In Python</h1><p>Today I met a problem that I would like to count the duplicate items in a list. Generally, I could iterate the list and count it by myself.</p>
<p>But I don’t think that’s a good idea, and python perhaps have the easiest way to do this.</p>
<p>So I searched for the solution and find it. there is a build-in function to do this.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>list_test = [<span class="string">&#x27;test&#x27;</span>,<span class="string">&#x27;test&#x27;</span>,<span class="string">&#x27;xiche&#x27;</span>,<span class="string">&#x27;xiche&#x27;</span>,<span class="string">&#x27;xiche&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,[<span class="string">&#x27;a&#x27;</span>]]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(list_test.count(<span class="string">&#x27;test&#x27;</span>))</span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(list_test.count(<span class="string">&#x27;xiche&#x27;</span>))</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(list_test.count(<span class="number">1</span>))</span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(list_test.count([<span class="string">&#x27;a&#x27;</span>]))</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>So it’s important to be familar with the usage of data structure in python and it will help you to code more efficient.</p>
<p>And let me summarize some basic operations about them and I will continue to update this article when I find some new interesting tips.</p>
<p>Learn to look into offical document is very import.</p>
<h2 id="List"><a href="#List" class="headerlink" title="List"></a>List</h2><p><code>List</code> is a basic data structure, and in python, it’s very flexible and could use it as below:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">list_test</span>():</span></span><br><span class="line">    list_01 = []</span><br><span class="line"></span><br><span class="line">    list_01.append(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">    list_01.append(<span class="string">&#x27;b&#x27;</span>)</span><br><span class="line">    list_01.remove(<span class="string">&#x27;b&#x27;</span>)</span><br><span class="line">    list_02 = [<span class="number">1</span>]</span><br><span class="line">    list_03 = list_01 + list_02</span><br><span class="line">    <span class="built_in">print</span>(list_03)</span><br><span class="line">    <span class="comment">#[&#x27;a&#x27;, 1]</span></span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> list_03:</span><br><span class="line">        <span class="built_in">print</span>(item)</span><br><span class="line">    <span class="comment">#a</span></span><br><span class="line">    <span class="comment">#1</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">len</span>(list_03))</span><br><span class="line">    <span class="comment">#2</span></span><br><span class="line">    list_04 = list_03.copy() <span class="comment"># list_04 = list_03[:]</span></span><br><span class="line">    list_03.clear()</span><br><span class="line">    <span class="built_in">print</span>(list_03)</span><br><span class="line">    <span class="comment">#[]</span></span><br><span class="line">    <span class="built_in">print</span>(list_04)</span><br><span class="line">    <span class="comment">#[&#x27;a&#x27;, 1]</span></span><br><span class="line">    list_04.reverse()</span><br><span class="line">    <span class="built_in">print</span>(list_04)</span><br><span class="line">    <span class="comment">#[1, &#x27;a&#x27;]</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#list_04.sort()</span></span><br><span class="line">    <span class="comment">#print(list_04)</span></span><br><span class="line">    <span class="comment">#Traceback (most recent call last):</span></span><br><span class="line">    <span class="comment">#  File &quot;.\python_structure.py&quot;, line 25, in &lt;module&gt;</span></span><br><span class="line">    <span class="comment">#    list_04.sort()</span></span><br><span class="line">    <span class="comment">#TypeError: &#x27;&lt;&#x27; not supported between instances of &#x27;str&#x27; and &#x27;int&#x27;</span></span><br><span class="line"></span><br><span class="line">    list_04 = [<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">9</span>]</span><br><span class="line">    list_04.sort()</span><br><span class="line">    <span class="built_in">print</span>(list_04)</span><br><span class="line">    <span class="comment">#[2, 3, 4, 9]</span></span><br><span class="line">    list_04.sort(reverse=<span class="literal">True</span>)</span><br><span class="line">    <span class="built_in">print</span>(list_04)</span><br><span class="line">    <span class="comment">#[9, 4, 3, 2]</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(list_04.index(<span class="number">3</span>))</span><br><span class="line">    <span class="comment">#2</span></span><br></pre></td></tr></table></figure>

<h2 id="Stack"><a href="#Stack" class="headerlink" title="Stack"></a>Stack</h2><p>As we know, Stack is always based on <code>List</code> in most languages and the features is:</p>
<p><code>LIFO: Last In First Out</code></p>
<p>we could use method in <code>List</code> to simulate easily by only use <code>append()</code> and <code>pop()</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">stack_test</span>():</span></span><br><span class="line">    stack = []</span><br><span class="line">    stack.append(<span class="number">1</span>)</span><br><span class="line">    stack.append(<span class="number">2</span>)</span><br><span class="line">    stack.append(<span class="number">3</span>)</span><br><span class="line">    <span class="built_in">print</span>(stack)</span><br><span class="line">    <span class="comment">#[1, 2, 3]</span></span><br><span class="line">    value = stack.pop()</span><br><span class="line">    <span class="built_in">print</span>(value)</span><br><span class="line">    <span class="comment">#3</span></span><br><span class="line">    <span class="built_in">print</span>(stack)</span><br><span class="line">    <span class="comment">#[1, 2]</span></span><br><span class="line">    stack.append(<span class="number">4</span>)</span><br><span class="line">    value = stack.pop()</span><br><span class="line">    <span class="built_in">print</span>(value)</span><br><span class="line">    <span class="comment">#4</span></span><br><span class="line">    <span class="built_in">print</span>(stack)</span><br><span class="line">    <span class="comment">#[1, 2]</span></span><br></pre></td></tr></table></figure>

<h2 id="Queue"><a href="#Queue" class="headerlink" title="Queue"></a>Queue</h2><p>Queue is another basic data structure, there is a module <code>queue</code> to handle this:</p>
<p><code>FIFO: First In First Out</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> queue</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">queue_test</span>():</span></span><br><span class="line">    queue_01 = queue.Queue()</span><br><span class="line">    queue_01.put(<span class="number">1</span>)</span><br><span class="line">    queue_01.put(<span class="number">2</span>)</span><br><span class="line">    queue_01.put(<span class="number">3</span>)</span><br><span class="line">    value = queue_01.get()</span><br><span class="line">    <span class="built_in">print</span>(value)</span><br><span class="line">    <span class="comment">#1</span></span><br><span class="line">    queue_01.put(<span class="number">4</span>)</span><br><span class="line">    value = queue_01.get()</span><br><span class="line">    <span class="built_in">print</span>(value)</span><br><span class="line">    <span class="built_in">print</span>(queue_01.empty())</span><br><span class="line">    <span class="comment">#False</span></span><br></pre></td></tr></table></figure>

<h2 id="Dictionaries-Map"><a href="#Dictionaries-Map" class="headerlink" title="Dictionaries(Map)"></a>Dictionaries(Map)</h2><p>Dictionaries is another import data structure in python.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dictionary_test</span>():</span></span><br><span class="line">    fruits = &#123;<span class="string">&#x27;banana&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;apple&#x27;</span>: <span class="number">2</span>&#125;</span><br><span class="line">    <span class="built_in">print</span>(fruits)</span><br><span class="line">    <span class="comment">#&#123;&#x27;banana&#x27;: 1, &#x27;apple&#x27;: 2&#125;</span></span><br><span class="line">    <span class="built_in">print</span>(fruits[<span class="string">&#x27;apple&#x27;</span>])</span><br><span class="line">    <span class="comment">#1</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">list</span>(fruits))</span><br><span class="line">    <span class="comment">#[&#x27;banana&#x27;, &#x27;apple&#x27;]</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">sorted</span>(fruits))</span><br><span class="line">    <span class="comment">#[&#x27;apple&#x27;, &#x27;banana&#x27;]</span></span><br><span class="line">    <span class="keyword">del</span> fruits[<span class="string">&#x27;apple&#x27;</span>]</span><br><span class="line">    <span class="built_in">print</span>(fruits)</span><br><span class="line">    <span class="comment">#&#123;&#x27;banana&#x27;: 1&#125;</span></span><br><span class="line"></span><br><span class="line">    fruits = <span class="built_in">dict</span>([(<span class="string">&#x27;apple&#x27;</span>, <span class="number">10</span>), (<span class="string">&#x27;banana&#x27;</span>, <span class="number">20</span>), (<span class="string">&#x27;watermelon&#x27;</span>, <span class="number">30</span>)])</span><br><span class="line">    <span class="built_in">print</span>(fruits)</span><br><span class="line">    <span class="comment">#&#123;&#x27;apple&#x27;: 10, &#x27;banana&#x27;: 20, &#x27;watermelon&#x27;: 30&#125;</span></span><br><span class="line">    fruits = <span class="built_in">dict</span>(apple=<span class="number">11</span>, banana=<span class="number">21</span>, watermelon=<span class="number">31</span>)</span><br><span class="line">    <span class="built_in">print</span>(fruits)</span><br><span class="line">    <span class="comment">#&#123;&#x27;apple&#x27;: 11, &#x27;banana&#x27;: 21, &#x27;watermelon&#x27;: 31&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> fruit_name <span class="keyword">in</span> fruits:</span><br><span class="line">        <span class="built_in">print</span>(fruits[fruit_name])</span><br><span class="line">    <span class="comment">#11</span></span><br><span class="line">    <span class="comment">#21</span></span><br><span class="line">    <span class="comment">#31</span></span><br></pre></td></tr></table></figure>

<h2 id="Sets"><a href="#Sets" class="headerlink" title="Sets"></a>Sets</h2><p>Sets is usually used to remove the duplicate values</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sets_test</span>():</span></span><br><span class="line">    fruits = &#123;<span class="string">&#x27;apple&#x27;</span>, <span class="string">&#x27;orange&#x27;</span>, <span class="string">&#x27;apple&#x27;</span>, <span class="string">&#x27;pear&#x27;</span>, <span class="string">&#x27;orange&#x27;</span>, <span class="string">&#x27;banana&#x27;</span>&#125;</span><br><span class="line">    <span class="built_in">print</span>(fruits)</span><br><span class="line">    <span class="comment">#&#123;&#x27;banana&#x27;, &#x27;orange&#x27;, &#x27;pear&#x27;, &#x27;apple&#x27;&#125;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;apple&#x27;</span> <span class="keyword">in</span> fruits)</span><br><span class="line">    <span class="comment">#True</span></span><br><span class="line"></span><br><span class="line">    fruits = [<span class="string">&#x27;apple&#x27;</span>, <span class="string">&#x27;orange&#x27;</span>, <span class="string">&#x27;apple&#x27;</span>, <span class="string">&#x27;pear&#x27;</span>, <span class="string">&#x27;orange&#x27;</span>, <span class="string">&#x27;banana&#x27;</span>]</span><br><span class="line">    <span class="built_in">print</span>(fruits)</span><br><span class="line">    <span class="comment">#[&#x27;apple&#x27;, &#x27;orange&#x27;, &#x27;apple&#x27;, &#x27;pear&#x27;, &#x27;orange&#x27;, &#x27;banana&#x27;]</span></span><br><span class="line">    fruits = <span class="built_in">set</span>(fruits)</span><br><span class="line">    <span class="built_in">print</span>(fruits)</span><br><span class="line">    <span class="comment">#&#123;&#x27;apple&#x27;, &#x27;orange&#x27;, &#x27;banana&#x27;, &#x27;pear&#x27;&#125;</span></span><br><span class="line"></span><br><span class="line">    sets_01 = &#123;<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>&#125;</span><br><span class="line">    sets_02 = &#123;<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;e&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(sets_01 &amp; sets_02)</span><br><span class="line">    <span class="comment">#&#x27;c&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(sets_01 | sets_02)</span><br><span class="line">    <span class="comment">#&#123;&#x27;e&#x27;, &#x27;a&#x27;, &#x27;c&#x27;, &#x27;b&#x27;, &#x27;d&#x27;&#125;</span></span><br><span class="line">    <span class="built_in">print</span>(sets_01 - sets_02)</span><br><span class="line">    <span class="comment">#&#123;&#x27;b&#x27;, &#x27;a&#x27;&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Tuples-and-Sequences"><a href="#Tuples-and-Sequences" class="headerlink" title="Tuples and Sequences"></a>Tuples and Sequences</h2><p>Tuples and sequences is also flexible.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_tuples_sequences</span>():</span></span><br><span class="line">    tuples_01 = <span class="number">100</span>,<span class="number">200</span>,<span class="string">&#x27;test&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(tuples_01)</span><br><span class="line">    <span class="comment">#(100, 200, &#x27;test&#x27;)</span></span><br><span class="line">    <span class="built_in">print</span>(tuples_01[<span class="number">2</span>])</span><br><span class="line">    <span class="comment">#test</span></span><br><span class="line">    tuples_02 = <span class="number">300</span>,<span class="number">400</span></span><br><span class="line">    tuples_01 = tuples_01, tuples_02</span><br><span class="line">    <span class="built_in">print</span>(tuples_01)</span><br><span class="line">    <span class="comment">#((100, 200, &#x27;test&#x27;), (300, 400))</span></span><br><span class="line"></span><br><span class="line">    var_01,var_02,var_03 = <span class="number">100</span>,<span class="number">200</span>,<span class="string">&#x27;test&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(var_01, var_02, var_03)</span><br><span class="line">    <span class="comment">#100 200 test</span></span><br></pre></td></tr></table></figure>

<h2 id="To-Be-Continued…"><a href="#To-Be-Continued…" class="headerlink" title="To Be Continued…"></a>To Be Continued…</h2><p>please refer to <a target="_blank" rel="noopener" href="https://docs.python.org/3/tutorial/datastructures.html">https://docs.python.org/3/tutorial/datastructures.html</a> for more information.</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2018-08-26T16:00:00.000Z" title="2018/8/27 上午12:00:00">2018-08-27</time></span><span class="level-item">Updated&nbsp;<time dateTime="2018-10-18T13:45:48.462Z" title="2018/10/18 下午9:45:48">2018-10-18</time></span><span class="level-item"> BF </span><span class="level-item">16 minutes read (About 2431 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/08/27/2018/08/2018-08-27-PerfTestTraining_02/">Performance Test Training (2)</a></h1><div class="content"><h1 id="Performance-Test-Training-2"><a href="#Performance-Test-Training-2" class="headerlink" title="Performance Test Training (2)"></a>Performance Test Training (2)</h1><p>性能测试培训的第二天，主要内容是性能测试一些实例，这些要总结好难，还是要实际操作。</p>
<p>核心的规则还是从进程，到线程，CPU，内存，堆栈，IO，网络一步步分析。</p>
<p>培训上基本上是都是 linux 的命令，我下面简单罗列了一些window下的命令，而且很不全，参考意义不大。</p>
<p>之后有时候再一块一块深入，每一块都有好多细节。。。今天就算给自己交个差吧（捂脸）</p>
<h2 id="Performance-Monitor-Link"><a href="#Performance-Monitor-Link" class="headerlink" title="Performance Monitor (Link)"></a>Performance Monitor <a target="_blank" rel="noopener" href="https://www.cnblogs.com/cappuccino917/p/6699418.html">(Link)</a></h2><p>性能计数器是windows提供的核心监控数据，可以根据自己需要去获取。</p>
<p>Processor: <code>% Processor Time</code> CPU当前利用率，百分比</p>
<p>Memory: <code>Available MBytes</code> 当前可用内存，兆字节（虚拟内存不需要监控，只有当物理内存不够时才会使用虚拟内存，物理内存已有监控）</p>
<p>LogicalDisk: <code>% Free Space</code> 逻辑分区可用空间，百分比（物理磁盘IO由于RAID级别不同，或者有的机器没有RAID，无法定义统一的监控阈值）</p>
<p>Network Interface: <code>Bytes Total/sec</code> 网卡流量：发送+接收，字节</p>
<p>TCPv4: <code>Connections Established</code> 当前连接数（Established + Close-Wait）</p>
<h3 id="CPU"><a href="#CPU" class="headerlink" title="CPU:"></a>CPU:</h3><h4 id="Processor-Time"><a href="#Processor-Time" class="headerlink" title="%Processor Time"></a>%Processor Time</h4><p><code>%Priviliaged Time</code> CPU在特权模式下处理线程所花的时间百分比。一般的系统服务，进城管理，内存管理等一些由操作系统自行启动的进程属于这类</p>
<p><code>%User Time</code> 与<code>%Privileged Time</code>计数器正好相反，指的是在用户状态模式下（即非特权模式）的操作所花的时间百分比。如果该值较大，可以考虑是否通过算法优化等方法降低这个值。如果该服务器是数据库服务器，导致此值较大的原因很可能是数据库的排序或是函数操作消耗了过多的CPU时间，此时可以考虑对数据库系统进行优化。</p>
<p><code>%DPC Time</code> 处理器在网络处理上消耗的时间，该值越低越好。在多处理器系统中，如果这个值大于50%并且<code>%Processor Time</code>非常高，加入一个网卡可能会提高性能。</p>
<h3 id="Memory"><a href="#Memory" class="headerlink" title="Memory:"></a>Memory:</h3><h4 id="Available-Bytes"><a href="#Available-Bytes" class="headerlink" title="Available Bytes"></a>Available Bytes</h4><p><strong>Pages/sec</strong>该计数器显示由于页面不在物理内存中而需要从磁盘读取的页面数。<code>Pages/sec</code> 的值很大不一定表明内存有问题，而可能是运行使用内存映射文件的程序所致，操作系统经常会利用磁盘交换的方式提高系统可用的内存量或是提高内存的使用效率。（注意该计数器与 Page Faults/sec 的区别，后者只表明数据不能在内存的指定工作集中立即使用，包括硬错误和软错误）</p>
<p><strong>Page Faults/sec</strong>计数器可以确保磁盘活动不是由分页导致的。在 Windows 中，换页的原因包括：配置进程占用了过多内存 或者 文件系统活动。</p>
<p>如果在同一硬盘上有多个逻辑分区，需要使用 <code>Logical Disk</code>计数器而非 <code>Physical Disk</code>计数器。查看逻辑磁盘计数器有助于确定哪些文件被频繁访问。当发现磁盘有大量读/写活动时，请查看读写专用计数器以确定导致每个逻辑卷负荷增加的磁盘活动类型，例如，Logical Disk: <code>Disk Write Bytes/sec</code>。</p>
<p><strong>Page Input/sec</strong>表示为了解决硬错误而写入硬盘的页数（参考值：&gt;=<code>Page Reads/sec</code>）</p>
<p><strong>Page Reads/sec</strong> 表示为了解决硬错误而从硬盘上读取的页数。（参考值： &lt;=5）</p>
<p>如果怀疑有内存泄露，请监视 <code>Memory/Available Bytes</code> 和 <code>Memory/ Committed Bytes</code>，以观察内存行为，并监视你认为可能在泄露内存的进程的 <code>Process/ Private Bytes</code>、<code>Process/ Working Set</code> 和<code>Process/ Handle Count</code>。如果怀疑是内核模式进程导致了泄露，则还应该监视 <code>Memory/ Pool Nonpaged Bytes</code>、<code>Memory/ Pool Nonpaged Allocs</code> 和 <code>Process(process_name)/ Pool Nonpaged Bytes</code></p>
<p>如果发生了内存泄漏,<code>process\private bytes</code>计数器和<code>process\working set</code> 计数器的值往往会升高,同时<code>avaiable bytes</code>的值会降低</p>
<p><code>private Bytes</code> 是指进程所分配的无法与其他进程共享的当前字节数量。该计数器主要用来判断进程在性能测试过程中有无内存泄漏。</p>
<p>例如：对于一个IIS之上的web应用，我们可以重点监控inetinfo进程的<code>Private Bytes</code>，如果在性能测试过程中，该进程的<code>Private Bytes</code>计数器值不断增加，或是性能测试停止后一段时间，该进程的<code>Private Bytes</code>仍然持续在高水平，则说明应用存在内存泄漏。</p>
<h3 id="Disk："><a href="#Disk：" class="headerlink" title="Disk："></a>Disk：</h3><h4 id="PhysicalDisk-Avg-Disk-sec-Read"><a href="#PhysicalDisk-Avg-Disk-sec-Read" class="headerlink" title="PhysicalDisk\Avg. Disk sec/Read"></a>PhysicalDisk\Avg. Disk sec/Read</h4><p>以秒计算的在此盘上读取数据的所需平均时间。</p>
<h4 id="Physical-Disk-Disk-Reads-sec"><a href="#Physical-Disk-Disk-Reads-sec" class="headerlink" title="Physical Disk\ Disk Reads/sec"></a>Physical Disk\ Disk Reads/sec</h4><p>在读取操作时从磁盘上传送的字节平均数。</p>
<h4 id="PhysicalDisk-Avg-Disk-sec-Write"><a href="#PhysicalDisk-Avg-Disk-sec-Write" class="headerlink" title="PhysicalDisk\ Avg. Disk sec/Write"></a>PhysicalDisk\ Avg. Disk sec/Write</h4><p>以秒计算的在此盘上写入数据的所需平均时间。</p>
<h4 id="Physical-Disk-DiskWrites-sec"><a href="#Physical-Disk-DiskWrites-sec" class="headerlink" title="Physical Disk\ DiskWrites/sec"></a>Physical Disk\ DiskWrites/sec</h4><p>在写入操作时从磁盘上传送的字节平均数。</p>
<h4 id="Physical-Disk-Avg-Disk-sec-Transfer"><a href="#Physical-Disk-Avg-Disk-sec-Transfer" class="headerlink" title="Physical Disk\ Avg.Disk sec/Transfer"></a>Physical Disk\ Avg.Disk sec/Transfer</h4><p>反映磁盘完成请求所用的时间。较高的值表明磁盘控制器由于失败而不断重试该磁盘。这些故障会增加平均磁盘传送时间。</p>
<h4 id="Disk-Time-和-Avg-Disk-Queue-Length"><a href="#Disk-Time-和-Avg-Disk-Queue-Length" class="headerlink" title="%Disk Time 和 Avg.Disk Queue Length"></a>%Disk Time 和 Avg.Disk Queue Length</h4><p>RAID 磁盘中的 <code>% Disk Time</code> 计数器会指示大于 100% 的值。如果出现这种情况，则使用 <code>PhysicalDisk: Avg.Disk Queue Length</code>计数器来确定等待进行磁盘访问的平均系统请求数量。</p>
<p>如果不是RAID，则使用 <code>% Disk Time</code> 和 <code>Current Disk Queue Length</code>计数器确定是否磁盘存在瓶颈，如果这两个计数器的值一直很高，则可能是磁盘存在瓶颈</p>
<p>Physical Disk： <code>DiskTransfers/sec</code> 磁盘<code>IOPS % Disk Time</code> 当前物理磁盘利用率，如果是RAID，该值会大于100% <code>Current Disk Queue Length</code> 等待进行磁盘访问的当前系统请求数量 <code>Avg.Disk Queue Length</code> 等待进行磁盘访问的平均系统请求数量，用于RAID</p>
<h2 id="Task"><a href="#Task" class="headerlink" title="Task"></a>Task</h2><h3 id="tasklist"><a href="#tasklist" class="headerlink" title="tasklist"></a>tasklist</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\mayn\Desktop&gt; tasklist</span><br><span class="line"></span><br><span class="line">映像名称                       PID 会话名              会话#       内存使用</span><br><span class="line">========================= ======== ================ =========== ============</span><br><span class="line">System Idle Process              0 Services                   0          8 K</span><br><span class="line">System                           4 Services                   0        128 K</span><br><span class="line">Registry                       108 Services                   0     13,504 K</span><br><span class="line">smss.exe                       376 Services                   0      1,168 K</span><br><span class="line">csrss.exe                      580 Services                   0      4,932 K</span><br><span class="line">wininit.exe                    672 Services                   0      6,576 K</span><br><span class="line">csrss.exe                      680 Console                    1      5,368 K</span><br></pre></td></tr></table></figure>

<h3 id="tskill-taskkill"><a href="#tskill-taskkill" class="headerlink" title="tskill/taskkill"></a>tskill/taskkill</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tskill notepad</span><br></pre></td></tr></table></figure>
<h2 id="CPU-1"><a href="#CPU-1" class="headerlink" title="CPU"></a>CPU</h2><h3 id="wmic-cpu"><a href="#wmic-cpu" class="headerlink" title="wmic cpu"></a>wmic cpu</h3><p>上面显示的有位宽，最大始终频率， 生产厂商，二级缓存等信息</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\mayn\Desktop&gt; wmic cpu</span><br><span class="line">AddressWidth  Architecture  AssetTag                Availability  Caption                                 Characteristics  ConfigManagerErrorCode  ConfigManagerUserConfig  CpuStatus  CreationClassName  CurrentClockSpeed  CurrentVoltage  DataWidth  Description                             DeviceID  ErrorCleared  ErrorDescription  ExtClock  Family  InstallDate  L2CacheSize  L2CacheSpeed  L3CacheSize  L3CacheSpeed  LastErrorCode  Level  LoadPercentage  Manufacturer  MaxClockSpeed  Name                                     NumberOfCores  NumberOfEnabledCore  NumberOfLogicalProcessors  OtherFamilyDescription  PartNumber              PNPDeviceID  PowerManagementCapabilities  PowerManagementSupported  ProcessorId       ProcessorType  Revision  Role  SecondLevelAddressTranslationExtensions  SerialNumber            SocketDesignation  Status  StatusInfo  Stepping  SystemCreationClassName  SystemName  ThreadCount  UniqueId  UpgradeMethod  Version  VirtualizationFirmwareEnabled  VMMonitorModeExtensions  VoltageCaps</span><br><span class="line">64            9             To Be Filled By O.E.M.  3             Intel64 Family 6 Model 158 Stepping 10  236                                                               1          Win32_Processor    3000               10              64         Intel64 Family 6 Model 158 Stepping 10  CPU0                                      100       205                  1536                       9216         0                            6      13              GenuineIntel  3000           Intel(R) Core(TM) i5-8500 CPU @ 3.00GHz  6              6                    6                                                  To Be Filled By O.E.M.                                            FALSE                     BFEBFBFF000906EA  3                        CPU   TRUE                                     To Be Filled By O.E.M.  LGA1151            OK      3                     Win32_ComputerSystem     PC-CX       6                      1                       FALSE                          TRUE</span><br></pre></td></tr></table></figure>

<h2 id="Memory-1"><a href="#Memory-1" class="headerlink" title="Memory"></a>Memory</h2><h3 id="wmic-memorychip"><a href="#wmic-memorychip" class="headerlink" title="wmic memorychip"></a>wmic memorychip</h3><p>可以显示出来 2 条内存，各 8G 速度 2666MHz</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\mayn\Desktop&gt; wmic memorychip</span><br><span class="line">Attributes  BankLabel  Capacity    Caption   ConfiguredClockSpeed  ConfiguredVoltage  CreationClassName     DataWidth  Description  DeviceLocator   FormFactor  HotSwappable  InstallDate  InterleaveDataDepth  InterleavePosition  Manufacturer  MaxVoltage  MemoryType  MinVoltage  Model  Name      OtherIdentifyingInfo  PartNumber       PositionInRow  PoweredOn  Removable  Replaceable  SerialNumber  SKU  SMBIOSMemoryType  Speed  Status  Tag                TotalWidth  TypeDetail  Version</span><br><span class="line">1           BANK 0     8589934592  物理内存   2666                  1200               Win32_PhysicalMemory  64          物理内存     ChannelA-DIMM1  8                                      1                    1                   G-Skill       0           0           0                  物理内存                        F4-2666C19-8GNT                                                    00000000           26                2666           Physical Memory 0  64          128</span><br><span class="line">1           BANK 2     8589934592  物理内存   2666                  1200               Win32_PhysicalMemory  64          物理内存     ChannelB-DIMM1  8                                      1                    2                   G-Skill       0           0           0                  物理内存                        F4-2666C19-8GNT                                                    00000000           26                2666           Physical Memory 1  64          128</span><br></pre></td></tr></table></figure>

<h2 id="Disk"><a href="#Disk" class="headerlink" title="Disk"></a>Disk</h2><h3 id="wmic-logicaldisk"><a href="#wmic-logicaldisk" class="headerlink" title="wmic logicaldisk"></a>wmic logicaldisk</h3><p>可以看到有几个盘，每一个盘的文件系统和剩余空间</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\mayn\Desktop&gt; wmic logicaldisk</span><br><span class="line">Access  Availability  BlockSize  Caption  Compressed  ConfigManagerErrorCode  ConfigManagerUserConfig  CreationClassName  Description   DeviceID  DriveType  ErrorCleared  ErrorDescription  ErrorMethodology  FileSystem  FreeSpace     InstallDate  LastErrorCode  MaximumComponentLength  MediaType  Name  NumberOfBlocks  PNPDeviceID  PowerManagementCapabilities  PowerManagementSupported  ProviderName  Purpose  QuotasDisabled  QuotasIncomplete  QuotasRebuilding  Size           Status  StatusInfo  SupportsDiskQuotas  SupportsFileBasedCompression  SystemCreationClassName  SystemName  VolumeDirty  VolumeName  VolumeSerialNumber</span><br><span class="line">0                                C:       FALSE                                                        Win32_LogicalDisk  本地固定磁盘   C:        3                                                            NTFS        74612744192                               255                     12         C:                                                                                                                                                                   106530430976                       FALSE               TRUE                          Win32_ComputerSystem     PC-CX                                04C2790D</span><br><span class="line">0                                D:       FALSE                                                        Win32_LogicalDisk  本地固定磁盘   D:        3                                                            NTFS        342652858368                              255                     12         D:                                                                                                                                                                   372486508544                       FALSE               TRUE                          Win32_ComputerSystem     PC-CX                                00004823</span><br><span class="line">0                                E:       FALSE                                                        Win32_LogicalDisk  本地固定磁盘   E:        3                                                            NTFS        364452909056                              255                     12         E:                                                                                                                                                                   1000202768384                      FALSE               TRUE                          Win32_ComputerSystem     PC-CX                                00004823</span><br></pre></td></tr></table></figure>

<h3 id="wmic-volume"><a href="#wmic-volume" class="headerlink" title="wmic volume"></a>wmic volume</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\mayn\Desktop&gt; wmic volume</span><br><span class="line">Access  Automount  Availability  BlockSize  BootVolume  Capacity       Caption                                            Compressed  ConfigManagerErrorCode  ConfigManagerUserConfig  CreationClassName  Description  DeviceID                                           DirtyBitSet  DriveLetter  DriveType  ErrorCleared  ErrorDescription  ErrorMethodology  FileSystem  FreeSpace     IndexingEnabled  InstallDate  Label  LastErrorCode  MaximumFileNameLength  Name                                               NumberOfBlocks  PageFilePresent  PNPDeviceID  PowerManagementCapabilities  PowerManagementSupported  Purpose  QuotasEnabled  QuotasIncomplete  QuotasRebuilding  SerialNumber  Status  StatusInfo  SupportsDiskQuotas  SupportsFileBasedCompression  SystemCreationClassName  SystemName  SystemVolume</span><br><span class="line">        TRUE                     4096       TRUE        106530430976   C:\                                                FALSE                                                                                        \\?\Volume&#123;81b9fa95-b225-44ef-84fe-e6b4bcd49f21&#125;\               C:           3                                                            NTFS        74612363264   TRUE                                                255                    C:\                                                                TRUE                                                                                                                                             79853837                          TRUE                TRUE                                                   PC-CX       FALSE</span><br><span class="line">        TRUE                     4096       FALSE       844099584      \\?\Volume&#123;d9656dfe-1091-41c2-b677-aed0eda4ea25&#125;\  FALSE                                                                                        \\?\Volume&#123;d9656dfe-1091-41c2-b677-aed0eda4ea25&#125;\                            3                                                            NTFS        369049600     TRUE                                                255                    \\?\Volume&#123;d9656dfe-1091-41c2-b677-aed0eda4ea25&#125;\                  FALSE                                                                                                                                            2759807823                        TRUE                TRUE                                                   PC-CX       FALSE</span><br><span class="line">        TRUE                     4096       FALSE       372486508544   D:\                                                FALSE                                                                                        \\?\Volume&#123;da460ecc-d1db-4ffc-8fd3-9445c2154bf4&#125;\               D:           3                                                            NTFS        342652858368  TRUE                                                255                    D:\                                                                FALSE                                                                                                                                            18467                             TRUE                TRUE                                                   PC-CX       FALSE</span><br><span class="line">        TRUE                     4096       FALSE       1000202768384  E:\                                                FALSE                                                                                        \\?\Volume&#123;673bf2eb-d8ce-4689-98fe-add079591f66&#125;\               E:           3                                                            NTFS        364452909056  TRUE                                                255                    E:\                                                                FALSE                                                                                                                                            18467                             TRUE                TRUE                                                   PC-CX       FALSE</span><br><span class="line">        TRUE                     2048       FALSE       102539264      \\?\Volume&#123;e9b34647-3273-4702-9f11-7296af3707f2&#125;\                                                                                               \\?\Volume&#123;e9b34647-3273-4702-9f11-7296af3707f2&#125;\                            3                                                            FAT         76158976                                                          255                    \\?\Volume&#123;e9b34647-3273-4702-9f11-7296af3707f2&#125;\                  FALSE                                                                                                                                            18467                             FALSE               FALSE                                                  PC-CX       TRUE</span><br></pre></td></tr></table></figure>

<p>每个盘的剩余空间量，其实上一个命令也可以查看的</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\mayn\Desktop&gt; fsutil volume diskfree c:</span><br><span class="line">可用字节总数              : 74612154368</span><br><span class="line">字节总数                  : 106530430976</span><br><span class="line">可用的尚未使用的字节总数  : 74612154368</span><br></pre></td></tr></table></figure>

<p>这个命令查看每一个卷的容量信息是很方便</p>
<h2 id="BIOS"><a href="#BIOS" class="headerlink" title="BIOS"></a>BIOS</h2><h3 id="wmic-bios"><a href="#wmic-bios" class="headerlink" title="wmic bios"></a>wmic bios</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\mayn\Desktop&gt; wmic bios</span><br><span class="line">BiosCharacteristics                                                              BIOSVersion                                                  BuildNumber  Caption  CodeSet  CurrentLanguage  Description  EmbeddedControllerMajorVersion  EmbeddedControllerMinorVersion  IdentificationCode  InstallableLanguages  InstallDate  LanguageEdition  ListOfLanguages                                                                                                                                                      Manufacturer              Name  OtherTargetOS  PrimaryBIOS  ReleaseDate                SerialNumber          SMBIOSBIOSVersion  SMBIOSMajorVersion  SMBIOSMinorVersion  SMBIOSPresent  SoftwareElementID  SoftwareElementState  Status  SystemBiosMajorVersion  SystemBiosMinorVersion  TargetOperatingSystem  Version</span><br><span class="line">&#123;7, 10, 11, 12, 15, 16, 17, 19, 23, 24, 25, 26, 27, 28, 29, 32, 33, 40, 42, 43&#125;  &#123;&quot;ALASKA - 1072009&quot;, &quot;0401&quot;, &quot;American Megatrends - 5000D&quot;&#125;               0401              en|US|iso8859-1  0401         255                             255                                                 9                                                   &#123;&quot;en|US|iso8859-1&quot;, &quot;fr|FR|iso8859-1&quot;, &quot;zh|TW|unicode&quot;, &quot;zh|CN|unicode&quot;, &quot;ja|JP|unicode&quot;, &quot;de|DE|iso8859-1&quot;, &quot;es|ES|iso8859-1&quot;, &quot;ru|RU|iso8859-5&quot;, &quot;ko|KR|unicode&quot;&#125;  American Megatrends Inc.  0401                 TRUE         20180319000000.000000+000  System Serial Number  0401               3                   1                   TRUE           0401               3                     OK      5                       13                      0                      ALASKA - 1072009</span><br></pre></td></tr></table></figure>
</div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/page/5/">Previous</a></div><div class="pagination-next"><a href="/page/7/">Next</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/">1</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/5/">5</a></li><li><a class="pagination-link is-current" href="/page/6/">6</a></li><li><a class="pagination-link" href="/page/7/">7</a></li><li><a class="pagination-link" href="/page/8/">8</a></li><li><a class="pagination-link" href="/page/9/">9</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/mybear.jpg" alt="bearfly1990"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">bearfly1990</p><p class="is-size-6 is-block">有熊在飞</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>HZ, China</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">81</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">100</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/bearfly1990" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/bearfly1990"><i class="fab fa-github"></i></a></div></div></div><!--!--><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><!--!--><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-08-11T16:00:00.000Z">2021-08-12</time></p><p class="title"><a href="/2021/08/12/2021/08/2021-08-12-box-python-sdk/">box SDK for python</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-08-07T16:00:00.000Z">2021-08-08</time></p><p class="title"><a href="/2021/08/08/2021/08/2021-08-09-kafka-learn-01/">Kafka Learn - 01</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-07-20T16:00:00.000Z">2021-07-21</time></p><p class="title"><a href="/2021/07/21/2021/07/2021-07-21-jaydebeapi/">jaydebeapi</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-07-16T16:00:00.000Z">2021-07-17</time></p><p class="title"><a href="/2021/07/17/2021/07/2021-07-17-NanHu/">NanHu</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-07-03T16:00:00.000Z">2021-07-04</time></p><p class="title"><a href="/2021/07/04/2021/07/2021-07-04-folder-tree/">Folder Tree Info DFS/BFS</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2021/08/"><span class="level-start"><span class="level-item">August 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/07/"><span class="level-start"><span class="level-item">July 2021</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/03/"><span class="level-start"><span class="level-item">March 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/02/"><span class="level-start"><span class="level-item">February 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/10/"><span class="level-start"><span class="level-item">October 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/09/"><span class="level-start"><span class="level-item">September 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/06/"><span class="level-start"><span class="level-item">June 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/05/"><span class="level-start"><span class="level-item">May 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/03/"><span class="level-start"><span class="level-item">March 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/01/"><span class="level-start"><span class="level-item">January 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/12/"><span class="level-start"><span class="level-item">December 2019</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/11/"><span class="level-start"><span class="level-item">November 2019</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/10/"><span class="level-start"><span class="level-item">October 2019</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/08/"><span class="level-start"><span class="level-item">August 2019</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/06/"><span class="level-start"><span class="level-item">June 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/05/"><span class="level-start"><span class="level-item">May 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/03/"><span class="level-start"><span class="level-item">March 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/02/"><span class="level-start"><span class="level-item">February 2019</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/01/"><span class="level-start"><span class="level-item">January 2019</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/12/"><span class="level-start"><span class="level-item">December 2018</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/11/"><span class="level-start"><span class="level-item">November 2018</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/10/"><span class="level-start"><span class="level-item">October 2018</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/09/"><span class="level-start"><span class="level-item">September 2018</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/08/"><span class="level-start"><span class="level-item">August 2018</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/07/"><span class="level-start"><span class="level-item">July 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/06/"><span class="level-start"><span class="level-item">June 2018</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/05/"><span class="level-start"><span class="level-item">May 2018</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/04/"><span class="level-start"><span class="level-item">April 2018</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/2019/"><span class="tag">2019</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Apache/"><span class="tag">Apache</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Diary/"><span class="tag">Diary</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/E-R/"><span class="tag">E-R</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/HDFS/"><span class="tag">HDFS</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Hadoop/"><span class="tag">Hadoop</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Java/"><span class="tag">Java</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Kafka/"><span class="tag">Kafka</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PIL/"><span class="tag">PIL</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Pandas/"><span class="tag">Pandas</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Python/"><span class="tag">Python</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RESTful/"><span class="tag">RESTful</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RPC/"><span class="tag">RPC</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/acm/"><span class="tag">acm</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/algorithm/"><span class="tag">algorithm</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/algorithms/"><span class="tag">algorithms</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/alibaba/"><span class="tag">alibaba</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/annotation/"><span class="tag">annotation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/apidoc/"><span class="tag">apidoc</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/big-data/"><span class="tag">big data</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/bigdata/"><span class="tag">bigdata</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/box/"><span class="tag">box</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/chart/"><span class="tag">chart</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/chartjs/"><span class="tag">chartjs</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/class/"><span class="tag">class</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/colorlog/"><span class="tag">colorlog</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/config/"><span class="tag">config</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/console/"><span class="tag">console</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cpu/"><span class="tag">cpu</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/csv/"><span class="tag">csv</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/dairy/"><span class="tag">dairy</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/data-analysis/"><span class="tag">data analysis</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/data-structure/"><span class="tag">data structure</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/database/"><span class="tag">database</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/db/"><span class="tag">db</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/design-patterns/"><span class="tag">design patterns</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/diary/"><span class="tag">diary</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/dokuwiki/"><span class="tag">dokuwiki</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/download/"><span class="tag">download</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/email/"><span class="tag">email</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/excel/"><span class="tag">excel</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/file/"><span class="tag">file</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/flask-restful/"><span class="tag">flask-restful</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/gRPC/"><span class="tag">gRPC</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/goal/"><span class="tag">goal</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/hadoop/"><span class="tag">hadoop</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/hive/"><span class="tag">hive</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/httpd/"><span class="tag">httpd</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/imageio/"><span class="tag">imageio</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/io/"><span class="tag">io</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/java/"><span class="tag">java</span><span class="tag">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/javascript/"><span class="tag">javascript</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/jdbc/"><span class="tag">jdbc</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/json/"><span class="tag">json</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/life/"><span class="tag">life</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/linux/"><span class="tag">linux</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/lock/"><span class="tag">lock</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/log/"><span class="tag">log</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/manual/"><span class="tag">manual</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/matplotlib/"><span class="tag">matplotlib</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/memory/"><span class="tag">memory</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/monitor/"><span class="tag">monitor</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/moviepy/"><span class="tag">moviepy</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/network/"><span class="tag">network</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/node-js/"><span class="tag">node.js</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/numpy/"><span class="tag">numpy</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/openpyxl/"><span class="tag">openpyxl</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/orm/"><span class="tag">orm</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pandas/"><span class="tag">pandas</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/performance/"><span class="tag">performance</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/php/"><span class="tag">php</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/powershell/"><span class="tag">powershell</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/private/"><span class="tag">private</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/progress-bar/"><span class="tag">progress bar</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/proxy/"><span class="tag">proxy</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pyodbc/"><span class="tag">pyodbc</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/python/"><span class="tag">python</span><span class="tag">45</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pytz/"><span class="tag">pytz</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pywin32/"><span class="tag">pywin32</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/reflect/"><span class="tag">reflect</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/regex/"><span class="tag">regex</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/sdk/"><span class="tag">sdk</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/spider/"><span class="tag">spider</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/springboot/"><span class="tag">springboot</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/sql/"><span class="tag">sql</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/sqlalchemy/"><span class="tag">sqlalchemy</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/swagger/"><span class="tag">swagger</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tasklist/"><span class="tag">tasklist</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/test/"><span class="tag">test</span><span class="tag">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/thread/"><span class="tag">thread</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tiktok/"><span class="tag">tiktok</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tkinter/"><span class="tag">tkinter</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/training/"><span class="tag">training</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/txt/"><span class="tag">txt</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/unicode/"><span class="tag">unicode</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vmware/"><span class="tag">vmware</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/work/"><span class="tag">work</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/xpath/"><span class="tag">xpath</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/yaml/"><span class="tag">yaml</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8D%9A%E5%AE%A2/"><span class="tag">博客</span><span class="tag">1</span></a></div></div></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/favicon.ico" alt="Shawn&#039;Blog Test" height="28"></a><p class="is-size-7"><span>&copy; 2021 Shawn</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>