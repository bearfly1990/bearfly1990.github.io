<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Tag: python - BF Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="BF Blog"><meta name="msapplication-TileImage" content="/img/favicon.ico"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="BF Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="BF Blog"><meta property="og:url" content="https://bearfly1990.github.io/"><meta property="og:site_name" content="BF Blog"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://bearfly1990.github.io/img/og_image.png"><meta property="article:author" content="bearfly1990"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://bearfly1990.github.io"},"headline":"BF Blog","image":["https://bearfly1990.github.io/img/og_image.png"],"author":{"@type":"Person","name":"bearfly1990"},"publisher":{"@type":"Organization","name":"BF Blog","logo":{"@type":"ImageObject","url":"https://bearfly1990.github.io/img/favicon.ico"}},"description":""}</script><link rel="icon" href="/img/favicon.ico"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/favicon.ico" alt="BF Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/bearfly1990"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/tags">Tags</a></li><li class="is-active"><a href="#" aria-current="page">python</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2018-09-04T16:00:00.000Z" title="2018/9/5 上午12:00:00">2018-09-05</time></span><span class="level-item">Updated&nbsp;<time dateTime="2018-10-18T13:45:48.462Z" title="2018/10/18 下午9:45:48">2018-10-18</time></span><span class="level-item"> BF </span><span class="level-item">10 minutes read (About 1447 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/09/05/2018/09/2018-09-05-PyClass/">Class In Python</a></h1><div class="content"><h1 id="Class-In-Python"><a href="#Class-In-Python" class="headerlink" title="Class In Python"></a>Class In Python</h1><p>今天简单总结下在<code>Python</code>中定义类的方法，包括属性，方法，继承等方面的内容。</p>
<p>主要还是根据自己的实践和踩过的坑来描述，后续如果有新的内容，会继续更新。</p>
<h2 id="A-Simple-Class"><a href="#A-Simple-Class" class="headerlink" title="A Simple Class"></a>A Simple Class</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#simple_class.py</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SimpleClass</span>():</span></span><br><span class="line">    property_01 = <span class="string">&#x27;property_01&#x27;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.property_02 = <span class="string">&#x27;property_02&#x27;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;init a class&#x27;</span>, self.__class__.__name__, self.property_01)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__del__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&#x27;destory class&#x27;</span>, self.__class__.__name__, self.property_02)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;test&#x27;</span>)</span><br><span class="line">simple_class = SimpleClass()</span><br><span class="line">simple_class.test()</span><br></pre></td></tr></table></figure>

<p>运行的结果如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\mayn\Desktop\python_test\class_in_python&gt; python .\simple_class.py</span><br><span class="line">init a class SimpleClass property_01</span><br><span class="line">test</span><br><span class="line">destory class SimpleClass property_02</span><br></pre></td></tr></table></figure>

<p>长话短说，上面的例子中，定义了一个非常简单类，有两个属性<code>property_01</code> <code>property_02</code>，两个内置方法<code>__init__</code> <code>__del__</code>，代表了构造函数与销毁方法</p>
<p>同时，大家也能看到一个很重要的关键字<code>self</code></p>
<h3 id="self"><a href="#self" class="headerlink" title="self"></a><code>self</code></h3><p><code>self</code>在这边有点类似于<code>Java</code>中的<code>this</code>,代表了实例对象，代表当前对象的地址,对实例的许多操作都要靠它。</p>
<p>而神奇的是<code>self</code>并不是 python 的关键字(keyword)，只是按照惯例而叫这个名字，也就是说可以用别的名字代替。</p>
<p>比如，我可以用<code>this</code>,<code>instance</code>等等其实名字，只要是方法的第一个参数就可以:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SimpleClass</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.value = <span class="number">1</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test</span>(<span class="params">this, param</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(this.value + param)</span><br><span class="line">simple_class = SimpleClass()</span><br><span class="line">simple_class.test(<span class="number">1</span>)</span><br><span class="line"><span class="comment"># output: 2</span></span><br></pre></td></tr></table></figure>

<p>上面的例子能正常运行，<code>this</code>, <code>self</code>都代表了该类的实例对象。但很多的 IDE 都只认<code>self</code>,所以大家最好用惯例，除非有特别的需要。</p>
<h3 id="Class-Property-and-Instance-Property"><a href="#Class-Property-and-Instance-Property" class="headerlink" title="Class Property and Instance Property"></a>Class Property and Instance Property</h3><p>熟悉<code>Java</code>的大家都知道，在<code>Java</code>的类里，分为类变量和实例变量，同样的也有类方法和实例方法，通过<code>static</code>关键字来区分。</p>
<p>类变量和类方法都是所以类的实例共享的，并且可以通过<code>Class.static</code> <code>Instance.static</code>来访问。</p>
<p>有注意到第一个例子里，有<code>property_01</code>， <code>property_02</code>两个属性。他们区别就是一个是在方法外定义的，别一个是在方法体中直接使用<code>self</code>来定义使用。</p>
<p>那哪一个是类变量，另一个是实例变量呢？下面例子看完就知道了：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SimpleClass</span>():</span></span><br><span class="line">    property_01 = <span class="string">&#x27;property_01&#x27;</span></span><br><span class="line">    list_01 = [<span class="number">1</span>]</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.property_02 = <span class="string">&#x27;property_02&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;,&#x27;</span>.join([self.property_01, self.property_02])</span><br><span class="line"></span><br><span class="line">SimpleClass.property_01 = <span class="string">&#x27;property_01_changed&#x27;</span></span><br><span class="line">SimpleClass.list_01.append(<span class="number">2</span>)</span><br><span class="line">simple_class_01 = SimpleClass()</span><br><span class="line">simple_class_02 = SimpleClass()</span><br><span class="line">simple_class_02.property_02 = <span class="string">&#x27;property_02_changed&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(simple_class_01)</span><br><span class="line"><span class="comment"># property_01_changed,property_02</span></span><br><span class="line"><span class="built_in">print</span>(simple_class_02)</span><br><span class="line"><span class="comment"># property_01_changed,property_02_changed</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;simple_class_01:&#x27;</span>,simple_class_01.list_01, <span class="string">&#x27;simple_class_02:&#x27;</span>, simple_class_02.list_01)</span><br><span class="line"><span class="comment"># simple_class_01: [1, 2] simple_class_02: [1, 2]</span></span><br><span class="line"></span><br><span class="line">simple_class_02.property_01 = <span class="string">&#x27;property_01_changed_again&#x27;</span></span><br><span class="line">simple_class_02.list_01.append(<span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(SimpleClass.property_01)</span><br><span class="line"><span class="comment"># property_01_changed</span></span><br><span class="line"><span class="built_in">print</span>(simple_class_01)</span><br><span class="line"><span class="comment"># property_01_changed,property_02</span></span><br><span class="line"><span class="built_in">print</span>(simple_class_02)</span><br><span class="line"><span class="comment"># property_01_changed_again,property_02_changed</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;simple_class_01:&#x27;</span>,simple_class_01.list_01, <span class="string">&#x27;simple_class_02:&#x27;</span>, simple_class_02.list_01)</span><br><span class="line"><span class="comment"># simple_class_01: [1, 2, 3] simple_class_02: [1, 2, 3]</span></span><br></pre></td></tr></table></figure>

<p>是的，如果你仔细看就发现他没有那么严格的类变量与实例变量的区分。</p>
<p>如果是在方法体外的，可以直接通过<code>Class.property</code>来访问并且改变值，但是如果通过<code>Instance.property</code>改变了值之后。该实例的变量就会改变，而<code>Class</code>指向的变量还是没变，其它实例变量也是同一个值。</p>
<h2 id="Class-Method-and-Static-Method"><a href="#Class-Method-and-Static-Method" class="headerlink" title="Class Method and Static Method"></a>Class Method and Static Method</h2><p>我们再来看一个例子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SimpleClass</span>():</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">static_method</span>():</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;this is static method, no cls need&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">class_method_01</span>(<span class="params">cls</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;this is class method 01&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">class_method_02</span>(<span class="params">cls</span>):</span></span><br><span class="line">        cls.class_method_01()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;this is class method 02&#x27;</span>)</span><br><span class="line"></span><br><span class="line">SimpleClass.class_method_02()</span><br><span class="line"><span class="comment"># this is class method 01</span></span><br><span class="line"><span class="comment"># this is class method 02</span></span><br><span class="line">SimpleClass.static_method()</span><br><span class="line"><span class="comment"># this is static method, no cls need</span></span><br></pre></td></tr></table></figure>

<p>可以看到，可以定义<code>static method</code>和<code>class method</code>来通过类名直接访问使用。</p>
<p>那他们的区别是什么呢？</p>
<h3 id="static-method"><a href="#static-method" class="headerlink" title="static method"></a>static method</h3><p>静态方法其实就是一个单纯的方法，相当于把类外的一个普通方法挪到这个类中，通过类名访问。但是他其实是和这个类及其实例没有任何的关联，所以他不能调用得到这个类的其实信息。</p>
<h3 id="class-method"><a href="#class-method" class="headerlink" title="class method"></a>class method</h3><p>类方法刚可以通过<code>cls</code>得到类的其他信息，比如调用其它的类方法。</p>
<h2 id="Inherit"><a href="#Inherit" class="headerlink" title="Inherit"></a>Inherit</h2><p>我们再来看一个例子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Teacher</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.__private_data = <span class="string">&#x27;Teacher private data&#x27;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">start_teach</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;start teach!&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(self.__private_data)</span><br><span class="line">        self.__private_method()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">say_hi</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;hi!I&#x27;m &#123;&#125;&quot;</span>.<span class="built_in">format</span>(self.name))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__private_method</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;private method&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_protect_method</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;protect method&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MathTeacher</span>(<span class="params">Teacher</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, salary</span>):</span></span><br><span class="line">        <span class="built_in">super</span>(MathTeacher, self).__init__(name)</span><br><span class="line">        self.salary = salary</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">start_teach</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;MathTeacher start to teach! with salary=&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(self.salary))</span><br><span class="line">        self._protect_method()</span><br><span class="line"></span><br><span class="line">teacher = Teacher(<span class="string">&#x27;Teacher_01&#x27;</span>)</span><br><span class="line">teacher.say_hi()</span><br><span class="line"><span class="comment"># hi!I&#x27;m Teacher_01</span></span><br><span class="line">teacher.start_teach()</span><br><span class="line"><span class="comment"># start teach!</span></span><br><span class="line"><span class="comment"># Teacher private data</span></span><br><span class="line"><span class="comment"># private method</span></span><br><span class="line">mathTeacher = MathTeacher(<span class="string">&#x27;Math_01&#x27;</span>, <span class="number">100</span>)</span><br><span class="line">mathTeacher.say_hi()</span><br><span class="line"><span class="comment"># hi!I&#x27;m Math_01</span></span><br><span class="line">mathTeacher.start_teach()</span><br><span class="line"><span class="comment"># MathTeacher start to teach! with salary=100</span></span><br><span class="line"><span class="comment"># protect method</span></span><br></pre></td></tr></table></figure>

<h3 id="private-protect-data"><a href="#private-protect-data" class="headerlink" title="private/protect data"></a>private/protect data</h3><p>在<code>python</code>中，默认双下划线<code>__</code>是私有的，外部不能访问，在类中代表私有属性和方法，子类不能继承使用。</p>
<p>单下划线<code>_</code>也有特殊意义，有点类似于<code>java</code>中的<code>protect</code>简单总结如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">_xxx    ：保护变量，意思是只有类对象和子类对象能够访问到这些变量(尽量避免在类外部直接修改)</span><br><span class="line">__xxx__ ：系统定义名字</span><br><span class="line">__xxx   ：类中的私有变量名</span><br></pre></td></tr></table></figure>

<h3 id="multi-inheritance"><a href="#multi-inheritance" class="headerlink" title="multi-inheritance"></a>multi-inheritance</h3><p>python 是支持多重继承的，我还没有工作中用过，暂略，到时研究下。</p>
<h2 id="Abstract-Class"><a href="#Abstract-Class" class="headerlink" title="Abstract Class"></a>Abstract Class</h2><p>下面是一个简单的虚类的例子，Teacher 类是不能实例化的，而<code>MathTeacher</code>一定要实现<code>start_teach</code>方法。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> abc <span class="keyword">import</span> ABC,ABCMeta,abstractmethod,abstractproperty</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Teacher</span>(<span class="params">ABC</span>):</span></span><br><span class="line">    __metaclass__ = ABCMeta</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        self.name = name</span><br><span class="line"></span><br><span class="line"><span class="meta">    @abstractmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">start_teach</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">say_hi</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;hi!&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MathTeacher</span>(<span class="params">Teacher</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        <span class="built_in">super</span>(MathTeacher, self).__init__(name)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">start_teach</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;MathTeacher start to teach!&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">math_teacher = MathTeacher(<span class="string">&#x27;Math01&#x27;</span>)</span><br><span class="line">math_teacher.start_teach()</span><br></pre></td></tr></table></figure>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2018-08-28T16:00:00.000Z" title="2018/8/29 上午12:00:00">2018-08-29</time></span><span class="level-item">Updated&nbsp;<time dateTime="2018-10-18T13:45:48.462Z" title="2018/10/18 下午9:45:48">2018-10-18</time></span><span class="level-item"> BF </span><span class="level-item">5 minutes read (About 778 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/08/29/2018/08/2018-08-29-PyFileOperation/">Files Operation In Python</a></h1><div class="content"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># update log:</span></span><br><span class="line"><span class="comment"># 08/30/2018: update the method name style</span></span><br></pre></td></tr></table></figure>

<h1 id="Files-Operation-In-Python"><a href="#Files-Operation-In-Python" class="headerlink" title="Files Operation In Python"></a>Files Operation In Python</h1><p>We usually need to handle files like read/write files with different type, so today I’ll show some codes to do this.</p>
<h2 id="Read-Write-txt-files"><a href="#Read-Write-txt-files" class="headerlink" title="Read/Write txt files"></a>Read/Write txt files</h2><p>For a txt file, we often want to read the file to a string list, sometimes we don’t like to include the <code>\r\n</code>,</p>
<p>then we could use <code>fin.read().splitlines()</code>.</p>
<p>So I create a txt Utils as below to handle several situations</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TxtUtils</span>:</span></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">write_list_to_file_with_newline</span>(<span class="params">cls, filePath, rowsList, mode=<span class="string">&#x27;w&#x27;</span></span>):</span></span><br><span class="line">        PathUtils.check_make_dir_exist(filePath)</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(filePath, mode) <span class="keyword">as</span> f:</span><br><span class="line">            <span class="keyword">for</span> row <span class="keyword">in</span> rowsList:</span><br><span class="line">                f.write(<span class="string">&quot;%s\n&quot;</span> % row)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">write_list_to_txt_file</span>(<span class="params">cls, filePath, rowsList, mode=<span class="string">&#x27;w&#x27;</span></span>):</span></span><br><span class="line">        PathUtils.check_make_dir_exist(filePath)</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(filePath, mode, newline=<span class="string">&#x27;&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            <span class="keyword">for</span> row <span class="keyword">in</span> rowsList:</span><br><span class="line">                f.write(<span class="string">&quot;%s&quot;</span> % row)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">remove_first_line</span>(<span class="params">cls, filePath</span>):</span></span><br><span class="line">        rowList = cls.read_txt_rows_list_with_newline(filePath)</span><br><span class="line">        rowList = <span class="built_in">list</span>(rowList)</span><br><span class="line">        cls.write_list_to_txt_file(filePath, rowList[<span class="number">1</span>:])</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">read_first_line</span>(<span class="params">cls, filePath</span>):</span></span><br><span class="line">        rowList = []</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(filePath, newline=<span class="string">&#x27;&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            rowList = f.read().splitlines()</span><br><span class="line">            rowList = (x <span class="keyword">for</span> x <span class="keyword">in</span> rowList <span class="keyword">if</span> x.strip())</span><br><span class="line">            rowList = <span class="built_in">list</span>(rowList)</span><br><span class="line">        <span class="keyword">return</span> rowList[<span class="number">0</span>] <span class="keyword">if</span> <span class="built_in">len</span>(rowList) &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">read_string_from_txt</span>(<span class="params">cls, filePath</span>):</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(filePath, newline=<span class="string">&#x27;&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            <span class="keyword">return</span> f.read()</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">read_txt_rows_list</span>(<span class="params">cls, filePath</span>):</span></span><br><span class="line">        rowList = []</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(filePath, newline=<span class="string">&#x27;&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            rowList = f.read().splitlines()</span><br><span class="line">            rowList = (x <span class="keyword">for</span> x <span class="keyword">in</span> rowList <span class="keyword">if</span> x.strip())</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">list</span>(rowList)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">read_txt_rows_list_with_newline</span>(<span class="params">cls, filePath</span>):</span></span><br><span class="line">        rowList = []</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(filePath, newline=<span class="string">&#x27;&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            rowList = f.readlines()</span><br><span class="line">            rowList = (x <span class="keyword">for</span> x <span class="keyword">in</span> rowList <span class="keyword">if</span> x.strip())</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">list</span>(rowList)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">replace_variables</span>(<span class="params">cls, file_template, file_destination, <span class="built_in">dict</span></span>):</span></span><br><span class="line">        new_lines = []</span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> cls.read_txt_rows_list_with_newline(file_template):</span><br><span class="line">            <span class="keyword">for</span> key,val <span class="keyword">in</span> <span class="built_in">dict</span>.items():</span><br><span class="line">                line = line.replace(key, val)</span><br><span class="line">            new_lines.append(line)</span><br><span class="line">        cls.write_list_to_txt_file(file_destination, new_lines)</span><br></pre></td></tr></table></figure>

<h2 id="CSV-Files"><a href="#CSV-Files" class="headerlink" title="CSV Files"></a>CSV Files</h2><p><code>CSV</code> format is another common type for a file and I also create a simple utils for this.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">column1,column2,column3</span><br><span class="line">1,11,111</span><br><span class="line">2,22,222</span><br><span class="line">3,33,333</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CSVUtils</span>:</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">write_to_csv_file</span>(<span class="params">filePath, rowsList, delimiterX=<span class="string">&#x27;,&#x27;</span>,quotecharX=<span class="string">&#x27; &#x27;</span>, quotingX=csv.QUOTE_MINIMAL</span>):</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(filePath, <span class="string">&#x27;w&#x27;</span>, newline=<span class="string">&#x27;&#x27;</span>) <span class="keyword">as</span> csvfile:</span><br><span class="line">            spamwriter = csv.writer(csvfile, delimiter=delimiterX, quotechar=quotecharX, quoting=quotingX)</span><br><span class="line">            <span class="keyword">for</span> rows <span class="keyword">in</span> rowsList:</span><br><span class="line">                spamwriter.writerow(rows)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">read_csv_row_list</span>(<span class="params">filePath</span>):</span></span><br><span class="line">        csvRowsList = []</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(filePath, newline=<span class="string">&#x27;&#x27;</span>) <span class="keyword">as</span> csvfile:</span><br><span class="line">            csvReader = csv.reader(csvfile, delimiter=<span class="string">&#x27;,&#x27;</span>, quotechar=<span class="string">&#x27;|&#x27;</span>)</span><br><span class="line">            <span class="keyword">for</span> row <span class="keyword">in</span> csvReader:</span><br><span class="line">                csvRowsList.append(row)</span><br><span class="line">        <span class="keyword">return</span> csvRowsList</span><br></pre></td></tr></table></figure>

<h2 id="Config-file"><a href="#Config-file" class="headerlink" title="Config file"></a>Config file</h2><p>There are different type of config file, e.g. properties, ini, xml, json,…</p>
<h3 id="ini-file"><a href="#ini-file" class="headerlink" title="ini file"></a>ini file</h3><p>Below it’s a simple utils only a function <code>set</code>, to set key/value to a ini file:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConfigUtils</span>:</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set</span>(<span class="params">filePath, section, key, value</span>):</span></span><br><span class="line">        lines = []</span><br><span class="line">        new_lines = []</span><br><span class="line">        sec_expected = <span class="literal">False</span></span><br><span class="line">        key_expected = <span class="literal">False</span></span><br><span class="line">        set_ready    = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(filePath, <span class="string">&#x27;r&#x27;</span>, newline=<span class="string">&#x27;&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            lines = f.readlines()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> index, line <span class="keyword">in</span> <span class="built_in">enumerate</span>(lines):</span><br><span class="line">            is_section = <span class="string">&quot;[&quot;</span> <span class="keyword">in</span> line.strip().lower()</span><br><span class="line">            <span class="keyword">if</span>(is_section <span class="keyword">and</span> section.lower() <span class="keyword">in</span> line.strip().lower()):</span><br><span class="line">                sec_expected = <span class="literal">True</span></span><br><span class="line">                new_lines.append(line)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span>(sec_expected <span class="keyword">and</span> key.lower() <span class="keyword">in</span> line.lower()):</span><br><span class="line">                key_expected = <span class="literal">True</span></span><br><span class="line">                line = <span class="string">&quot;&#123;0&#125;=&#123;1&#125;\r\n&quot;</span>.<span class="built_in">format</span>(key, value)</span><br><span class="line">                new_lines.append(line)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span>(is_section <span class="keyword">and</span> sec_expected <span class="keyword">and</span> <span class="keyword">not</span> key_expected):</span><br><span class="line">                new_lines.append(<span class="string">&quot;&#123;0&#125;=&#123;1&#125;\r\n&quot;</span>.<span class="built_in">format</span>(key, value))</span><br><span class="line">                sec_expected = <span class="literal">False</span></span><br><span class="line">                key_expected = <span class="literal">True</span></span><br><span class="line">            new_lines.append(line)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(filePath, <span class="string">&#x27;w&#x27;</span>, newline=<span class="string">&#x27;&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.writelines(new_lines)</span><br></pre></td></tr></table></figure>

<h2 id="Path-Utils"><a href="#Path-Utils" class="headerlink" title="Path Utils"></a>Path Utils</h2><p>Usually, we have to handle some path e.g. join path, get the file name from the path, convert the path string to other format.</p>
<p>There are a lot of build-in method to do such thing, like <code>os.path.basename(full_path)</code>, so that we could get the simple file name from the full path.</p>
<p>Below it’s a simple utils currently.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PathUtils</span>:</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">check_make_dir_exist</span>(<span class="params">filePath</span>):</span></span><br><span class="line">        fileDir = getDirFromFullPath(filePath)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(fileDir):</span><br><span class="line">            os.makedirs(fileDir)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_dir_name_from_full_path</span>(<span class="params">filePath</span>):</span></span><br><span class="line">        fileDir = filePath</span><br><span class="line">        index1 = filePath.rfind(<span class="string">&quot;\\&quot;</span>)</span><br><span class="line">        index2 = filePath.rfind(<span class="string">&quot;/&quot;</span>)</span><br><span class="line">        index = index1 <span class="keyword">if</span> index1 &gt; index2 <span class="keyword">else</span> index2</span><br><span class="line">        <span class="keyword">if</span>(index &gt; -<span class="number">1</span>):</span><br><span class="line">            fileDir = filePath[<span class="number">0</span>:index]</span><br><span class="line">        <span class="keyword">return</span> fileDir</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_filename_from_full_path</span>(<span class="params">fullPath</span>):</span></span><br><span class="line">        file_name = os.path.basename(fullPath)</span><br><span class="line">        <span class="comment"># lastIndex = fullPath.rfind(&#x27;\\&#x27;)</span></span><br><span class="line">        <span class="comment"># if(lastIndex == -1):</span></span><br><span class="line">            <span class="comment"># lastIndex = fullPath.rfind(&#x27;/&#x27;)</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># if(lastIndex == -1):</span></span><br><span class="line">            <span class="comment"># lastIndex = 0</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># return fullPath[lastIndex:]</span></span><br><span class="line">        <span class="keyword">return</span> file_name</span><br></pre></td></tr></table></figure>

<p>I will continue to update the utils.</p>
<p>Please refer to <a target="_blank" rel="noopener" href="https://github.com/bearfly1990/PowerScript/tree/master/Python3/mylib">https://github.com/bearfly1990/PowerScript/tree/master/Python3/mylib</a> for more information.</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2018-08-27T16:00:00.000Z" title="2018/8/28 上午12:00:00">2018-08-28</time></span><span class="level-item">Updated&nbsp;<time dateTime="2018-10-18T13:45:48.462Z" title="2018/10/18 下午9:45:48">2018-10-18</time></span><span class="level-item"> BF </span><span class="level-item">4 minutes read (About 591 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/08/28/2018/08/2018-08-28-PyDataStructure/">Data Structure In Python</a></h1><div class="content"><h1 id="Data-Structure-In-Python"><a href="#Data-Structure-In-Python" class="headerlink" title="Data Structure In Python"></a>Data Structure In Python</h1><p>Today I met a problem that I would like to count the duplicate items in a list. Generally, I could iterate the list and count it by myself.</p>
<p>But I don’t think that’s a good idea, and python perhaps have the easiest way to do this.</p>
<p>So I searched for the solution and find it. there is a build-in function to do this.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>list_test = [<span class="string">&#x27;test&#x27;</span>,<span class="string">&#x27;test&#x27;</span>,<span class="string">&#x27;xiche&#x27;</span>,<span class="string">&#x27;xiche&#x27;</span>,<span class="string">&#x27;xiche&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,[<span class="string">&#x27;a&#x27;</span>]]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(list_test.count(<span class="string">&#x27;test&#x27;</span>))</span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(list_test.count(<span class="string">&#x27;xiche&#x27;</span>))</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(list_test.count(<span class="number">1</span>))</span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(list_test.count([<span class="string">&#x27;a&#x27;</span>]))</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>So it’s important to be familar with the usage of data structure in python and it will help you to code more efficient.</p>
<p>And let me summarize some basic operations about them and I will continue to update this article when I find some new interesting tips.</p>
<p>Learn to look into offical document is very import.</p>
<h2 id="List"><a href="#List" class="headerlink" title="List"></a>List</h2><p><code>List</code> is a basic data structure, and in python, it’s very flexible and could use it as below:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">list_test</span>():</span></span><br><span class="line">    list_01 = []</span><br><span class="line"></span><br><span class="line">    list_01.append(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">    list_01.append(<span class="string">&#x27;b&#x27;</span>)</span><br><span class="line">    list_01.remove(<span class="string">&#x27;b&#x27;</span>)</span><br><span class="line">    list_02 = [<span class="number">1</span>]</span><br><span class="line">    list_03 = list_01 + list_02</span><br><span class="line">    <span class="built_in">print</span>(list_03)</span><br><span class="line">    <span class="comment">#[&#x27;a&#x27;, 1]</span></span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> list_03:</span><br><span class="line">        <span class="built_in">print</span>(item)</span><br><span class="line">    <span class="comment">#a</span></span><br><span class="line">    <span class="comment">#1</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">len</span>(list_03))</span><br><span class="line">    <span class="comment">#2</span></span><br><span class="line">    list_04 = list_03.copy() <span class="comment"># list_04 = list_03[:]</span></span><br><span class="line">    list_03.clear()</span><br><span class="line">    <span class="built_in">print</span>(list_03)</span><br><span class="line">    <span class="comment">#[]</span></span><br><span class="line">    <span class="built_in">print</span>(list_04)</span><br><span class="line">    <span class="comment">#[&#x27;a&#x27;, 1]</span></span><br><span class="line">    list_04.reverse()</span><br><span class="line">    <span class="built_in">print</span>(list_04)</span><br><span class="line">    <span class="comment">#[1, &#x27;a&#x27;]</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#list_04.sort()</span></span><br><span class="line">    <span class="comment">#print(list_04)</span></span><br><span class="line">    <span class="comment">#Traceback (most recent call last):</span></span><br><span class="line">    <span class="comment">#  File &quot;.\python_structure.py&quot;, line 25, in &lt;module&gt;</span></span><br><span class="line">    <span class="comment">#    list_04.sort()</span></span><br><span class="line">    <span class="comment">#TypeError: &#x27;&lt;&#x27; not supported between instances of &#x27;str&#x27; and &#x27;int&#x27;</span></span><br><span class="line"></span><br><span class="line">    list_04 = [<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">9</span>]</span><br><span class="line">    list_04.sort()</span><br><span class="line">    <span class="built_in">print</span>(list_04)</span><br><span class="line">    <span class="comment">#[2, 3, 4, 9]</span></span><br><span class="line">    list_04.sort(reverse=<span class="literal">True</span>)</span><br><span class="line">    <span class="built_in">print</span>(list_04)</span><br><span class="line">    <span class="comment">#[9, 4, 3, 2]</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(list_04.index(<span class="number">3</span>))</span><br><span class="line">    <span class="comment">#2</span></span><br></pre></td></tr></table></figure>

<h2 id="Stack"><a href="#Stack" class="headerlink" title="Stack"></a>Stack</h2><p>As we know, Stack is always based on <code>List</code> in most languages and the features is:</p>
<p><code>LIFO: Last In First Out</code></p>
<p>we could use method in <code>List</code> to simulate easily by only use <code>append()</code> and <code>pop()</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">stack_test</span>():</span></span><br><span class="line">    stack = []</span><br><span class="line">    stack.append(<span class="number">1</span>)</span><br><span class="line">    stack.append(<span class="number">2</span>)</span><br><span class="line">    stack.append(<span class="number">3</span>)</span><br><span class="line">    <span class="built_in">print</span>(stack)</span><br><span class="line">    <span class="comment">#[1, 2, 3]</span></span><br><span class="line">    value = stack.pop()</span><br><span class="line">    <span class="built_in">print</span>(value)</span><br><span class="line">    <span class="comment">#3</span></span><br><span class="line">    <span class="built_in">print</span>(stack)</span><br><span class="line">    <span class="comment">#[1, 2]</span></span><br><span class="line">    stack.append(<span class="number">4</span>)</span><br><span class="line">    value = stack.pop()</span><br><span class="line">    <span class="built_in">print</span>(value)</span><br><span class="line">    <span class="comment">#4</span></span><br><span class="line">    <span class="built_in">print</span>(stack)</span><br><span class="line">    <span class="comment">#[1, 2]</span></span><br></pre></td></tr></table></figure>

<h2 id="Queue"><a href="#Queue" class="headerlink" title="Queue"></a>Queue</h2><p>Queue is another basic data structure, there is a module <code>queue</code> to handle this:</p>
<p><code>FIFO: First In First Out</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> queue</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">queue_test</span>():</span></span><br><span class="line">    queue_01 = queue.Queue()</span><br><span class="line">    queue_01.put(<span class="number">1</span>)</span><br><span class="line">    queue_01.put(<span class="number">2</span>)</span><br><span class="line">    queue_01.put(<span class="number">3</span>)</span><br><span class="line">    value = queue_01.get()</span><br><span class="line">    <span class="built_in">print</span>(value)</span><br><span class="line">    <span class="comment">#1</span></span><br><span class="line">    queue_01.put(<span class="number">4</span>)</span><br><span class="line">    value = queue_01.get()</span><br><span class="line">    <span class="built_in">print</span>(value)</span><br><span class="line">    <span class="built_in">print</span>(queue_01.empty())</span><br><span class="line">    <span class="comment">#False</span></span><br></pre></td></tr></table></figure>

<h2 id="Dictionaries-Map"><a href="#Dictionaries-Map" class="headerlink" title="Dictionaries(Map)"></a>Dictionaries(Map)</h2><p>Dictionaries is another import data structure in python.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dictionary_test</span>():</span></span><br><span class="line">    fruits = &#123;<span class="string">&#x27;banana&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;apple&#x27;</span>: <span class="number">2</span>&#125;</span><br><span class="line">    <span class="built_in">print</span>(fruits)</span><br><span class="line">    <span class="comment">#&#123;&#x27;banana&#x27;: 1, &#x27;apple&#x27;: 2&#125;</span></span><br><span class="line">    <span class="built_in">print</span>(fruits[<span class="string">&#x27;apple&#x27;</span>])</span><br><span class="line">    <span class="comment">#1</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">list</span>(fruits))</span><br><span class="line">    <span class="comment">#[&#x27;banana&#x27;, &#x27;apple&#x27;]</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">sorted</span>(fruits))</span><br><span class="line">    <span class="comment">#[&#x27;apple&#x27;, &#x27;banana&#x27;]</span></span><br><span class="line">    <span class="keyword">del</span> fruits[<span class="string">&#x27;apple&#x27;</span>]</span><br><span class="line">    <span class="built_in">print</span>(fruits)</span><br><span class="line">    <span class="comment">#&#123;&#x27;banana&#x27;: 1&#125;</span></span><br><span class="line"></span><br><span class="line">    fruits = <span class="built_in">dict</span>([(<span class="string">&#x27;apple&#x27;</span>, <span class="number">10</span>), (<span class="string">&#x27;banana&#x27;</span>, <span class="number">20</span>), (<span class="string">&#x27;watermelon&#x27;</span>, <span class="number">30</span>)])</span><br><span class="line">    <span class="built_in">print</span>(fruits)</span><br><span class="line">    <span class="comment">#&#123;&#x27;apple&#x27;: 10, &#x27;banana&#x27;: 20, &#x27;watermelon&#x27;: 30&#125;</span></span><br><span class="line">    fruits = <span class="built_in">dict</span>(apple=<span class="number">11</span>, banana=<span class="number">21</span>, watermelon=<span class="number">31</span>)</span><br><span class="line">    <span class="built_in">print</span>(fruits)</span><br><span class="line">    <span class="comment">#&#123;&#x27;apple&#x27;: 11, &#x27;banana&#x27;: 21, &#x27;watermelon&#x27;: 31&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> fruit_name <span class="keyword">in</span> fruits:</span><br><span class="line">        <span class="built_in">print</span>(fruits[fruit_name])</span><br><span class="line">    <span class="comment">#11</span></span><br><span class="line">    <span class="comment">#21</span></span><br><span class="line">    <span class="comment">#31</span></span><br></pre></td></tr></table></figure>

<h2 id="Sets"><a href="#Sets" class="headerlink" title="Sets"></a>Sets</h2><p>Sets is usually used to remove the duplicate values</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sets_test</span>():</span></span><br><span class="line">    fruits = &#123;<span class="string">&#x27;apple&#x27;</span>, <span class="string">&#x27;orange&#x27;</span>, <span class="string">&#x27;apple&#x27;</span>, <span class="string">&#x27;pear&#x27;</span>, <span class="string">&#x27;orange&#x27;</span>, <span class="string">&#x27;banana&#x27;</span>&#125;</span><br><span class="line">    <span class="built_in">print</span>(fruits)</span><br><span class="line">    <span class="comment">#&#123;&#x27;banana&#x27;, &#x27;orange&#x27;, &#x27;pear&#x27;, &#x27;apple&#x27;&#125;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;apple&#x27;</span> <span class="keyword">in</span> fruits)</span><br><span class="line">    <span class="comment">#True</span></span><br><span class="line"></span><br><span class="line">    fruits = [<span class="string">&#x27;apple&#x27;</span>, <span class="string">&#x27;orange&#x27;</span>, <span class="string">&#x27;apple&#x27;</span>, <span class="string">&#x27;pear&#x27;</span>, <span class="string">&#x27;orange&#x27;</span>, <span class="string">&#x27;banana&#x27;</span>]</span><br><span class="line">    <span class="built_in">print</span>(fruits)</span><br><span class="line">    <span class="comment">#[&#x27;apple&#x27;, &#x27;orange&#x27;, &#x27;apple&#x27;, &#x27;pear&#x27;, &#x27;orange&#x27;, &#x27;banana&#x27;]</span></span><br><span class="line">    fruits = <span class="built_in">set</span>(fruits)</span><br><span class="line">    <span class="built_in">print</span>(fruits)</span><br><span class="line">    <span class="comment">#&#123;&#x27;apple&#x27;, &#x27;orange&#x27;, &#x27;banana&#x27;, &#x27;pear&#x27;&#125;</span></span><br><span class="line"></span><br><span class="line">    sets_01 = &#123;<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>&#125;</span><br><span class="line">    sets_02 = &#123;<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;e&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(sets_01 &amp; sets_02)</span><br><span class="line">    <span class="comment">#&#x27;c&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(sets_01 | sets_02)</span><br><span class="line">    <span class="comment">#&#123;&#x27;e&#x27;, &#x27;a&#x27;, &#x27;c&#x27;, &#x27;b&#x27;, &#x27;d&#x27;&#125;</span></span><br><span class="line">    <span class="built_in">print</span>(sets_01 - sets_02)</span><br><span class="line">    <span class="comment">#&#123;&#x27;b&#x27;, &#x27;a&#x27;&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Tuples-and-Sequences"><a href="#Tuples-and-Sequences" class="headerlink" title="Tuples and Sequences"></a>Tuples and Sequences</h2><p>Tuples and sequences is also flexible.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_tuples_sequences</span>():</span></span><br><span class="line">    tuples_01 = <span class="number">100</span>,<span class="number">200</span>,<span class="string">&#x27;test&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(tuples_01)</span><br><span class="line">    <span class="comment">#(100, 200, &#x27;test&#x27;)</span></span><br><span class="line">    <span class="built_in">print</span>(tuples_01[<span class="number">2</span>])</span><br><span class="line">    <span class="comment">#test</span></span><br><span class="line">    tuples_02 = <span class="number">300</span>,<span class="number">400</span></span><br><span class="line">    tuples_01 = tuples_01, tuples_02</span><br><span class="line">    <span class="built_in">print</span>(tuples_01)</span><br><span class="line">    <span class="comment">#((100, 200, &#x27;test&#x27;), (300, 400))</span></span><br><span class="line"></span><br><span class="line">    var_01,var_02,var_03 = <span class="number">100</span>,<span class="number">200</span>,<span class="string">&#x27;test&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(var_01, var_02, var_03)</span><br><span class="line">    <span class="comment">#100 200 test</span></span><br></pre></td></tr></table></figure>

<h2 id="To-Be-Continued…"><a href="#To-Be-Continued…" class="headerlink" title="To Be Continued…"></a>To Be Continued…</h2><p>please refer to <a target="_blank" rel="noopener" href="https://docs.python.org/3/tutorial/datastructures.html">https://docs.python.org/3/tutorial/datastructures.html</a> for more information.</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2018-08-24T16:00:00.000Z" title="2018/8/25 上午12:00:00">2018-08-25</time></span><span class="level-item">Updated&nbsp;<time dateTime="2018-11-30T15:46:40.248Z" title="2018/11/30 下午11:46:40">2018-11-30</time></span><span class="level-item"> BF </span><span class="level-item">4 minutes read (About 654 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/08/25/2018/08/2018-08-25-SpiderDouban/">Spider for Douban (01)</a></h1><div class="content"><h1 id="Top-n-Movies-of-Spider-for-Douban"><a href="#Top-n-Movies-of-Spider-for-Douban" class="headerlink" title="Top n Movies of Spider for Douban"></a>Top n Movies of Spider for Douban</h1><p>网上有许多爬虫的入门脚本，都是去爬豆瓣前 250 的电影信息，我也参考并写了一个，做为入门。</p>
<p>因为豆瓣的网页结构相对稳定，变化不多，不然要花太多时候去维护。</p>
<p>在代码中可以修改 page 的值来取得更多的页数，我发现其实是可以超过 250 个的，排名 250 后的资源，也可以通过手动修改得到。</p>
<h2 id="Result"><a href="#Result" class="headerlink" title="Result"></a>Result</h2><p>运行后的结果大致如下：</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">肖申克的救赎(9.6)</span><br><span class="line">霸王别姬(9.5)</span><br><span class="line">这个杀手不太冷(9.4)</span><br><span class="line">阿甘正传(9.4)</span><br><span class="line">美丽人生(9.5)</span><br><span class="line">泰坦尼克号(9.3)</span><br><span class="line">千与千寻(9.3)</span><br><span class="line">辛德勒的名单(9.4)</span><br><span class="line">盗梦空间(9.3)</span><br><span class="line">机器人总动员(9.3)</span><br><span class="line">忠犬八公的故事(9.3)</span><br><span class="line">三傻大闹宝莱坞(9.2)</span><br><span class="line">海上钢琴师(9.2)</span><br><span class="line">放牛班的春天(9.2)</span><br><span class="line">大话西游之大圣娶亲(9.2)</span><br><span class="line">楚门的世界(9.1)</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>下载的海报如下：<br><img src="/img/post/2018/08/2018-08-25-SpiderDouban-PostSamples.jpg" alt="Posts"></p>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">author: xiche</span></span><br><span class="line"><span class="string">create at: 08/24/2018</span></span><br><span class="line"><span class="string">description:</span></span><br><span class="line"><span class="string">    Spider for Douban</span></span><br><span class="line"><span class="string">Change log:</span></span><br><span class="line"><span class="string">Date        Author      Version    Description</span></span><br><span class="line"><span class="string">08/24/2018  xiche       1.0        Top n Movies of Spider for Douban</span></span><br><span class="line"><span class="string">08/28/2018  xiche       1.1        refactor the code</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> codecs</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> contextlib <span class="keyword">import</span> closing</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">from</span> abc <span class="keyword">import</span> abstractmethod, ABC</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Spider</span>(<span class="params">ABC</span>):</span></span><br><span class="line">    url_request = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    html = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    HEADER_BROWER = &#123;</span><br><span class="line">        <span class="string">&#x27;User-Agent&#x27;</span>:<span class="string">&#x27;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko)&#x27;</span></span><br><span class="line">            <span class="string">&#x27;Chrome/63.0.3239.132 Safari/537.36&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">download_page</span>(<span class="params">self</span>):</span></span><br><span class="line">        data = requests.get(self.url_request, headers=self.HEADER_BROWER).text</span><br><span class="line">        self.html = data</span><br><span class="line">        <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"><span class="meta">    @abstractmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse_html</span>(<span class="params">self, html</span>):</span></span><br><span class="line">       <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @abstractmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">start_spider</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getPic</span>(<span class="params">self, data</span>):</span></span><br><span class="line">        pic_list = re.findall(<span class="string">r&#x27;src=&quot;http.+?.jpg&quot;&#x27;</span>, data)</span><br><span class="line">        <span class="keyword">return</span> pic_list</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">download_pic</span>(<span class="params">self, url, name, folder = <span class="string">&#x27;imgs/&#x27;</span></span>):</span></span><br><span class="line">        rootPath = folder</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(rootPath):</span><br><span class="line">            os.makedirs(rootPath)</span><br><span class="line">        response = requests.get(url, stream=<span class="literal">True</span>)</span><br><span class="line">        pic_type = <span class="string">&#x27;.&#x27;</span> + url.split(<span class="string">&#x27;.&#x27;</span>)[-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">with</span> closing(requests.get(url, stream=<span class="literal">True</span>)) <span class="keyword">as</span> responses:</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(rootPath + name + pic_type, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">                <span class="keyword">for</span> data <span class="keyword">in</span> response.iter_content(<span class="number">128</span>):</span><br><span class="line">                    file.write(data)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SpiderDouban250</span>(<span class="params">Spider</span>):</span></span><br><span class="line">    start = <span class="number">0</span></span><br><span class="line">    page  = <span class="number">2</span></span><br><span class="line">    movies_list_total = []</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, page=<span class="number">2</span></span>):</span></span><br><span class="line">        self.page = page</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse_html</span>(<span class="params">self, html=<span class="literal">None</span></span>):</span></span><br><span class="line">        html = html <span class="keyword">if</span> html <span class="keyword">else</span> self.html</span><br><span class="line">        soup = BeautifulSoup(html, <span class="string">&quot;html.parser&quot;</span>)</span><br><span class="line">        movie_list_soup = soup.find(<span class="string">&#x27;ol&#x27;</span>, attrs=&#123;<span class="string">&#x27;class&#x27;</span>: <span class="string">&#x27;grid_view&#x27;</span>&#125;)</span><br><span class="line">        movie_name_list = []</span><br><span class="line">        <span class="keyword">for</span> movie_li <span class="keyword">in</span> movie_list_soup.find_all(<span class="string">&#x27;li&#x27;</span>):</span><br><span class="line">            detail = movie_li.find(<span class="string">&#x27;div&#x27;</span>, attrs=&#123;<span class="string">&#x27;class&#x27;</span>: <span class="string">&#x27;hd&#x27;</span>&#125;)</span><br><span class="line">            movie_name = detail.find(<span class="string">&#x27;span&#x27;</span>, attrs=&#123;<span class="string">&#x27;class&#x27;</span>: <span class="string">&#x27;title&#x27;</span>&#125;).getText()</span><br><span class="line">            score = movie_li.find(<span class="string">&#x27;div&#x27;</span>, attrs=&#123;<span class="string">&#x27;class&#x27;</span>: <span class="string">&#x27;bd&#x27;</span>&#125;)</span><br><span class="line">            movie_score = score.find(<span class="string">&#x27;span&#x27;</span>, attrs=&#123;<span class="string">&#x27;class&#x27;</span>: <span class="string">&#x27;rating_num&#x27;</span>&#125;).getText()</span><br><span class="line">            movie_detail = <span class="string">&quot;&#123;&#125;(&#123;&#125;)&quot;</span>.<span class="built_in">format</span>(movie_name , movie_score)</span><br><span class="line">            movie_name_list.append(movie_detail)</span><br><span class="line"></span><br><span class="line">        next_page = soup.find(<span class="string">&#x27;span&#x27;</span>, attrs=&#123;<span class="string">&#x27;class&#x27;</span>: <span class="string">&#x27;next&#x27;</span>&#125;).find(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> next_page:</span><br><span class="line">            <span class="keyword">return</span> movie_name_list, self.url_request + next_page[<span class="string">&#x27;href&#x27;</span>]</span><br><span class="line">        <span class="keyword">return</span> movie_name_list, <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">start_spider</span>(<span class="params">self</span>):</span></span><br><span class="line">        start = self.start</span><br><span class="line">        movies_list_total = []</span><br><span class="line">        <span class="keyword">while</span>(start &lt; <span class="number">25</span> * self.page):</span><br><span class="line">            self.url_request = <span class="string">&#x27;https://movie.douban.com/top250?self.start=&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(start)</span><br><span class="line">            self.download_page()</span><br><span class="line">            picdata = self.getPic(self.html)</span><br><span class="line">            movies, url = self.parse_html()</span><br><span class="line">            movies_list_total = movies_list_total + movies</span><br><span class="line">            index_movies = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> picinfo <span class="keyword">in</span> picdata:</span><br><span class="line">                self.download_pic(picinfo[<span class="number">5</span>:-<span class="number">1</span>], <span class="string">&#x27;Top&#x27;</span> + <span class="built_in">str</span>(index_movies+<span class="number">1</span>) + <span class="string">&#x27;-&#x27;</span> + movies[index_movies])</span><br><span class="line">                <span class="built_in">print</span>(movies[index_movies] + <span class="string">&#x27; download finished&#x27;</span>)</span><br><span class="line">                index_movies += <span class="number">1</span></span><br><span class="line">                start += <span class="number">1</span></span><br><span class="line">        <span class="keyword">with</span> codecs.<span class="built_in">open</span>(<span class="string">&#x27;movies.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> fp:</span><br><span class="line">            fp.write(<span class="string">u&#x27;\r\n&#x27;</span>.join(movies_list_total))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    spider_douban = SpiderDouban250(<span class="number">2</span>)</span><br><span class="line">    spider_douban.start_spider()</span><br></pre></td></tr></table></figure>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2018-08-15T16:00:00.000Z" title="2018/8/16 上午12:00:00">2018-08-16</time></span><span class="level-item">Updated&nbsp;<time dateTime="2018-11-30T15:46:40.248Z" title="2018/11/30 下午11:46:40">2018-11-30</time></span><span class="level-item"> BF </span><span class="level-item">4 minutes read (About 647 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/08/16/2018/08/2018-08-16-SendEmailByPython/">Send email by python</a></h1><div class="content"><h1 id="Send-email-by-python"><a href="#Send-email-by-python" class="headerlink" title="Send email by python"></a>Send email by python</h1><p><code>python</code>有两个原生库(<code>smtplib</code>,<code>email</code>)可以用来发送邮件，只要你有<code>smtp</code> server就行。之前在公司已经写过简单的类来实现，回来又重新写了一个使用<code>163</code>邮箱来发送的工具类。</p>
<p>目前已经能够完成基本发送功能，包括<code>html</code>格式，添加附件等，只是弄了好久，还是没有办法在正文中添加图片，一直<code>554</code>错误，被网易认为垃圾信息(<a target="_blank" rel="noopener" href="http://help.163.com/09/1224/17/5RAJ4LMH00753VB8.html">错误代码一览</a>)而发送不了，之后有时间再看。</p>
<h2 id="授权码"><a href="#授权码" class="headerlink" title="授权码"></a>授权码</h2><p>想利用163的邮箱发送邮件，就需要先开通授权码：<br><img src="/img/post/2018/08/2018-08-16-SendEmailByPython-permission.jpg" alt="permission"></p>
<h2 id="主要代码"><a href="#主要代码" class="headerlink" title="主要代码"></a>主要代码</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#/usr/bin/python3</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">author: xiche</span></span><br><span class="line"><span class="string">create at: 08/15/2018</span></span><br><span class="line"><span class="string">description:</span></span><br><span class="line"><span class="string">    Utils for send email</span></span><br><span class="line"><span class="string">Change log:</span></span><br><span class="line"><span class="string">Date         Author      Version    Description</span></span><br><span class="line"><span class="string">08/15/2018    xiche      1.0.1      Setup</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> smtplib</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> email.mime.text <span class="keyword">import</span> MIMEText</span><br><span class="line"><span class="keyword">from</span> email.mime.multipart <span class="keyword">import</span> MIMEMultipart</span><br><span class="line"><span class="keyword">from</span> email.mime.image <span class="keyword">import</span> MIMEImage</span><br><span class="line"><span class="keyword">from</span> email.header <span class="keyword">import</span> Header</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EmailUtils</span>:</span></span><br><span class="line">    __sender = <span class="string">&quot;bearfly1990@163.com&quot;</span></span><br><span class="line">    __recipients = [<span class="string">&quot;xiongchen1990@163.com&quot;</span>, <span class="string">&quot;xchen1230@163.com&quot;</span>]</span><br><span class="line">    __subject = <span class="string">&#x27;python email 尝试&#x27;</span></span><br><span class="line">    __content = <span class="string">&#x27;&lt;p&gt;This is the test by &lt;b&gt;python&lt;/b&gt;, please have a try.&lt;/p&gt;&#x27;</span> <span class="comment">#&lt;p&gt;截图如下：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;cid:image1&quot;&gt;&lt;/p&gt;</span></span><br><span class="line">    __mail_permission = <span class="string">&#x27;xxxxxx&#x27;</span><span class="comment">#授权码，非邮箱密码</span></span><br><span class="line">    __mail_host = <span class="string">&#x27;smtp.163.com&#x27;</span></span><br><span class="line">    __mail_port = <span class="number">25</span> <span class="comment">#SSL 465</span></span><br><span class="line">    __attachments_path = [<span class="string">r&#x27;C:\Users\mayn\Desktop\test.txt&#x27;</span>]</span><br><span class="line">    __content_images_path = [&#123;<span class="string">&#x27;cid&#x27;</span>:<span class="string">&#x27;image1&#x27;</span>, <span class="string">&#x27;path&#x27;</span>: <span class="string">r&#x27;C:\Users\mayn\Desktop\ymj.jpg&#x27;</span>&#125;]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">send_email</span>(<span class="params">self</span>):</span></span><br><span class="line">        msg = MIMEMultipart()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># msg = MIMEText(self.content, &#x27;plain&#x27;, &#x27;utf-8&#x27;)</span></span><br><span class="line">        msg[<span class="string">&#x27;Subject&#x27;</span>] =  Header(self.subject, <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        msg[<span class="string">&#x27;From&#x27;</span>] = self.sender</span><br><span class="line">        msg[<span class="string">&#x27;To&#x27;</span>] = <span class="string">&#x27;,&#x27;</span>.join(self.recipients)</span><br><span class="line"></span><br><span class="line">        content = MIMEText(self.__content,<span class="string">&#x27;html&#x27;</span>,<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        msg.attach(content)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> content_image <span class="keyword">in</span> self.__content_images_path:</span><br><span class="line">            msgImage = MIMEImage(<span class="built_in">open</span>(content_image[<span class="string">&#x27;path&#x27;</span>], <span class="string">&#x27;rb&#x27;</span>).read())</span><br><span class="line">            msgImage.add_header(<span class="string">&#x27;Content-ID&#x27;</span>, <span class="string">&#x27;&lt;&#123;&#125;&gt;&#x27;</span>.<span class="built_in">format</span>(content_image[<span class="string">&#x27;cid&#x27;</span>]))</span><br><span class="line">            msg.attach(msgImage)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> attachments_path <span class="keyword">in</span> self.__attachments_path:</span><br><span class="line">            attachment = MIMEText(<span class="built_in">open</span>(attachments_path, <span class="string">&#x27;rb&#x27;</span>).read(), <span class="string">&#x27;base64&#x27;</span>, <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">            attachment[<span class="string">&quot;Content-Type&quot;</span>] = <span class="string">&#x27;application/octet-stream&#x27;</span></span><br><span class="line">            attachment[<span class="string">&quot;Content-Disposition&quot;</span>] = <span class="string">&#x27;attachment; filename=&quot;&#123;&#125;&quot;&#x27;</span>.<span class="built_in">format</span>(os.path.basename(attachments_path))</span><br><span class="line">            msg.attach(attachment)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"># smtp = smtplib.SMTP(self.__mail_host, port=self.__mail_port)</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            smtp = smtplib.SMTP_SSL()  <span class="comment"># 注意：如果遇到发送失败的情况（提示远程主机拒接连接），这里要使用SMTP_SSL方法</span></span><br><span class="line">            smtp.connect(self.__mail_host)</span><br><span class="line">            smtp.login(self.sender, self.__mail_permission)</span><br><span class="line">            <span class="comment"># print(msg.as_string())</span></span><br><span class="line">            smtp.sendmail(self.sender, self.recipients, msg.as_string())</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;email send successfully.&#x27;</span>)</span><br><span class="line">        <span class="keyword">except</span> smtplib.SMTPException <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(e))</span><br><span class="line">        <span class="keyword">finally</span>:</span><br><span class="line">            smtp.quit()  <span class="comment"># 发送完毕后退出smtp</span></span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;sender&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sender</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.__sender</span><br><span class="line"></span><br><span class="line"><span class="meta">    @sender.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sender</span>(<span class="params">self, sender</span>):</span></span><br><span class="line">        self.__sender = sender</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;subject&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">subject</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.__subject</span><br><span class="line"></span><br><span class="line"><span class="meta">    @subject.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">subject</span>(<span class="params">self, subject</span>):</span></span><br><span class="line">        self.__subject = subject</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;recipients&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">recipients</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.__recipients</span><br><span class="line"></span><br><span class="line"><span class="meta">    @recipients.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">recipients</span>(<span class="params">self, recipients</span>):</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">isinstance</span>(recipients, <span class="built_in">str</span>)):</span><br><span class="line">            self.__recipients = recipients.split(<span class="string">&#x27;;&#x27;</span>)</span><br><span class="line">        <span class="keyword">elif</span>(<span class="built_in">isinstance</span>(recipients, <span class="built_in">list</span>)):</span><br><span class="line">            self.__recipients = recipients</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;sender&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">content</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.__content</span><br><span class="line"></span><br><span class="line"><span class="meta">    @content.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">content</span>(<span class="params">self, content</span>):</span></span><br><span class="line">        self.__content = content</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    emailUtils = EmailUtils()</span><br><span class="line">    emailUtils.send_email()</span><br><span class="line">    <span class="comment"># print(os.path.basename(r&#x27;C:\Users\mayn\Desktop\ymj.jpg&#x27;))</span></span><br></pre></td></tr></table></figure>

<p>更多信息请参考：<a target="_blank" rel="noopener" href="https://github.com/bearfly1990/PowerScript/blob/master/Python3/mylib/cmutils_email.py">https://github.com/bearfly1990/PowerScript/blob/master/Python3/mylib/cmutils_email.py</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2018-08-06T16:00:00.000Z" title="2018/8/7 上午12:00:00">2018-08-07</time></span><span class="level-item">Updated&nbsp;<time dateTime="2018-10-18T13:45:48.446Z" title="2018/10/18 下午9:45:48">2018-10-18</time></span><span class="level-item"> BF </span><span class="level-item">8 minutes read (About 1148 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/08/07/2018/08/2018-08-07-ProcessInfo/">Process Info</a></h1><div class="content"><h1 id="Process-Info"><a href="#Process-Info" class="headerlink" title="Process Info"></a>Process Info</h1><p>之前的测试中，使用<code>psutil</code>可以得到系统的<code>CPU/Memory</code>的使用百分比，但是没试过读取个别进程的信息。现在想要实现这样的功能，方便更好的分析<code>java.exe</code>的内存使用变化。</p>
<p>有一种思路是使用系统本身提供的查看进程的<code>shell cmd</code>和<code>subprocess.check_output</code>组合得到信息。</p>
<h2 id="tasklist"><a href="#tasklist" class="headerlink" title="tasklist"></a>tasklist</h2><p>在<code>windows</code>系统中，提供了<code>tasklist</code>来查看<code>process</code>的信息，大致的结果如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\mayn&gt;tasklist</span><br><span class="line"></span><br><span class="line">映像名称                       PID 会话名              会话#       内存使用</span><br><span class="line">========================= ======== ================ =========== ============</span><br><span class="line">System Idle Process              0 Services                   0          8 K</span><br><span class="line">System                           4 Services                   0        108 K</span><br><span class="line">Registry                       108 Services                   0     22,924 K</span><br><span class="line">smss.exe                       376 Services                   0      1,128 K</span><br><span class="line">csrss.exe                      580 Services                   0      5,124 K</span><br><span class="line">wininit.exe                    672 Services                   0      6,676 K</span><br></pre></td></tr></table></figure>

<p>查看<code>tasklist</code>的使用帮助，我们发现可以利用本身提供的参数取得想要的数据。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\mayn&gt;tasklist /?</span><br><span class="line"></span><br><span class="line">TASKLIST [/S system [/U username [/P [password]]]]</span><br><span class="line">         [/M [module] | /SVC | /V] [/FI filter] [/FO format] [/NH]</span><br><span class="line"></span><br><span class="line">描述:</span><br><span class="line">    该工具显示在本地或远程机器上当前运行的进程列表。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">参数列表:</span><br><span class="line">   /S     system           指定连接到的远程系统。</span><br><span class="line"></span><br><span class="line">   /U     [domain\]user    指定应该在哪个用户上下文执行这个命令。</span><br><span class="line"></span><br><span class="line">   /P     [password]       为提供的用户上下文指定密码。如果省略，则</span><br><span class="line">                           提示输入。</span><br><span class="line"></span><br><span class="line">   /M     [module]         列出当前使用所给 exe/dll 名称的所有任务。</span><br><span class="line">                           如果没有指定模块名称，显示所有加载的模块。</span><br><span class="line"></span><br><span class="line">   /SVC                    显示每个进程中主持的服务。</span><br><span class="line"></span><br><span class="line">   /APPS 显示 Microsoft Store 应用及其关联的进程。</span><br><span class="line"></span><br><span class="line">   /V                      显示详细任务信息。</span><br><span class="line"></span><br><span class="line">   /FI    filter           显示一系列符合筛选器</span><br><span class="line">                           指定条件的任务。</span><br><span class="line"></span><br><span class="line">   /FO    format           指定输出格式。</span><br><span class="line">                           有效值: &quot;TABLE&quot;、&quot;LIST&quot;、&quot;CSV&quot;。</span><br><span class="line"></span><br><span class="line">   /NH                     指定列标题不应该</span><br><span class="line">                           在输出中显示。</span><br><span class="line">                           只对 &quot;TABLE&quot; 和 &quot;CSV&quot; 格式有效。</span><br><span class="line"></span><br><span class="line">   /?                      显示此帮助消息。</span><br><span class="line"></span><br><span class="line">筛选器:</span><br><span class="line">    筛选器名称     有效运算符           有效值</span><br><span class="line">    -----------     ---------------           --------------------------</span><br><span class="line">    STATUS          eq, ne                    RUNNING | SUSPENDED</span><br><span class="line">                                              NOT RESPONDING | UNKNOWN</span><br><span class="line">    IMAGENAME       eq, ne                    映像名称</span><br><span class="line">    PID             eq, ne, gt, lt, ge, le    PID 值</span><br><span class="line">    SESSION         eq, ne, gt, lt, ge, le    会话编号</span><br><span class="line">    SESSIONNAME     eq, ne                    会话名称</span><br><span class="line">    CPUTIME         eq, ne, gt, lt, ge, le    CPU 时间，格式为</span><br><span class="line">                                              hh:mm:ss。</span><br><span class="line">                                              hh - 小时，</span><br><span class="line">                                              mm - 分钟，ss - 秒</span><br><span class="line">    MEMUSAGE        eq, ne, gt, lt, ge, le    内存使用(以 KB 为单位)</span><br><span class="line">    USERNAME        eq, ne                    用户名，格式为</span><br><span class="line">                                              [域\]用户</span><br><span class="line">    SERVICES        eq, ne                    服务名称</span><br><span class="line">    WINDOWTITLE     eq, ne                    窗口标题</span><br><span class="line">    模块         eq, ne                    DLL 名称</span><br><span class="line"></span><br><span class="line">注意: 当查询远程计算机时，不支持 &quot;WINDOWTITLE&quot; 和 &quot;STATUS&quot;</span><br><span class="line">      筛选器。</span><br><span class="line"></span><br><span class="line">Examples:</span><br><span class="line">    TASKLIST</span><br><span class="line">    TASKLIST /M</span><br><span class="line">    TASKLIST /V /FO CSV</span><br><span class="line">    TASKLIST /SVC /FO LIST</span><br><span class="line">    TASKLIST /APPS /FI &quot;STATUS eq RUNNING&quot;</span><br><span class="line">    TASKLIST /M wbem*</span><br><span class="line">    TASKLIST /S system /FO LIST</span><br><span class="line">    TASKLIST /S system /U 域\用户名 /FO CSV /NH</span><br><span class="line">    TASKLIST /S system /U username /P password /FO TABLE /NH</span><br><span class="line">    TASKLIST /FI &quot;USERNAME ne NT AUTHORITY\SYSTEM&quot; /FI &quot;STATUS eq running&quot;</span><br></pre></td></tr></table></figure>

<p>以<code>vscode</code>的进程<code>code.exe</code>为例，可以筛选出对应的进程：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\mayn&gt;tasklist /FI &quot;imagename eq code.exe&quot;</span><br><span class="line"></span><br><span class="line">映像名称                       PID 会话名              会话#       内存使用</span><br><span class="line">========================= ======== ================ =========== ============</span><br><span class="line">Code.exe                      1492 Console                    1    146,248 K</span><br><span class="line">Code.exe                      9176 Console                    1     69,080 K</span><br><span class="line">Code.exe                      9120 Console                    1     11,412 K</span><br><span class="line">Code.exe                      1700 Console                    1     81,984 K</span><br><span class="line">Code.exe                      5784 Console                    1    221,540 K</span><br><span class="line">Code.exe                      9464 Console                    1    106,296 K</span><br><span class="line">Code.exe                      8392 Console                    1     98,076 K</span><br></pre></td></tr></table></figure>

<p>筛选器是可以组合的，比如：<br><code>&quot;tasklist  /FI &quot;imagename eq java.exe&quot; /FI \&quot;username eq xiche\&quot;&quot;</code><br>这样就可以得到自己想要的进程信息，并取得一些值。</p>
<h2 id="subprocess-check-out"><a href="#subprocess-check-out" class="headerlink" title="subprocess.check_out"></a>subprocess.check_out</h2><p><code>subprocess</code>是python中调用进程与进程交互的一个库，可以用它来调用运行程序。</p>
<p>这边我们使用<code>check_out</code>来得到<code>tasklist</code>的输出结果，然后利用正则表达式取得对应的值，组装成字典列表来供之后使用。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_processes_running</span>():</span></span><br><span class="line">    tasks = subprocess.check_output(</span><br><span class="line">        <span class="string">&quot;tasklist  /FI \&quot;imagename eq code.exe\&quot; &quot;</span>).decode(<span class="string">&quot;gbk&quot;</span>).split(<span class="string">&quot;\r\n&quot;</span>)</span><br><span class="line">    p = []</span><br><span class="line">    <span class="keyword">for</span> task <span class="keyword">in</span> tasks:</span><br><span class="line">        m = re.match(<span class="string">&quot;(.+?) +(\d+) (.+?) +(\d+) +(\d+.* K).*&quot;</span>, task)</span><br><span class="line">        <span class="keyword">if</span> m <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            p.append(&#123;<span class="string">&quot;image&quot;</span>: m.group(<span class="number">1</span>),</span><br><span class="line">                      <span class="string">&quot;pid&quot;</span>: m.group(<span class="number">2</span>),</span><br><span class="line">                      <span class="string">&quot;session_name&quot;</span>: m.group(<span class="number">3</span>),</span><br><span class="line">                      <span class="string">&quot;session_num&quot;</span>: m.group(<span class="number">4</span>),</span><br><span class="line">                      <span class="string">&quot;mem_usage&quot;</span>: m.group(<span class="number">5</span>)</span><br><span class="line">                      &#125;)</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line">processes = get_processes_running()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> process <span class="keyword">in</span> processes:</span><br><span class="line">    <span class="built_in">print</span>(process[<span class="string">&quot;pid&quot;</span>], process[<span class="string">&quot;mem_usage&quot;</span>])</span><br></pre></td></tr></table></figure>

<p>运行的结果如下:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\mayn\Desktop&gt; python test.py</span><br><span class="line">1492 157,088 K</span><br><span class="line">9176 75,932 K</span><br><span class="line">9120 11,416 K</span><br><span class="line">1700 119,968 K</span><br><span class="line">2868 237,328 K</span><br><span class="line">2616 121,216 K</span><br><span class="line">5580 33,724 K</span><br><span class="line">10688 103,604 K</span><br></pre></td></tr></table></figure>

<h2 id="psutil"><a href="#psutil" class="headerlink" title="psutil"></a>psutil</h2><p>可能大家发现了，这样使用tasklist取得的值是固定了，而我们想得到更多的值(e.g cpu)需要使用更多的命令来得到信息。</p>
<p>但其实还有一种方便的方法，直接使用<code>psutil</code>，用他来获取系统信息真的很强很方便。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">processinfo</span>(<span class="params">processName</span>):</span></span><br><span class="line">    pids = psutil.pids()</span><br><span class="line">    pids_return = []</span><br><span class="line">    <span class="keyword">for</span> pid <span class="keyword">in</span> pids:</span><br><span class="line">        p = psutil.Process(pid)</span><br><span class="line">        <span class="keyword">if</span> processName.lower() <span class="keyword">in</span> p.name().lower() :</span><br><span class="line">            pids_return.append(pid)</span><br><span class="line">    <span class="keyword">return</span> pids_return</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> pid <span class="keyword">in</span> processinfo(<span class="string">&quot;code.exe&quot;</span>):</span><br><span class="line">    ps = psutil.Process(pid)  </span><br><span class="line">    <span class="built_in">print</span>(ps.cpu_percent(interval=<span class="number">1.0</span>), ps.memory_percent())</span><br></pre></td></tr></table></figure>

<p>更多信息请参考：<a target="_blank" rel="noopener" href="https://github.com/bearfly1990/PowerScript/wiki/Python3">https://github.com/bearfly1990/PowerScript/wiki/Python3</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2018-06-13T16:00:00.000Z" title="2018/6/14 上午12:00:00">2018-06-14</time></span><span class="level-item">Updated&nbsp;<time dateTime="2018-10-18T13:45:48.446Z" title="2018/10/18 下午9:45:48">2018-10-18</time></span><span class="level-item"> BF </span><span class="level-item">2 minutes read (About 364 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/06/14/2018/06/2018-06-14-CatchMonitorData/">Catch CPU/Memory Monitor</a></h1><div class="content"><h2 id="根据log中的实际取得monitor中的数据。"><a href="#根据log中的实际取得monitor中的数据。" class="headerlink" title="根据log中的实际取得monitor中的数据。"></a>根据log中的实际取得monitor中的数据。</h2><p>现在有一个完整的导数据的log，类似于如下ImportLog.txt：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">...略...</span><br><span class="line">2018-06-14 00:07:58,156 [INFO ] -----START IMPORT-----</span><br><span class="line">2018-06-14 00:07:58,515 [INFO ] xxx</span><br><span class="line">2018-06-14 00:10:39,065 [INFO ] xxx</span><br><span class="line">2018-06-14 00:10:39,081 [INFO ] Import Time(s):160.55</span><br><span class="line">2018-06-14 00:10:39,128 [INFO ] xxx</span><br><span class="line">2018-06-14 00:10:39,128 [INFO ] Finished:xxxAAxxx</span><br><span class="line">2018-06-14 00:10:39,128 [INFO ] Import Time(s):160.96</span><br><span class="line">2018-06-14 00:10:39,128 [INFO ] -----END IMPORT-----</span><br><span class="line">2018-06-14 00:10:44,201 [INFO ] -----START IMPORT-----</span><br><span class="line">2018-06-14 00:10:46,590 [INFO ] xxx\\IMPORT.exe BBB</span><br><span class="line">2018-06-14 00:57:30,360 [INFO ] Finished:\xxx_BBB_xxx</span><br><span class="line">2018-06-14 00:57:30,360 [INFO ] Import Time(s):2803.77</span><br><span class="line">2018-06-14 00:57:31,125 [INFO ] -----END IMPORT-----</span><br><span class="line">...略...</span><br></pre></td></tr></table></figure>
<p>而整个过程有监控数据类似如下Monitor.csv：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Time,CPU(%),Memory(%)</span><br><span class="line">2018&#x2F;06&#x2F;13 23:51:17,2.7,12.17</span><br><span class="line">2018&#x2F;06&#x2F;13 23:51:19,0.0,12.16</span><br><span class="line">2018&#x2F;06&#x2F;13 23:51:21,0.0,12.16</span><br><span class="line">2018&#x2F;06&#x2F;13 23:51:23,0.0,12.14</span><br><span class="line">2018&#x2F;06&#x2F;13 23:51:25,0.4,12.15</span><br><span class="line">2018&#x2F;06&#x2F;13 23:51:28,0.0,12.15</span><br><span class="line">2018&#x2F;06&#x2F;13 23:51:30,0.0,12.15</span><br><span class="line">...略...</span><br></pre></td></tr></table></figure>
<p>那么现在的问题是只需要在跑BBB的时候的那段时间的监控数据，于是临时写了个简单的HardCode的过程达到目的，主要用到了datetime对时间的处理。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">author: xiche</span></span><br><span class="line"><span class="string">create at: 06/14/2018</span></span><br><span class="line"><span class="string">description:</span></span><br><span class="line"><span class="string">    Catch monitor data from whole proces</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line"><span class="comment"># datetime_object = datetime.strptime(&#x27;Jun 1 2005  1:33PM&#x27;, &#x27;%b %d %Y %I:%M%p&#x27;)</span></span><br><span class="line">dateformat1 = <span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span> <span class="comment">#&quot;2018-06-13 23:51:17&quot;</span></span><br><span class="line">dateformat2 = <span class="string">&quot;%Y/%m/%d %H:%M:%S&quot;</span> <span class="comment">#&quot;2018/06/13 23:51:52&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__main__</span>():</span></span><br><span class="line">    dt_start = <span class="literal">None</span></span><br><span class="line">    dt_end = <span class="literal">None</span></span><br><span class="line">    lines_new = []</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;ImportLog.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        lines = f.readlines()</span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">            <span class="keyword">if</span>(<span class="string">&quot;BBB&quot;</span> <span class="keyword">in</span> line <span class="keyword">and</span> <span class="string">&quot;Finished&quot;</span> <span class="keyword">in</span> line):</span><br><span class="line">                dt_end = datetime.strptime(line[<span class="number">0</span>:<span class="number">19</span>], dateformat1)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="string">&quot;BBB&quot;</span> <span class="keyword">in</span> line):</span><br><span class="line">                dt_start = datetime.strptime(line[<span class="number">0</span>:<span class="number">19</span>], dateformat1)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;Monitor.csv&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        lines = f.readlines()</span><br><span class="line">        dt_current = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                dt_current = datetime.strptime(line[<span class="number">0</span>:<span class="number">19</span>], dateformat2)</span><br><span class="line">                <span class="keyword">if</span>(dt_current &lt; dt_start):</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                <span class="keyword">elif</span>(dt_current &gt; dt_end):</span><br><span class="line">                    <span class="keyword">break</span> <span class="comment">#之前竟然是continue。。。。</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    lines_new.append(line)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;No expect formated:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(line))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;Monitor_BBB.csv&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.writelines(lines_new)     </span><br><span class="line">    <span class="comment"># dt_start    = datetime.strptime(dt_start_str, dateformat1)</span></span><br><span class="line">    <span class="comment"># dt_end      = datetime.strptime(dt_start_str, dateformat2)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># a = datetime.strptime(&quot;2018-06-13 23:51:17&quot;, &quot;%Y-%m-%d %H:%M:%S&quot;)</span></span><br><span class="line">    <span class="comment"># b = datetime.strptime(&quot;2018/06/13 23:51:52&quot;, &quot;%Y/%m/%d %H:%M:%S&quot;)</span></span><br><span class="line">    <span class="comment"># print(a, b)</span></span><br><span class="line">__main__()</span><br></pre></td></tr></table></figure>

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2018-05-08T16:00:00.000Z" title="2018/5/9 上午12:00:00">2018-05-09</time></span><span class="level-item">Updated&nbsp;<time dateTime="2018-10-18T13:45:48.446Z" title="2018/10/18 下午9:45:48">2018-10-18</time></span><span class="level-item"> BF </span><span class="level-item">2 minutes read (About 302 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/05/09/2018/05/2018-05-09-ACM-Python/">ACM with Python</a></h1><div class="content"><h2 id="使用python编写acm题目"><a href="#使用python编写acm题目" class="headerlink" title="使用python编写acm题目"></a>使用python编写acm题目</h2><p>ACM一般来说都是用C或者C++来编写，因为国内的大学入门教程就是以C和C++为主，而且编译后的执行效率也比较高。但是很多的Online Judge都支持别的语言，例如Java，Python，Perl，Pascal，PHP，FPC，C#等等。</p>
<p>省内我们之前常用的几个学校的OJ系统(<a target="_blank" rel="noopener" href="http://acm.zju.edu.cn/onlinejudge/">浙大</a>，<a target="_blank" rel="noopener" href="http://acm.hdu.edu.cn/">杭电</a>，<a target="_blank" rel="noopener" href="http://acm.zjut.edu.cn/onlinejudge/">工大</a>)，只有浙大的才支持Python，而且只有2.7.3,不支持Python3+。不过大同小异，下面就用简单的例子来演示下用python来写acm。</p>
<h3 id="1001-A-B-Problem"><a href="#1001-A-B-Problem" class="headerlink" title="1001 A+B Problem"></a><a target="_blank" rel="noopener" href="http://acm.zju.edu.cn/onlinejudge/showProblem.do?problemCode=1001">1001 A+B Problem</a></h3><p>哈哈，就以这个最简单的a+b问题为例，下面是一个标准的输入输出样式，读取样例，输出结果。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:  </span><br><span class="line">    <span class="keyword">try</span>:  </span><br><span class="line">        a, b = <span class="built_in">map</span>(<span class="built_in">int</span>, raw_input().strip().split())  </span><br><span class="line">        <span class="built_in">print</span> a + b</span><br><span class="line">    <span class="keyword">except</span> EOFError:  </span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>本来还想再写几个的，但暂时没发现特别简单的，哈哈哈哈哈！</p>
<p>Python输入样例参考：<a target="_blank" rel="noopener" href="https://github.com/bearfly1990/PowerScript/blob/master/Python3/acm/PythonInput.py">Python - Input</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2018-05-06T16:00:00.000Z" title="2018/5/7 上午12:00:00">2018-05-07</time></span><span class="level-item">Updated&nbsp;<time dateTime="2018-10-18T13:45:48.446Z" title="2018/10/18 下午9:45:48">2018-10-18</time></span><span class="level-item"> BF </span><span class="level-item">5 minutes read (About 740 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/05/07/2018/05/2018-05-07-RegexInPython/">Regex in python</a></h1><div class="content"><h2 id="Regex-in-python-简介"><a href="#Regex-in-python-简介" class="headerlink" title="Regex in python 简介"></a>Regex in python 简介</h2><p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Regular_expression">正则表达式</a> 是在文本处理的时候非常高效有用的一种方式，一般的编程语言都会内置相应的模块。</p>
<p>不同的编程语言使用方式不尽相同，核心的表达式模式都是一致的。</p>
<p>最近使用python生成Message，有用到正则表达式，今天简单的总结下python使用的方式。对于表达式本身的使用，之后有时间再详细介绍。</p>
<h3 id="re-match"><a href="#re-match" class="headerlink" title="re.match"></a>re.match</h3><p>首先介绍下<code>re.match(pattern, string, flags=0)</code>。</p>
<p>如果能匹配上，这个方法将会返回match对象, 如果失败的话就会返回None。</p>
<p>看下面这个例子，我在创建message的时候，希望通过配置类似于<code>Suffix[1-100]</code>这样的方式来生成message中的变量。我需要得到前缀<code>Suffix</code>,最小值<code>1</code>,最大值<code>100</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">line = <span class="string">&quot;Suffix[1-100]&quot;</span></span><br><span class="line"></span><br><span class="line">matchObj = re.match( <span class="string">r&#x27;(.*)\[(.*?)-(.*?)\]&#x27;</span>, line, re.M|re.I)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> matchObj:</span><br><span class="line">   <span class="built_in">print</span> (<span class="string">&quot;matchObj.group() : &quot;</span>, matchObj.group())</span><br><span class="line">   <span class="built_in">print</span> (<span class="string">&quot;matchObj.group(1) : &quot;</span>, matchObj.group(<span class="number">1</span>))</span><br><span class="line">   <span class="built_in">print</span> (<span class="string">&quot;matchObj.group(2) : &quot;</span>, matchObj.group(<span class="number">2</span>))</span><br><span class="line">   <span class="built_in">print</span> (<span class="string">&quot;matchObj.group(3) : &quot;</span>, matchObj.group(<span class="number">3</span>))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">   <span class="built_in">print</span> (<span class="string">&quot;No match!!&quot;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;output</span></span><br><span class="line"><span class="string">matchObj.group() :  Suffix[1-100]</span></span><br><span class="line"><span class="string">matchObj.group(1) :  Suffix</span></span><br><span class="line"><span class="string">matchObj.group(2) :  1</span></span><br><span class="line"><span class="string">matchObj.group(3) :  100</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>通过<code>match</code>方法，利用<code>group()</code>就能很方便的把固定格式的数据提取出来。</p>
<h3 id="re-search"><a href="#re-search" class="headerlink" title="re.search"></a>re.search</h3><p>在字符串中利用正则表达式查找匹配相可以使用<code>re.search(pattern, string, flags=0)</code></p>
<p>那么<code>search</code>和<code>match</code>有什么区别呢？</p>
<p>其实从名字上就可以看出来，<code>search</code>是在整个字符串里找符合匹配的就可以，而<code>match</code>要求整个字符串来匹配。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">line = <span class="string">&quot;Cats are smarter than dogs, but I like dogs:) &quot;</span>;</span><br><span class="line"></span><br><span class="line">matchObj = re.match( <span class="string">r&#x27;dogs&#x27;</span>, line, re.M|re.I)</span><br><span class="line"><span class="keyword">if</span> matchObj:</span><br><span class="line">   <span class="built_in">print</span> (<span class="string">&quot;match --&gt; matchObj.group() : &quot;</span>, matchObj.group())</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">   <span class="built_in">print</span> (<span class="string">&quot;No match!!&quot;</span>)</span><br><span class="line"></span><br><span class="line">searchObj = re.search( <span class="string">r&#x27;dogs&#x27;</span>, line, re.M|re.I)</span><br><span class="line"><span class="keyword">if</span> searchObj:</span><br><span class="line">   <span class="built_in">print</span> (<span class="string">&quot;search --&gt; searchObj.group() : &quot;</span>, searchObj.group())</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">   <span class="built_in">print</span> (<span class="string">&quot;Nothing found!!&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="re-sub"><a href="#re-sub" class="headerlink" title="re.sub"></a>re.sub</h3><p><code>re.sub(pattern, repl, string, max=0)</code>用来查找和替换字符串。<code>max</code>是可选的，表示替换的个数，默认是全部替换。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">phone = <span class="string">&quot;2004-959-559 # This is Phone Number&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Delete Python-style comments</span></span><br><span class="line">num = re.sub(<span class="string">r&#x27;#.*$&#x27;</span>, <span class="string">&quot;&quot;</span>, phone)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;Phone Num : &quot;</span>, num</span><br><span class="line"></span><br><span class="line"><span class="comment"># Remove anything other than digits</span></span><br><span class="line">num = re.sub(<span class="string">r&#x27;\D&#x27;</span>, <span class="string">&quot;&quot;</span>, phone)    </span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;Phone Num : &quot;</span>, num</span><br></pre></td></tr></table></figure>

<h3 id="string"><a href="#string" class="headerlink" title="string"></a>string</h3><p>就像其它编程语言一样，python中<code>string</code>已经内置了一些和文本有关的方法，可以直接方便使用。<br><code>s.startswith(prefix[,start[,end]])</code><br><code>s.endswith(suffix[,start[,end]])</code><br><code>s.find(sub[,start[,end]])</code><br><code>s.split([sep])</code><br>…</p>
<h3 id="Flags"><a href="#Flags" class="headerlink" title="Flags"></a>Flags</h3><p>上面的例子中，大家发现了又用到<code>re.M|re.I</code>,这些常量是用来定义匹配模式的，</p>
<table>
<thead>
<tr>
<th>Sr.No.</th>
<th align="center">Modifier</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td align="center">re.I</td>
<td>大小写敏感</td>
</tr>
<tr>
<td>2</td>
<td align="center">re.L</td>
<td>使用Local,影响<code>\W</code> <code>\w</code>和<code>\B</code> <code>\b</code></td>
</tr>
<tr>
<td>3</td>
<td align="center">re.M</td>
<td>^匹配行结尾  $匹配行开头</td>
</tr>
<tr>
<td>4</td>
<td align="center">re.S</td>
<td>让<code>.</code>匹配任何字符，包括换行</td>
</tr>
<tr>
<td>5</td>
<td align="center">re.U</td>
<td>使用Unicode编码 影响<code>\W</code> <code>\w</code>和<code>\B</code> <code>\b</code></td>
</tr>
<tr>
<td>6</td>
<td align="center">re.X</td>
<td>允许<code>cuter</code>语法，忽略空白(在[]或者\）,并将#做为一般正常字符</td>
</tr>
</tbody></table>
<p>更具体的信息参考：<a target="_blank" rel="noopener" href="https://www.tutorialspoint.com/python/python_reg_expressions.htm">Python - Regular Expressions</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2018-04-24T16:00:00.000Z" title="2018/4/25 上午12:00:00">2018-04-25</time></span><span class="level-item">Updated&nbsp;<time dateTime="2018-10-18T13:45:48.446Z" title="2018/10/18 下午9:45:48">2018-10-18</time></span><span class="level-item"> BF </span><span class="level-item">5 minutes read (About 733 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/04/25/2018/04/2018-04-25-colorlog/">colorlog</a></h1><div class="content"><h2 id="colorlog"><a href="#colorlog" class="headerlink" title="colorlog"></a>colorlog</h2><p>这个module的核心就是提供了<code>colored formaterr</code>给<code>logging</code>模块，所以使用上还是遵循<code>logging</code>的方式。</p>
<p>今天就简单的介绍下用法，我感觉够用了，有更多的需求的话可以再去深入了解。</p>
<h3 id="Log-Format"><a href="#Log-Format" class="headerlink" title="Log Format"></a>Log Format</h3><p>Actually, 只有Console是支持颜色的，之前我提到过终端中颜色的原理<a href="https://bearfly1990.github.io/2018/04/21/ColorfulConsole/">Text Color Of Console</a>。<br>这个module就是在输出到终端的时候，前后加了转义序列ESC(e.g.<code>&quot;\033[1;35;40m 高亮洋红背景黑 \033[0m&quot;</code>)<br>我在demo中顺便加入了输出log到文件的简单用法来对比。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">LOG_FORMAT_CONSOLE = <span class="string">&quot;%(log_color)s%(asctime)s [%(levelname)-5.5s] %(message)s&quot;</span></span><br><span class="line">LOG_FORMAT_FILE = <span class="string">&quot;%(asctime)s [%(levelname)-5.5s] %(message)s&quot;</span></span><br></pre></td></tr></table></figure>
<p>从上面的代码可以看出来，为了使用自定义颜色，需要在format string中加入<code>%(log_color)s</code>。</p>
<h3 id="ColoredFormatter"><a href="#ColoredFormatter" class="headerlink" title="ColoredFormatter"></a>ColoredFormatter</h3><p>这个是关键的一个类，从<code>colorlog</code><a target="_blank" rel="noopener" href="https://github.com/borntyping/python-colorlog/blob/master/colorlog/colorlog.py">源码</a><br>片段中可以看到，它是继承自<code>logging.Formatter</code>，封装了自己的实现。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ColoredFormatter</span>(<span class="params">logging.Formatter</span>):</span></span><br><span class="line">   <span class="comment"># 略...</span></span><br><span class="line">   <span class="function"><span class="keyword">def</span> <span class="title">format</span>(<span class="params">self, record</span>):</span></span><br><span class="line">        <span class="comment"># 略...</span></span><br><span class="line">        <span class="comment"># Add a reset code to the end of the message</span></span><br><span class="line">        <span class="comment"># (if it wasn&#x27;t explicitly added in format str)</span></span><br><span class="line">        <span class="keyword">if</span> self.reset <span class="keyword">and</span> <span class="keyword">not</span> message.endswith(escape_codes[<span class="string">&#x27;reset&#x27;</span>]):</span><br><span class="line">            message += escape_codes[<span class="string">&#x27;reset&#x27;</span>]</span><br></pre></td></tr></table></figure>
<p>可以直接使用默认的设置<code>formatter = ColoredFormatter(LOG_FORMAT_CONSOLE)</code>得到default的配色。</p>
<p>但我觉得默认的不是很好看，而它也支持自定义。</p>
<p>从下面的<a target="_blank" rel="noopener" href="https://github.com/borntyping/python-colorlog/blob/master/colorlog/escape_codes.py">源码</a>片段里<br>可以看到，<code>colorlog</code>支持8种颜色，可以挑个自己喜欢的，觉得不好的当然也可以改源码，加入自己的颜色。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># The color names</span></span><br><span class="line">COLORS = [</span><br><span class="line">    <span class="string">&#x27;black&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;red&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;green&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;yellow&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;blue&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;purple&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;cyan&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;white&#x27;</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>此外，它也支持改变背景色，只要加上前缀<code>bg_</code>，而如果想要高亮的话，可以加前缀<code>bold_</code>。尽情试一下效果吧:)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">PREFIXES = [</span><br><span class="line">    <span class="comment"># Foreground without prefix</span></span><br><span class="line">    (<span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;&#x27;</span>), (<span class="string">&#x27;01;3&#x27;</span>, <span class="string">&#x27;bold_&#x27;</span>), (<span class="string">&#x27;02;3&#x27;</span>, <span class="string">&#x27;thin_&#x27;</span>),</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Foreground with fg_ prefix</span></span><br><span class="line">    (<span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;fg_&#x27;</span>), (<span class="string">&#x27;01;3&#x27;</span>, <span class="string">&#x27;fg_bold_&#x27;</span>), (<span class="string">&#x27;02;3&#x27;</span>, <span class="string">&#x27;fg_thin_&#x27;</span>),</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Background with bg_ prefix - bold/light works differently</span></span><br><span class="line">    (<span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;bg_&#x27;</span>), (<span class="string">&#x27;10&#x27;</span>, <span class="string">&#x27;bg_bold_&#x27;</span>),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>这个是我目前使用的配色，参考下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">formatter_console = ColoredFormatter(</span><br><span class="line">	LOG_FORMAT_CONSOLE,</span><br><span class="line">	datefmt=<span class="literal">None</span>,</span><br><span class="line">	reset=<span class="literal">True</span>,</span><br><span class="line">	log_colors=&#123;</span><br><span class="line">		<span class="string">&#x27;DEBUG&#x27;</span>:    <span class="string">&#x27;cyan&#x27;</span>,</span><br><span class="line">		<span class="string">&#x27;INFO&#x27;</span>:     <span class="string">&#x27;green&#x27;</span>,</span><br><span class="line">		<span class="string">&#x27;WARNING&#x27;</span>:  <span class="string">&#x27;bold_yellow&#x27;</span>,</span><br><span class="line">		<span class="string">&#x27;ERROR&#x27;</span>:    <span class="string">&#x27;bold_red&#x27;</span>,</span><br><span class="line">		<span class="string">&#x27;CRITICAL&#x27;</span>: <span class="string">&#x27;bold_red,bg_white&#x27;</span>,</span><br><span class="line">	&#125;,</span><br><span class="line">	secondary_log_colors=&#123;&#125;,</span><br><span class="line">	style=<span class="string">&#x27;%&#x27;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><p>其实上边讲完，剩下的就是使用logging的常规方式，可以在demo里看到：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">formatter_file = logging.Formatter(LOG_FORMAT_FILE)</span><br><span class="line"></span><br><span class="line">handler_stream = logging.StreamHandler()</span><br><span class="line">handler_stream.setLevel(LOG_LEVEL)</span><br><span class="line">handler_stream.setFormatter(formatter_console)</span><br><span class="line"></span><br><span class="line">handler_file = logging.FileHandler(<span class="string">&quot;colorlog.log&quot;</span>)</span><br><span class="line">handler_file.setLevel(LOG_LEVEL)</span><br><span class="line">handler_file.setFormatter(formatter_file)</span><br><span class="line"></span><br><span class="line">log = logging.getLogger(__name__)</span><br><span class="line">log.setLevel(LOG_LEVEL)</span><br><span class="line"><span class="comment"># set file and console hander to log</span></span><br><span class="line">log.addHandler(handler_stream)</span><br><span class="line">log.addHandler(handler_file)</span><br><span class="line"></span><br><span class="line">log.debug(<span class="string">&quot;A quirky message only developers care about&quot;</span>)</span><br><span class="line">log.info(<span class="string">&quot;Curious users might want to know this&quot;</span>)</span><br><span class="line">log.warn(<span class="string">&quot;Something is wrong and any user should be informed&quot;</span>)</span><br><span class="line">log.error(<span class="string">&quot;Serious stuff, this is red for a reason&quot;</span>)</span><br><span class="line">log.critical(<span class="string">&quot;OH NO everything is on fire&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>更具体的信息参考：<a target="_blank" rel="noopener" href="https://github.com/borntyping/python-colorlog">colorlog</a></p>
<p>我的demo：<a target="_blank" rel="noopener" href="https://github.com/bearfly1990/PowerScript/blob/master/Python3/colorlog/demo.py">colorlog/demo.py</a></p>
</div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/tags/python/page/3/">Previous</a></div><div class="pagination-next"><a href="/tags/python/page/5/">Next</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/tags/python/">1</a></li><li><a class="pagination-link" href="/tags/python/page/2/">2</a></li><li><a class="pagination-link" href="/tags/python/page/3/">3</a></li><li><a class="pagination-link is-current" href="/tags/python/page/4/">4</a></li><li><a class="pagination-link" href="/tags/python/page/5/">5</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/mybear.jpg" alt="bearfly1990"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">bearfly1990</p><p class="is-size-6 is-block">有熊在飞</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>HZ, China</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">81</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">100</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/bearfly1990" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/bearfly1990"><i class="fab fa-github"></i></a></div></div></div><!--!--></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/favicon.ico" alt="BF Blog" height="28"></a><p class="is-size-7"><span>&copy; 2021 bearfly1990</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>